/* Copyright (C) 2010 Yahoo Japan Corporation. All Rights Reserved. */
function AlpsUtil(){if(_bi.type==1&&_bi.version==6){var _1=new Array(AlpsUtil.blankImg);var _2=new Array();for(var i=0;i<_1.length;i++){_2[i]=new Image();_2[i].src=_1[i];}try{document.execCommand("BackgroundImageCache",false,true);}catch(e){}}}AlpsUtil.blankImg="http://i.yimg.jp/images/map/api/blank.gif";AlpsUtil.getXMLHttp=function(){var _4;if(typeof ActiveXObject!="undefined"){try{_4=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){_4=new ActiveXObject("Microsoft.XMLHTTP");}}if(typeof XMLHttpRequest!="undefined"){_4=new XMLHttpRequest();}return _4;};AlpsUtil.getXMLDOM=function(_5){var _6=AlpsUtil.getXMLHttp();if(!_6){return;}_6.open("GET",_5,false);_6.send(null);if(_6.status==200||_6.status==304){return _6.responseXML;}};AlpsUtil.createXMLDOM=function(){var _7;if(typeof ActiveXObject!="undefined"){_7=new ActiveXObject("Microsoft.XMLDOM");}else{_7=document.implementation.createDocument("","",null);}if(_7.documentElement){_7.removeChild(_7.documentElement);}return _7;};AlpsUtil.getXMLDOMFromStr=function(_8){try{if(typeof ActiveXObject!="undefined"&&typeof GetObject!="undefined"){var _9=new ActiveXObject("Microsoft.XMLDOM");_9.loadXML(_8);return _9;}else{if(typeof DOMParser!="undefined"){return (new DOMParser()).parseFromString(_8,"text/xml");}else{return null;}}}catch(error){return null;}};AlpsUtil.getElementContent=function(e,_b){var n=e.getElementsByTagName(_b)[0];if(n){return AlpsUtil.getNodeContent(n);}};AlpsUtil.getNodeContent=function(n){var nl=n.childNodes;if(nl.length==1){return nl[0].nodeValue;}if(nl.length>1){return nl[1].nodeValue;}};AlpsUtil.getElementAttribute=function(e,_10,_11){var n=e.getElementsByTagName(_10)[0];if(n){return n.getAttribute(_11);}};AlpsUtil.getProperties=function(e){var a=new Object;var p=e.getElementsByTagName("property");for(var i=0;i<p.length;i++){var _17=p[i].getAttribute("name");var _18=p[i].getAttribute("value");if(!_18){_18=AlpsUtil.getNodeContent(p[i]);}if(_17&&_18){a[_17]=_18;}}return a;};Array.prototype._indexOf=function(s){for(var i=0;i<this.length;i++){if(this[i]==s){return i;}}return -1;};Array.prototype._clear=function(){while(this.pop()){}};Array.prototype._release=function(){if(_bi.type!=1){return;}for(var i=0;i<this.length;++i){if(typeof (this[i])=="object"){_objrelease(this[i]);}delete this[i];}};function _setTimeout(obj,_1d,_1e){var arg=[];for(var i=3;i<arguments.length;++i){arg.push(arguments[i]);}var _21=window.setTimeout(function(){_1d.apply(obj,arg);},_1e);return _21;}function _setInterval(obj,_23,_24){var arg=[];for(var i=3;i<arguments.length;++i){arg.push(arguments[i]);}var _27=window.setInterval(function(){_23.apply(obj,arg);},_24);return _27;}function _objrelease(obj,_29){if(_bi.type!=1){return;}if(!obj){return;}if(typeof (obj)!="object"){return;}if(!_29&&typeof (obj.release)!="function"){return;}if(typeof (obj.releasing)=="function"){return;}obj.releasing=function(){};for(var i in obj){if(!obj[i]){continue;}if(typeof (obj[i])=="object"){if(typeof (obj[i]._release)=="function"){obj[i]._release();}else{if(typeof (obj[i].release)=="function"){obj[i].release();}}delete obj[i];}else{if(typeof (obj[i])!="function"){delete obj[i];}}}}function _AlphaImageLoader(img,w,h){if(_bi.type==1&&_bi.version<=6&&img.src.match(/\.(png)$/i)){var src=img.src;img.src=AlpsUtil.blankImg;img.width=w;img.height=h;img.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+src+"',sizingMethod='image');";}}String.prototype.trimLeft=function(){return this.replace(/^\s+|\s+$/g,"");};String.prototype.trimRight=function(){return this.replace(/\s+$/g,"");};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");};function BrowserInfo(){this.type=0;this.version=0;this.os=null;var ua=navigator.userAgent.toLowerCase();if(ua.indexOf("opera")!=-1){this.type=4;this.version=9;if(ua.indexOf("opera/7")!=-1||ua.indexOf("opera 7")!=-1){this.version=7;}else{if(ua.indexOf("opera/8")!=-1||ua.indexOf("opera 8")!=-1){this.version=8;}}}else{if(ua.indexOf("msie")!=-1&&document.all){this.type=1;this.version=6;if(ua.indexOf("msie 5")!=-1){this.version=5;}else{if(typeof (document.documentElement.style.maxHeight)!="undefined"){if(document.documentMode&&document.documentMode>=8){this.version=8;}else{this.version=7;}}else{this.version=6;}}}else{if(ua.indexOf("safari")!=-1){this.type=3;}else{if(ua.indexOf("mozilla")!=-1){this.type=2;if(ua.indexOf("firefox")!=-1){this.subType=1;this.version=1.5;if(ua.indexOf("firefox/1.0")!=-1){this.version=1;}}else{if(ua.indexOf("netscape")!=-1){this.subType=2;}else{if(ua.indexOf("seamonkey")!=-1){this.subType=4;}else{this.subType=3;this.version=1.8;if(ua.indexOf("rv:1.7")!=-1){this.version=1.7;}}}}}}}}if(ua.indexOf("x11;")!=-1){this.os=1;}else{if(ua.indexOf("macintosh")!=-1){this.os=2;}}}var _bi=new BrowserInfo();function AlpsEvent(){}function EventObj(_30,_31,_32){this.instance=_30;this.propertyName=_31;this.listenerFn=_32;}AlpsEvent.addEvent=function(_33,_34,_35){var _36=AlpsEvent.getPropertyName(_34);if(_33[_36]==null){_33[_36]=new Array;}_33[_36].push(_35);return new EventObj(_33,_34,_35);};AlpsEvent.removeEvent=function(_37){var _38=AlpsEvent.getPropertyName(_37.propertyName);var _39=_37.instance[_38];for(var idx=0;idx<_39.length;idx++){if(_39[idx]==_37.listenerFn){_39.splice(idx,1);return;}}};AlpsEvent.clearEvents=function(_3b,_3c){var _3d=AlpsEvent.getPropertyName(_3c);_3b[_3d]=null;};AlpsEvent.triggerEvent=function(_3e,_3f){var _40=AlpsEvent.getEventFireFlag(_3f);if(_3e[_40]){return;}_3e[_40]=1;var _41=AlpsEvent.getPropertyName(_3f);var _42=_3e[_41];if(_42&&_42.length>0){var arg=[];for(var i=2;i<arguments.length;++i){arg.push(arguments[i]);}for(var i=0;i<_42.length;++i){var fn=_42[i];if(fn){try{fn.apply(_3e,arg);}catch(e){}}}}delete _3e[_40];};AlpsEvent.isEventRunning=function(_46,_47){var _48=AlpsEvent.getEventFireFlag(_47);if(_46[_48]){return true;}else{return false;}};AlpsEvent.bindEvent=function(_49,_4a,_4b,_4c){return AlpsEvent.addEvent(_49,_4a,function(){_4c.apply(_4b,arguments);});};AlpsEvent.bindBuiltInEvent=function(obj,_4e,_4f,_50){var _51=AlpsEvent.makeBinder(_4f,_50);return AlpsEvent.addBuiltInEvent(obj,_4e,_51);};AlpsEvent.makeBinder=function(_52,_53){return function(e){if(!e){e=window.event;}if(e&&!e.target){e.target=e.srcElement;}_53.call(_52,e);};};AlpsEvent.getPropertyName=function(_55){return "_aevt_"+_55;};AlpsEvent.getEventFireFlag=function(_56){return "_fire_"+_56;};AlpsEvent.addBuiltInEvent=function(obj,_58,_59){if(_bi.type==3&&_58=="dblclick"){obj["on"+_58]=_59;return;}if(obj.addEventListener){obj.addEventListener(_58,_59,false);}else{if(obj.attachEvent){obj.attachEvent("on"+_58,_59);}else{obj["on"+_58]=_59;}}};AlpsEvent.removeBuiltInEvent=function(obj,_5b,_5c){if(obj.removeEventListener){obj.removeEventListener(_5b,_5c,false);}else{if(obj.detachEvent){obj.detachEvent("on"+_5b,_5c);}else{obj["on"+_5b]=null;}}};function AlpsCallback(){this.callbacks=new Object();this.timer=new Object();this.timeout=1500;}AlpsCallback.prototype.send=function(url,_5e){var id="ID"+(new Date().getTime().toString(16))+Math.floor(Math.random()*10000);var src=""+url;if(src.indexOf("?")<0){src+="?";}else{src+="&";}src+="_cbid="+id;this.callbacks[id]=_5e;var scr=document.createElement("script");scr.id=id;scr.src=src;scr.type="text/javascript";document.body.appendChild(scr);this.timer[id]=window.setTimeout(function(){_cb.invoke(id);},this.timeout);return id;};AlpsCallback.prototype.invoke=function(id){if(this.timer[id]){window.clearTimeout(this.timer[id]);delete this.timer[id];}var _63=this.callbacks[id];if(!_63){return;}var _64=new Array();for(var i=1;i<arguments.length;i++){_64.push(arguments[i]);}delete this.callbacks[id];document.body.removeChild(document.getElementById(id));_63.apply(this,_64);};var _cb=new AlpsCallback();
function Dms(_1){if(typeof (_1)=="string"){this.setByDmsStr(_1);}else{if(typeof (_1)=="number"){this.setByDegree(_1);}}}Dms.prototype.set=function(d,m,s,_5){if(_5==undefined){this.sign=d>=0?1:-1;}else{this.sign=_5;}this.d=Math.abs(d);this.m=m;this.s=s;};Dms.prototype.setByDegree=function(_6){this.sign=_6>=0?1:-1;_6=Math.abs(_6);this.d=Math.floor(_6);var _7=(_6-this.d)*60;this.m=Math.floor(_7);this.s=(_7-this.m)*60;};Dms.prototype.setByDmsStr=function(_8){var _9=_8.split("/");if(_9.length==1){this.setByDegree(parseFloat(_9[0]));}else{if(_9.length==2){var d=parseFloat(_9[0]);var _b=new String(_9[0]);_b=_b.trimLeft();var _c=_b.charAt(0)=="-"?-1:1;d=Math.abs(d);d=Math.floor(d);var _d=parseFloat(_9[1]);var m=Math.floor(_d);var s=(_d-m)*60;this.set(d,m,s,_c);}else{if(_9.length==3){var d=parseFloat(_9[0]);var _b=new String(_9[0]);_b=_b.trimLeft();var _c=_b.charAt(0)=="-"?-1:1;d=Math.abs(d);d=Math.floor(d);var m=parseFloat(_9[1]);var s=parseFloat(_9[2]);this.set(d,Math.floor(m),s,_c);}}}};Dms.prototype.getDegree=function(){var _10=0;_10=this.d+this.m/60+this.s/60/60;_10*=this.sign;return _10;};Dms.prototype.toString=function(){var d=this.d;var m=this.m;var s=Math.round(this.s*1000)/1000;if(s==60){m+=1;s=0;if(m==60){if(d>=0){d+=1;}else{d-=1;}m=0;}}var str=d+"/"+m+"/"+s;if(this.sign==-1){str="-"+str;}return str;};function LLPoint(_15,_16){this.lat=0;this.lon=0;if(arguments.length==1&&typeof (arguments[0])=="string"){var sp=arguments[0].split(",");this.lat=(new Dms(sp[0])).getDegree();this.lon=(new Dms(sp[1])).getDegree();}else{if(typeof (_15)=="object"){this.lat=_15.getDegree();}else{if(typeof (_15)=="string"){this.lat=(new Dms(_15)).getDegree();}else{this.lat=_15;}}if(typeof (_16)=="object"){this.lon=_16.getDegree();}else{if(typeof (_16)=="string"){this.lon=(new Dms(_16)).getDegree();}else{this.lon=_16;}}}}LLPoint.prototype.set=function(_18,_19){this.lat=_18;this.lon=_19;};LLPoint.prototype.toString=function(){return (new Dms(this.lat)).toString()+","+(new Dms(this.lon)).toString();};LLPoint.prototype.distance=function(pos){var _1b=6370300;var x1=Math.cos(this.lon*Math.PI/180)*Math.cos(this.lat*Math.PI/180);var y1=Math.sin(this.lon*Math.PI/180)*Math.cos(this.lat*Math.PI/180);var z1=Math.sin(this.lat*Math.PI/180);var x2=Math.cos(pos.lon*Math.PI/180)*Math.cos(pos.lat*Math.PI/180);var y2=Math.sin(pos.lon*Math.PI/180)*Math.cos(pos.lat*Math.PI/180);var z2=Math.sin(pos.lat*Math.PI/180);var d=x1*x2+y1*y2+z1*z2;if(d<-1){d=-1;}if(d>1){d=1;}return _1b*Math.acos(d);};LLPoint.prototype.get1stMeshCode=function(){return Math.floor((this.lat+1e-11)*1.5)*100+Math.floor((this.lon+1e-11)-100);};LLPoint.prototype.getMeshCode=function(){var lat=this.lat+1e-11;var lon=this.lon+1e-11;var _25=Math.floor(lat*1.5);var _26=Math.floor(lon-100);var _27=Math.floor(lat*120-_25*80);var _28=Math.floor(lon*80-_26*80-8000);return _25*1000000+_26*10000+Math.floor(_27/10)*1000+Math.floor(_28/10)*100+(_27%10)*10+_28%10;};function ConvertRADtoDEGREE(_29){return _29*180/Math.PI;}function ConvertDEGREEtoRAD(_2a){return _2a*Math.PI/180;}function BesslWgs(_2b,_2c){var eps=1e-15;var pi=Math.PI;var ar=new Array(2);ar[0]=6377397.155;ar[1]=6378137;var f=new Array(2);f[0]=1/299.152813;f[1]=1/298.257223563;var e2=new Array(2);e2[0]=f[0]*(2-f[0]);e2[1]=f[1]*(2-f[1]);var dx=new Array(2);var dy=new Array(2);var dz=new Array(2);dx[0]=-146.43;dy[0]=507.89;dz[0]=681.46;dx[1]=146.43;dy[1]=-507.89;dz[1]=-681.46;var _in=_2b;var _36=1-_2b;var _37=ConvertDEGREEtoRAD(_2c.lat);var _38=ConvertDEGREEtoRAD(_2c.lon);var _39=0;var _3a=ar[_in]/Math.sqrt(1-e2[_in]*Math.sin(_37)*Math.sin(_37));var _3b=(_3a+_39)*Math.cos(_37)*Math.cos(_38);var _3c=(_3a+_39)*Math.cos(_37)*Math.sin(_38);var _3d=(_3a*(1-e2[_in])+_39)*Math.sin(_37);var x=_3b+dx[_in];var y=_3c+dy[_in];var z=_3d+dz[_in];var p=Math.sqrt(x*x+y*y);var mu0=z/p;var aa=Math.sqrt((1-e2[_36])*mu0*mu0+1);var aa3=aa*aa*aa;var ff=mu0-z/p-ar[_36]*e2[_36]*mu0/p/aa;var df=1-ar[_36]*e2[_36]/p/aa3;var mu1=mu0-ff/df;var aas;for(var i=0;(ff>eps||-eps>ff)&&i<10;i++){mu0=mu1;aa=Math.sqrt((1-e2[_36])*mu0*mu0+1);aa3=aa*aa*aa;aas=ar[_36]*e2[_36]/p;ff=mu0-z/p-aas*mu0/aa;df=1-aas/aa3;mu1=mu0-ff/df;}var _4a=Math.atan2(mu1,1);var _4b=Math.atan2(y,x);var _4c=ar[_36]/Math.sqrt(1-e2[_36]*Math.sin(_4a)*Math.sin(_4a));return new LLPoint(ConvertRADtoDEGREE(_4a),ConvertRADtoDEGREE(_4b));}
function Point(_1,_2){this.x=_1;this.y=_2;}Point.prototype.set=function(_3,_4){this.x=_3;this.y=_4;};Point.prototype.rotate=function(_5,_6){var _7=_6*Math.PI/180;var _8=this.x-_5.x;var _9=this.y-_5.y;var _a=_8*Math.cos(_7)-_9*Math.sin(_7);var _b=_8*Math.sin(_7)+_9*Math.cos(_7);this.x=_5.x+_a;this.y=_5.y+_b;};Point.distance=function(_c,_d){var _e=_c.x-_d.x;var _f=_c.y-_d.y;return Math.sqrt(_e*_e+_f*_f);};Point.sqdist=function(_10,_11){var _12=_10.x-_11.x;var _13=_10.y-_11.y;return _12*_12+_13*_13;};Point.angle=function(_14,_15){var _16=_14.x-_15.x;var _17=_14.y-_15.y;return Math.atan2(_17,_16)*180/Math.PI;};Point.prototype.toString=function(){return "("+this.x+", "+this.y+")";};Point.prototype.equals=function(X){if(!X){return false;}return this.x==X.x&&this.y==X.y;};Point.prototype.approxEquals=function(X){if(!X){return false;}return approxCompare(this.x,X.x)&&approxCompare(this.y,X.y);};function Size(w,h){this.width=w;this.height=h;}Size.prototype.set=function(w,h){this.width=w;this.height=h;};Size.prototype.toString=function(){return "("+this.width+", "+this.height+")";};Size.prototype.equals=function(s){if(!s){return false;}return this.width==s.width&&this.height==s.height;};Size.prototype.approxEquals=function(s){if(!s){return false;}return approxCompare(this.width,s.width)&&approxCompare(this.height,s.height);};function approxCompare(rh,Ai){return Math.round(rh*1000000)==Math.round(Ai*1000000);}
function SProjection(_1,_2,_3){this.m_projCode=_1;this.origin=new LLPoint(_2.lat,_2.lon);this.factor=_3;}SProjection.prototype.release=function(){_objrelease(this);};function EllipsoID(_4){this.form=_4;if(_4==0){this.a=6370300;this.b=6370300;this.e2=0;}else{this.a=6377397.155;this.b=6356078.96325;this.e2=(this.a*this.a-this.b*this.b)/(this.a*this.a);}}function MercatorConversion(_5,_6){this.proj=new SProjection(1,_5,1);this.ellipsoid=new EllipsoID(_6);}MercatorConversion.prototype.QPI=Math.atan(1);MercatorConversion.prototype.EPS=2.220446049250313e-16;MercatorConversion.prototype.MAX=Number.MAX_VALUE;MercatorConversion.prototype.set=function(_7,_8){this.proj=new SProjection(1,_7,1);this.ellipsoid=new EllipsoID(_8);};MercatorConversion.prototype.getLLPoint=function(_9){var x=_9.x;var y=_9.y;var _c=this.proj.origin.lat*Math.PI/180;var _d=this.proj.origin.lon*Math.PI/180;var _e=0;var _f=0;var e,_11,_12,Xm,XM,Y,_16;var a=this.ellipsoid.a;var b=this.ellipsoid.b;var e2=this.ellipsoid.e2;e=Math.sqrt(e2);_11=e*Math.sin(_c);_12=a*Math.cos(_c)/Math.sqrt(1-e2*Math.sin(_c)*Math.sin(_c));Xm=-_12*(4*this.QPI+_d);XM=_12*(4*this.QPI-_d);Y=this.MAX;if(-Y<y&&y<Y){_e=x/_12+_d;if(this.ellipsoid.form==0){_f=2*(Math.atan(Math.exp(y/_12)*Math.tan(this.QPI+_c/2))-this.QPI);}else{var i=0;_f=2*(Math.atan(Math.exp(y/_12)*Math.tan(this.QPI+_c/2))-this.QPI);_16=Math.log(Math.tan(this.QPI+_f/2)/Math.tan(this.QPI+_c/2))+e/2*(Math.log((1-e*Math.sin(_f))*(1+_11)/(1-_11)/(1+e*Math.sin(_f))))-y/_12;while(_16<=-this.EPS||this.EPS<=_16){_f-=_16/(1-e2)*(Math.cos(_f)*(1-e2*Math.sin(_f)));_16=Math.log(Math.tan(this.QPI+_f/2)/Math.tan(this.QPI+_c/2))+e/2*(Math.log((1-e*Math.sin(_f))*(1+_11)/(1-_11)/(1+e*Math.sin(_f))))-y/_12;i++;if(100<i){break;}}}}if(_e>Math.PI){_e-=(2*Math.PI);}else{if(_e<-Math.PI){_e+=(2*Math.PI);}}var lat=_f*180/Math.PI;var lon=_e*180/Math.PI;return new LLPoint(lat,lon);};MercatorConversion.prototype.getMeterPoint=function(_1d){var lat=_1d.lat;var lon=_1d.lon;var _20=lat*Math.PI/180;var _21=lon*Math.PI/180;var _22=this.proj.origin.lat*Math.PI/180;var _23=this.proj.origin.lon*Math.PI/180;var a=this.ellipsoid.a;var b=this.ellipsoid.b;var e2=this.ellipsoid.e2;var _27,_28;var xx=0,yy=0;if((-2*this.QPI+this.EPS<_20)&&(_20<2*this.QPI-this.EPS)){var e=Math.sqrt(e2);_28=e*Math.sin(_22);_27=a*Math.cos(_22)/Math.sqrt(1-e2*Math.sin(_22)*Math.sin(_22));xx=_27*(_21-_23);yy=_27*(Math.log(Math.tan(this.QPI+_20/2)/Math.tan(this.QPI+_22/2))+e/2*(Math.log((1-e*Math.sin(_20))/(1-_28))-Math.log((1+e*Math.sin(_20))/(1+_28))));}return new Point(xx,yy);};MercatorConversion.prototype.release=function(){_objrelease(this);};function UTMConversion(_2c,_2d){this.proj=new SProjection(0,_2c,_2d);}UTMConversion.prototype.A=6377397.155;UTMConversion.prototype.E=0.006674372231315;UTMConversion.prototype.meridian=function(_2e,_2f){var Ba,Bb,Bc,Bd,Be;Ba=1.005037306049*(_2f-_2e);Bb=0.0050478492403*(Math.sin(2*_2f)-Math.sin(2*_2e))/2;Bc=0.0000105637868*(Math.sin(4*_2f)-Math.sin(4*_2e))/4;Bd=2.063332e-8*(Math.sin(6*_2f)-Math.sin(6*_2e))/6;Be=3.8853e-11*(Math.sin(8*_2f)-Math.sin(8*_2e))/8;return this.A*(1-this.E)*(Ba-Bb+Bc-Bd+Be);};UTMConversion.prototype.getLLPoint=function(_35){var x=_35.y;var y=_35.x;var _38=this.proj.origin.lat*Math.PI/180;var _39=this.proj.origin.lon*Math.PI/180;var _3a=this.proj.factor;var ra0=0;var ab=1;var ph0=Math.PI*0.2;var m=x/_3a+this.meridian(ra0,_38);y=y/_3a;var mot=1/(this.A*(1-this.E));var si;var n=0;while(ab>1e-14){var s=this.meridian(ra0,ph0);si=Math.sin(ph0);var ph1=ph0+(m-s)*Math.pow(1-this.E*si*si,1.5)*mot;ab=ph1-ph0;ph0=ph1;if(ab<0){ab=-ab;}if(++n>100){break;}}var co=Math.cos(ph0);var cr=Math.sqrt(1-this.E*si*si);var ni=cr/this.A;var ri=cr*cr*cr*mot;var _48=(co*co)*this.E/(1-this.E);var t=Math.tan(ph0);var t2=t*t;var t4=t2*t2;var y1=y*ni;var y2=y1*y1;var y4=y2*y2;var f1=-0.08333333333333333*y2*(5+3*t2+_48-9*t2*_48);var f2=0.002777777777777777*y4*(61+90*t2+45*t4);var _51=ph0-0.5*y*y1*ri*t*(1+f1+f2);f1=-0.1666666666666666*y2*(1+2*t2+_48);f2=0.008333333333333333*y4*(5+28*t2+24*t4);var _52=_39+y1/co*(1+f1+f2);if(_52>Math.PI){_52-=(2*Math.PI);}else{if(_52<-Math.PI){_52+=(2*Math.PI);}}return new LLPoint(_51*180/Math.PI,_52*180/Math.PI);};UTMConversion.prototype.getMeterPoint=function(_53){var _54=_53.lat*Math.PI/180;var _55=_53.lon*Math.PI/180;var _56=this.proj.origin.lat*Math.PI/180;var _57=this.proj.origin.lon*Math.PI/180;var _58=this.proj.factor;_55-=_57;var s=Math.sin(_54);var c=Math.cos(_54);var c2=c*c;var c4=c2*c2;var t=Math.tan(_54);var t2=t*t;var t4=t2*t2;var h2=this.E*c2/(1-this.E);var h4=h2*h2;var N=this.A/Math.sqrt(1-this.E*s*s);var _63=_55*_55;var _64=_63*c2;var _65=_64*_64;var B=this.meridian(_56,_54);var x1=_64*(5-t2+9*h2+4*h4)/24;var x2=_65*(61-58*t2+t4+270*h2-330*h2*t2)/720;var y1=_64*(1-t2+h2)/6;var y2=_65*(5-18*t2+t4+14*h2-58*h2*t2)/120;var xx=_58*(B+N*s*c*_63*(0.5+x1+x2));var yy=_58*N*c*_55*(1+y1+y2);return new Point(yy,xx);};UTMConversion.prototype.release=function(){_objrelease(this);};function MeterMMConversion(_6d,_6e){this.scale=_6d;this.angle=_6e;}MeterMMConversion.prototype.getMMPoint=function(_6f){var _70=Math.cos(-this.angle);var _71=Math.sin(-this.angle);var x=(_6f.x*_70-_6f.y*_71)*1000/this.scale;var y=(_6f.x*_71+_6f.y*_70)*1000/this.scale;return new Point(x,y);};MeterMMConversion.prototype.getMeterPoint=function(_74){var _75=Math.cos(this.angle);var _76=Math.sin(this.angle);var x=(_74.x*_75-_74.y*_76)*this.scale/1000;var y=(_74.x*_76+_74.y*_75)*this.scale/1000;return new Point(x,y);};var MAXLEVEL=18;var RAD_PER_DEG=Math.PI/180;var M_PER_DEGREE=111111;var EARTH_CIRCUM_M=M_PER_DEGREE*360;function sinh(x){var ret=Math.exp(x);ret=(ret-1/ret)/2;return ret;}function YUSMercConversion(_7b){this.magnify=1;this.init(_7b);this.circum_px=1<<(26-this.level_);this.defscale=399999600000/this.circum_px;this.meters_per_pixel_=EARTH_CIRCUM_M/this.circum_px;this.x_per_lon_=this.circum_px/360;}YUSMercConversion.prototype.init=function(_7c){if(_7c<1){this.level_=1;}else{if(_7c>MAXLEVEL){this.level_=MAXLEVEL;}else{this.level_=_7c;}}};YUSMercConversion.prototype.pixel_height=function(){return this.circum_px;};YUSMercConversion.prototype.ll_to_pxy=function(_7d){var _7e=Math.abs(_7d.lat);var _7f=_7d.lon;if(_7f>180){_7f-=360;}_7f+=180;var _80=new Point(0,0);if(_7e>=90){return _80;}if(_7f>360){_7f-=360;}if(_7f<0){_7f+=360;}_7e*=RAD_PER_DEG;_80.x=_7f*this.x_per_lon_;var _81=Math.log(Math.tan(_7e)+1/Math.cos(_7e))/Math.PI;_80.y=_81*this.pixel_height()/2;if(_7d.lat<0){_80.y=-_80.y;}_80.x*=this.magnify;_80.y*=this.magnify;return _80;};YUSMercConversion.prototype.pxy_to_ll=function(_82){var _83=new LLPoint(0,0);var _84=new Point(_82.x/this.magnify,_82.y/this.magnify);var _85=_84.x/this.x_per_lon_;var _86=(_84.y/(this.pixel_height()/2))*Math.PI;_86=Math.atan(sinh(_86))/RAD_PER_DEG;if(_85<0){_85+=360;}if(_85>360){_85-=360;}_83.lon=_85-180;if(_86<=-90||_86>=90){return _83;}_83.lat=_86;return _83;};function CoordinatesConversion(){this.m_projCode=0;this.m_UTMConv=new UTMConversion(new LLPoint(0,0),0);this.m_MercatorConv=new MercatorConversion(new LLPoint(0,0),0);this.m_MeterMMConv=new MeterMMConversion(25000,0);this.m_YUSMercConv=new YUSMercConversion(1);this.m_center=new LLPoint(0,0);this.m_windowWidth=0;this.m_windowHeight=0;}CoordinatesConversion.prototype.getProjOrigin=function(){if(this.m_projCode==0){return this.m_UTMConv.proj.origin;}else{if(this.m_projCode==1){return this.m_MercatorConv.proj.origin;}else{if(this.m_projCode==2){return new LLPoint(0,-180);}}}};CoordinatesConversion.prototype.setProjConv=function(_87,_88,_89){this.m_projCode=_87;if(_87==0){this.m_UTMConv=new UTMConversion(new LLPoint(_88.lat,_88.lon),_89);}else{if(_87==1){this.m_MercatorConv=new MercatorConversion(new LLPoint(_88.lat,_88.lon),_89);}else{if(_87==2){this.m_YUSMercConv=new YUSMercConversion(_89);}}}};CoordinatesConversion.prototype.setScale=function(_8a){if(this.m_projCode==2){this.m_YUSMercConv.magnify=this.m_YUSMercConv.defscale/_8a;}else{this.m_MeterMMConv.scale=_8a;}};CoordinatesConversion.prototype.setAngle=function(_8b){this.m_MeterMMConv.angle=_8b*Math.PI/180;};CoordinatesConversion.prototype.getScale=function(){return this.m_MeterMMConv.scale;};CoordinatesConversion.prototype.getAngle=function(){return this.m_MeterMMConv.angle*180/Math.PI;};CoordinatesConversion.prototype.setCenter=function(_8c){if(Math.abs(_8c.lon)>360){_8c.lon%=360;}if(_8c.lon<-180){_8c.lon+=360;}else{if(_8c.lon>180){_8c.lon-=360;}}if(_8c.lat<-90||_8c.lat>90){_8c.lat%=90;}this.m_center=new LLPoint(_8c.lat,_8c.lon);};CoordinatesConversion.prototype.setWindowSize=function(_8d,_8e){this.m_windowWidth=_8d;this.m_windowHeight=_8e;};CoordinatesConversion.prototype.LL2Meter=function(_8f){if(this.m_projCode==0){return this.m_UTMConv.getMeterPoint(_8f);}else{return this.m_MercatorConv.getMeterPoint(_8f);}};CoordinatesConversion.prototype.Meter2LL=function(_90){if(this.m_projCode==0){return this.m_UTMConv.getLLPoint(_90);}else{return this.m_MercatorConv.getLLPoint(_90);}};CoordinatesConversion.prototype.MM2Log=function(_91){var _92=this.m_MeterMMConv.getMMPoint(this.LL2Meter(this.m_center));var _93=this.m_windowWidth/2-_92.x*10+_91.x*10;var _94=-this.m_windowHeight/2-_92.y*10+_91.y*10;return new Point(_93,-_94);};CoordinatesConversion.prototype.Log2MM=function(_95){var _96=this.m_MeterMMConv.getMMPoint(this.LL2Meter(this.m_center));var mmX=_96.x-this.m_windowWidth/2/10+_95.x/10;var mmY=_96.y+this.m_windowHeight/2/10-_95.y/10;return new Point(mmX,mmY);};CoordinatesConversion.prototype.LL2MM=function(_99){return this.m_MeterMMConv.getMMPoint(this.LL2Meter(_99));};CoordinatesConversion.prototype.MM2LL=function(_9a){return this.Meter2LL(this.m_MeterMMConv.getMeterPoint(_9a));};CoordinatesConversion.prototype.LL2Log=function(_9b){if(this.m_projCode!=2){return this.MM2Log(this.m_MeterMMConv.getMMPoint(this.LL2Meter(_9b)));}else{var _9c=this.m_YUSMercConv.ll_to_pxy(_9b);var _9d=this.m_YUSMercConv.ll_to_pxy(this.m_center);var _9e=new Point(0,0);_9e.x=this.m_windowWidth/2-_9d.x+_9c.x;_9e.y=this.m_windowHeight/2+_9d.y-_9c.y;return _9e;}};CoordinatesConversion.prototype.Meter2Log=function(_9f){return this.MM2Log(this.m_MeterMMConv.getMMPoint(_9f));};CoordinatesConversion.prototype.Log2LL=function(_a0){if(this.m_projCode!=2){return this.Meter2LL(this.m_MeterMMConv.getMeterPoint(this.Log2MM(_a0)));}else{var _a1=new Point(0,0);var _a2=this.m_YUSMercConv.ll_to_pxy(this.m_center);_a1.x=_a2.x-this.m_windowWidth/2+_a0.x;_a1.y=_a2.y+this.m_windowHeight/2-_a0.y;return this.m_YUSMercConv.pxy_to_ll(_a1);}};CoordinatesConversion.prototype.Log2Meter=function(_a3){return this.m_MeterMMConv.getMeterPoint(this.Log2MM(_a3));};CoordinatesConversion.prototype.release=function(){_objrelease(this);};
var _delaytime=300;function getObjPos(g,_2){var _3=new Point(0,0);while(g&&g!=_2){_3.x+=g.offsetLeft;_3.y+=g.offsetTop;g=g.offsetParent;}return _3;}function getObjPos2(_4){var _5=new Point(0,0);while(_4){_5.x+=_4.offsetLeft;_5.y+=_4.offsetTop;_4=_4.offsetParent;}return _5;}function getRelativePos(e,_7,_8){if(!_8){_8=new Point(0,0);}if(typeof e.pageX!="undefined"){var Kd=getObjPos2(_7);_8.x=e.pageX-Kd.x;_8.y=e.pageY-Kd.y;}else{if(typeof e.offsetX!="undefined"){var _a=e.target||e.srcElement;var xg=getObjPos(_a,_7);_8.x=e.offsetX+xg.x;_8.y=e.offsetY+xg.y;}}return _8;}function KeyCodesArray(_c){if(_c){for(var i=_c.length-1;i>=0;--i){this.add(_c[i]);}}}KeyCodesArray.prototype.add=function(_e){if(!this.contains(_e)){this["key"+_e]=1;}};KeyCodesArray.prototype.remove=function(_f){if(this.exist(_f)){delete this["key"+_f];}};KeyCodesArray.prototype.contains=function(_10){return this["key"+_10]==1;};KeyCodesArray.prototype.exist=function(_11){return this["key"+_11]==1||this["key"+_11]==2;};KeyCodesArray.prototype.sleep=function(){for(var _12 in this){if(typeof this[_12]!="function"){this[_12]=2;}}};KeyCodesArray.prototype.wakeup=function(){for(var _13 in this){if(typeof this[_13]!="function"){this[_13]=1;}}};function Nothing(){return false;}function CancelBubble(e){if(_bi.type==1){window.event.cancelBubble=true;window.event.returnValue=false;}else{e.cancelBubble=true;if(e.preventDefault){e.preventDefault();}if(e.stopPropagation){e.stopPropagation();}}}function setMouseCursor(obj,_16){try{obj.style.cursor=_16;}catch(p){if(_16=="pointer"){setMouseCursor(obj,"hand");}}}function loadLatLonFromDOMNode(n){var _18=n.getAttribute("unit");var _19=AlpsUtil.getNodeContent(n);var _1a=_19.split(",");var lat=_1a[0];var lon=_1a[1];if(_18=="dms"){return new LLPoint(lat,lon);}else{if(_18=="degree"){return new LLPoint(parseFloat(lat),parseFloat(lon));}else{if(_18=="msec"){return new LLPoint(parseInt(lat)/3600000,parseInt(lon)/3600000);}}}}var _datumConverting=false;function datumConvert(_1d,_1e,_1f,_20,_21){var _22=_1d;if(_1e==_1f){if(_21){_21(_22);}return _22;}else{if(typeof (_dc)!="undefined"&&_dc.server&&!_datumConverting&&_dc.getExistsMesh(_22)){if(_1e=="wgs84"){_datumConverting=true;_dc.getRevParam(_1d,function(dB,dL){_datumConverting=false;if(dB!=undefined&&dL!=undefined){_22=new LLPoint(_1d.lat-dB,_1d.lon-dL);if(_21){_21(_22);}}else{_22=BesslWgs(1,_1d);if(_21){_21(_22);}}},!_20);return _22;}else{if(_1e=="tokyo97"){_datumConverting=true;_dc.getParam(_1d,function(dB,dL){_datumConverting=false;if(dB!=undefined&&dL!=undefined){_22=new LLPoint(_1d.lat+dB,_1d.lon+dL);if(_21){_21(_22);}}else{_22=BesslWgs(0,_1d);if(_21){_21(_22);}}},!_20);return _22;}}}else{if(_1f=="wgs84"||_1f=="tokyo97"){if(_1e=="wgs84"){_22=BesslWgs(1,_1d);if(_21){_21(_22);}return _22;}else{if(_1e=="tokyo97"){_22=BesslWgs(0,_1d);if(_21){_21(_22);}return _22;}}}}}if(_21){_21(_22);}return _22;}function ImageMaker(){}ImageMaker.createImg=function(_27,_28,_29,_2a,_2b){var img=document.createElement("IMG");if(_27&&_27.length>0){img.src=_27;}if(_2a){img.width=_2a;}if(_2b){img.height=_2b;}img.style.position="absolute";img.style.top="0px";img.style.left="0px";if(_29){img.style.zIndex=_29;}if(_bi.type==1){img.unselectable="on";img.onselectstart=Nothing;img.galleryImg="no";}else{img.style.MozUserSelect="none";}img.oncontextmenu=Nothing;img.style.border="0px";img.style.padding="0px";img.style.margin="0px";if(_28){img.style.visibility=_28;}_AlphaImageLoader(img,_2a,_2b);return img;};function SpecType(){this.id="";this.name="";}SpecType.prototype.toString=function(){var str="SpecType:";str+="id: "+this.id+"\t"+"name: "+this.name;return str;};function SpecItem(){this.id="";this.name="";}SpecItem.prototype.toString=function(){var str="SpecItem:";str+="id: "+this.id+"\t"+"name: "+this.name;return str;};function ProjInfo(n2){if(n2.nodeName=="projection"){this.loadXML(n2);}else{this.name=arguments[0];this.code=arguments[1];this.origin=new LLPoint(arguments[2],arguments[3]);this.subInfo=arguments[4];this.org1stMeshCode=0;this.id=0;}}ProjInfo.prototype.loadXML=function(n2){this.name=n2.getAttribute("name");var _31=n2.getAttribute("type");this.code=0;if(_31=="UTM"){this.code=0;}else{if(_31=="Mercator"){this.code=1;}else{if(_31=="YMercator"){this.code=2;}}}var nl3=n2.childNodes;for(var i=0;i<nl3.length;++i){var n3=nl3[i];if(n3.nodeType==1&&n3.nodeName=="origin"){this.origin=loadLatLonFromDOMNode(n3);this.org1stMeshCode=this.origin.get1stMeshCode();}else{if(n3.nodeType==1&&n3.nodeName=="projfactor"){this.subInfo=parseFloat(AlpsUtil.getNodeContent(n3));}else{if(n3.nodeType==1&&n3.nodeName=="ellipse"){var _35=AlpsUtil.getNodeContent(n3);if(_35=="bessele"){this.subInfo=1;}else{if(_35=="sphere"){this.subInfo=0;}}}else{if(n3.nodeType==1&&n3.nodeName=="level"){this.level=parseInt(AlpsUtil.getNodeContent(n3));this.scale=399999600000/(1<<(26-this.level));}}}}}var _36=n2.getAttribute("vendor");if(_36=="alps"){this.vendor=1;}else{if(_36=="inc"){this.vendor=2;}else{this.vendor=1;}}var _37=n2.getAttribute("maxTileX");if(_37){this.maxTileX=parseInt(_37);}var _38=n2.getAttribute("minTileX");if(_38){this.minTileX=parseInt(_38);}var _39=n2.getAttribute("datum");if(_39=="tokyo97"){this.datum="tokyo97";}else{if(_39=="wgs84"){this.datum="wgs84";}else{this.datum="tokyo97";}}};ProjInfo.prototype.release=function(){_objrelease(this);};function MapLayer(n1){this.projInfo=new Array;this.projInfo_inc=null;this.scrollrange=new Object;this.scrollrange.enable=false;this.specType=new Array;this.specItem=new Array;this.mapserverCollect=new Array;this.currentMapserverIdx=0;if(n1.nodeName=="layer"){this.loadXML(n1);}else{this.scale=n1;this.operation=true;}}MapLayer.prototype.getNextMapserver=function(_3b){if(this.mapserverCollect.length==0){return "";}if(_3b==undefined){_3b=1;}var _3c=0;while(true){if(this.currentMapserverIdx>=this.mapserverCollect.length){this.currentMapserverIdx=0;}var _3d=this.mapserverCollect[this.currentMapserverIdx++];if(_3d.vendor==_3b){return _3d;}_3c+=1;if(_3c>=this.mapserverCollect.length){break;}}};MapLayer.prototype.toString=function(){var str="MapLayer:\n";str+="scale: "+this.scale+"\n";return str;};MapLayer.prototype.loadXML=function(n1){this.operation=true;if(n1.getAttribute("operation")=="no"){this.operation=false;}var nl2=n1.childNodes;for(var i=0;i<nl2.length;++i){var n2=nl2[i];if(n2.nodeType==1&&n2.nodeName=="projection"){var _43=new ProjInfo(n2);if(_43.vendor==1){this.addProjInfo(_43);_43.id=this.projInfo.length-1;}else{if(_43.vendor==2){this.projInfo_inc=_43;}}}else{if(n2.nodeType==1&&n2.nodeName=="scale"){this.scale=parseInt(AlpsUtil.getNodeContent(n2));}else{if(n2.nodeType==1&&n2.nodeName=="scrollrange"){this.scrollrange.enable=true;var nl3=n2.childNodes;for(var j=0;j<nl3.length;++j){var n3=nl3[j];if(n3.nodeType==1&&n3.nodeName=="bottomleft"){this.scrollrange.bottomleftLatLon=loadLatLonFromDOMNode(n3);}if(n3.nodeType==1&&n3.nodeName=="topright"){this.scrollrange.toprightLatLon=loadLatLonFromDOMNode(n3);}if(n3.nodeType==1&&n3.nodeName=="top"){this.scrollrange.top=(new Dms(AlpsUtil.getNodeContent(n3))).getDegree();}if(n3.nodeType==1&&n3.nodeName=="bottom"){this.scrollrange.bottom=(new Dms(AlpsUtil.getNodeContent(n3))).getDegree();}if(n3.nodeType==1&&n3.nodeName=="left"){this.scrollrange.left=(new Dms(AlpsUtil.getNodeContent(n3))).getDegree();}if(n3.nodeType==1&&n3.nodeName=="right"){this.scrollrange.right=(new Dms(AlpsUtil.getNodeContent(n3))).getDegree();}}}else{if(n2.nodeType==1&&n2.nodeName=="speclist"){this.loadSpecTypeList(n2);}else{if(n2.nodeType==1&&n2.nodeName=="specgroup"){this.loadSpecItemList(n2);}else{if(n2.nodeType==1&&n2.nodeName=="mapservername"){var _47=new Object();var _48=n2.getAttribute("type");if(_48=="pes"){_47.type=1;}else{if(_48=="presplit"){_47.type=2;}else{if(_48=="yahoo"){_47.type=3;}else{if(_48=="yahoosplit"){_47.type=4;}}}}var _49=n2.getAttribute("format");if(_49){_47.format=_49;}else{_47.format="png";}var _4a=n2.getAttribute("sourcetype");if(_4a&&_4a=="vector"){_47.sourceType=2;}else{_47.sourceType=1;}_47.url=AlpsUtil.getNodeContent(n2);var _4b=n2.getAttribute("vendor");if(_4b=="alps"){_47.vendor=1;}else{if(_4b=="inc"){_47.vendor=2;}else{_47.vendor=1;}}this.mapserverCollect.push(_47);}}}}}}}};MapLayer.prototype.addProjInfo=function(_4c){this.projInfo.push(_4c);};MapLayer.prototype.getNearestProjInfo=function(_4d){var _4e=this.projInfo[0];if(this.projInfo.length>=2){var _4f=Number.MAX_VALUE;for(var i=0;i<this.projInfo.length;++i){var org=this.projInfo[i].origin;var _52=(_4d.lat-org.lat)*(_4d.lat-org.lat)+(_4d.lon-org.lon)*(_4d.lon-org.lon);if(_52<_4f){_4f=_52;_4e=this.projInfo[i];}}}return _4e;};MapLayer.prototype.getProjInfoById=function(_53){var _54=this.projInfo[0];if(this.projInfo.length>=2){for(var i=0;i<this.projInfo.length;++i){if(this.projInfo[i].id==_53){_54=this.projInfo[i];break;}}}return _54;};MapLayer.prototype.getProjInfoByCode=function(_56){var _57=this.projInfo[0];if(this.projInfo.length>=2){for(var i=0;i<this.projInfo.length;++i){if(this.projInfo[i].org1stMeshCode==_56){_57=this.projInfo[i];break;}}}return _57;};MapLayer.prototype.getEnableProjInfo=function(_59,_5a){var _5b;for(var i=0;i<_59.length;++i){var _5d=_59[i];if(_5d.scale==this.scale){var _5e=this.getProjInfoByCode(_5d.code);_5b=_5e;if(_5e.id==_5a){break;}}}return _5b;};MapLayer.prototype.loadSpecTypeList=function(n2){var nl3=n2.childNodes;for(var j=0;j<nl3.length;++j){var n3=nl3[j];if(n3.nodeType==1&&n3.nodeName=="svespec"){var _63=new SpecType();_63.id=n3.getAttribute("id");_63.name=n3.getAttribute("name");this.specType.push(_63);}}};MapLayer.prototype.loadSpecItemList=function(n2){var nl3=n2.childNodes;for(var j=0;j<nl3.length;++j){var n3=nl3[j];if(n3.nodeType==1&&n3.nodeName=="svegroup"){var _68=new SpecItem();_68.id=n3.getAttribute("id");_68.name=n3.getAttribute("name");this.specItem.push(_68);}}};MapLayer.prototype.IsExistVendor=function(_69){if(_69=="alps"){return this.projInfo.length!=0;}else{if(_69=="inc"){return this.projInfo_inc!=null;}}return false;};MapLayer.prototype.release=function(){_objrelease(this);};function MapPackage(n0){this.layerCollect=new Array;this.mapserverCollect=new Array;this.currentMapserverIdx=0;if(n0.nodeName=="mappackage"){this.loadXML(n0);}else{this.id="map";var _6b=new Object();_6b.url=n0.baseURL;_6b.type=n0.type;_6b.sourceType=1;_6b.format="png";_6b.vendor=1;this.mapserverCollect.push(_6b);this.layerServerName="";this.setLayerInfo(n0);}}MapPackage.prototype.getNextMapserver=function(_6c){if(_6c==undefined){_6c=1;}while(true){if(this.currentMapserverIdx>=this.mapserverCollect.length){this.currentMapserverIdx=0;}var _6d=this.mapserverCollect[this.currentMapserverIdx++];if(_6d.vendor==_6c){return _6d;}}};MapPackage.prototype.toString=function(){var str="MapPackage: "+this.id+"\n";for(var i=0;i<this.layerCollect.length;++i){str+=this.layerCollect[i].toString();}return str;};MapPackage.prototype.loadXML=function(n0){this.id=n0.getAttribute("id");var nl1=n0.childNodes;for(var i=0;i<nl1.length;++i){var n1=nl1[i];if(n1.nodeType==1&&n1.nodeName=="layer"){var _74=new MapLayer(n1);this.layerCollect.push(_74);}else{if(n1.nodeType==1&&n1.nodeName=="mapservername"){var _75=new Object();var _76=n1.getAttribute("type");if(_76=="pes"){_75.type=1;}else{if(_76=="presplit"){_75.type=2;}else{if(_76=="yahoo"){_75.type=3;}else{if(_76=="yahoosplit"){_75.type=4;}}}}var _77=n1.getAttribute("format");if(_77){_75.format=_77;}else{_75.format="png";}var _78=n1.getAttribute("sourcetype");if(_78&&_78=="vector"){_75.sourceType=2;}else{_75.sourceType=1;}_75.url=AlpsUtil.getNodeContent(n1);var _79=n1.getAttribute("vendor");if(_79=="alps"){_75.vendor=1;}else{if(_79=="inc"){_75.vendor=2;}else{_75.vendor=1;}}this.mapserverCollect.push(_75);}else{if(n1.nodeType==1&&n1.nodeName=="layerservername"){this.layerServerName=AlpsUtil.getNodeContent(n1);this.layerServerType=n1.getAttribute("type");}}}}this.layerCollect.sort(function(a,b){return a.scale-b.scale;});};MapPackage.prototype.setLayerInfo=function(_7c){for(var i=0;i<_7c.count;++i){var _7e=new ProjInfo("",_7c.projCode[i],_7c.projOrgLt[i]/3600000,_7c.projOrgLn[i]/3600000,_7c.projInfo[i]);var _7f=new MapLayer(_7c.scale[i]);_7f.addProjInfo(_7e);this.layerCollect.push(_7f);}};MapPackage.prototype.getLayerScale=function(_80){var _81=this.layerCollect.length;if(_80<0){_80=0;}else{if(_80>=_81){_80=_81-1;}}return this.layerCollect[_80].scale;};MapPackage.prototype.getLayerId=function(_82,_83){var _84=this.layerCollect.length;if(_82<=0){return 0;}if(_82>=this.getLayerScale(_84-1)){return _84-1;}var _85=0;var _86=this.getLayerScale(_84-1);for(var i=0;i<_84;++i){var _88=this.getLayerScale(i)/_82;if(_83&&_83==1&&_88<1){continue;}if(_83&&_83==2&&_88>1){continue;}if(_88<1){_88=1/_88;}if(_88==1){_86=_88;_85=i;break;}if(_88<_86){_86=_88;_85=i;}}return _85;};MapPackage.prototype.release=function(){_objrelease(this);};function Tile(_89){this.tileCollect=_89;this.id=null;this.centerLatLon=null;this.enable=false;this.img=ImageMaker.createImg("","inherit",0,this.tileCollect.gazoSize.width,this.tileCollect.gazoSize.height);this.initialized=false;this.isImgLoaded=false;}Tile.prototype.onImgLoad=function(){if(!this.id){return;}this.isImgLoaded=true;AlpsEvent.triggerEvent(this.tileCollect.mapView.mapCtrl,"tileLoad",this);};Tile.prototype.setTileURL=function(){var _8a;var _8b=this.tileCollect.getCurrentPackage();var _8c=this.tileCollect.gazoSize;var _8d=this.tileCollect.layerId;var _8e=this.tileCollect.projId;var _8f=this.tileCollect.angle;var _90=_8b.layerCollect[_8d];var _91=_90.projInfo[_8e];var _92=_90.getNextMapserver(this.tileCollect.vendor);if(_92.length==0){_92=_8b.getNextMapserver(this.tileCollect.vendor);}if(_92.type==0){}else{if(_92.type==3){var _93=this.centerLatLon;var _94="no part=0&la=0";var _95="scale="+_8b.getLayerScale(_8d);var _96="width="+_8c.width;var _97="height="+_8c.height;var _98="nl="+_93.lat;var _99="el="+_93.lon;_8a=_92.url+"?"+_94+"&"+_95+"&"+_96+"&"+_97+"&"+_98+"&"+_99;}else{if(_92.type==1){var _93=this.centerLatLon;var _95="scale="+_8b.getLayerScale(_8d);var _9a="width="+_8c.width+"&height="+_8c.height;var _9b="c="+_93.lat+","+_93.lon;var _94="copyright=no&scalebar=no";_8a=_92.url+"/"+_92.format+"?"+_95+"&"+_9a+"&"+_9b+"&"+_94;if(_92.sourceType==2){_8a+="&";var _9c=this.tileCollect.mapView.mapCtrl.vectorOpe;if(!_9c.visibleVecHeimen){_8a+="heimen=no&";}if(!_9c.visibleVecTyuki){_8a+="tyuki=no&";}if(!_9c.visibleVecRaster){_8a+="raster=no&";}if(_9c.specHide.length){_8a+="spechide=";_8a+=_9c.specHide.join(",");_8a+="&";}_8a+="spectype=";if(_9c.vecSpecType!="normal"){_8a+=_9c.vecSpecType;}else{_8a+="normal";}if(_8f!=0){_8a+="&angle=";_8a+=_8f;}}}else{if(_92.type==2){var _9d=0;if(_90.projInfo.length>=2){_9d=_91.org1stMeshCode;}var _9e=this.id.x;var _9f=this.id.y;if(_91.maxTileX!=undefined){while(_9e>_91.maxTileX){_9e=_9e-_91.maxTileX-1;}}if(_91.minTileX!=undefined){while(_9e<_91.minTileX){_9e=_9e+_91.maxTileX+1;}}_8a=_92.url+"/"+_8b.getLayerScale(_8d)+"/"+_9d+"/"+Math.floor(_9e/100)+"_"+Math.floor(_9f/100)+"/"+_9e+"_"+_9f+"."+_92.format;if(_92.sourceType==2){_8a+="?";var _9c=this.tileCollect.mapView.mapCtrl.vectorOpe;if(!_9c.visibleVecHeimen){_8a+="heimen=no&";}if(!_9c.visibleVecTyuki){_8a+="tyuki=no&";}if(!_9c.visibleVecRaster){_8a+="raster=no&";}if(_9c.specHide.length){_8a+="spechide=";_8a+=_9c.specHide.join(",");_8a+="&";}_8a+="spectype=";if(_9c.vecSpecType!="normal"){_8a+=_9c.vecSpecType;}else{_8a+="normal";}if(_8f!=0){_8a+="&angle=";_8a+=_8f;}}}else{if(_92.type==4){var _a0=_90.projInfo_inc;var _9e=this.id.x;var _9f=this.id.y;if(_a0.maxTileX!=undefined){while(_9e>_a0.maxTileX){_9e=_9e-_a0.maxTileX-1;}}if(_a0.minTileX!=undefined){while(_9e<_a0.minTileX){_9e=_9e+_a0.maxTileX+1;}}var _a1=_a0.level;var _94="v=4.1";if(_8b.id=="aero"){_94="v=1.3&t=a&s=256";}_a1=19-_a1;_8a=_92.url+"?"+_94+"&x="+_9e+"&y="+_9f+"&z="+_a1+"&r=1";}}}}}if(this.img.src!=_8a){this.isImgLoaded=false;if(this.initialized){if(this.tileCollect.mapView.mapCtrl.vacantTilePath){this.img.src=this.tileCollect.mapView.mapCtrl.vacantTilePath;}else{this.img.src="vacantTile.gif";}}else{this.initialized=true;}this.img.src=_8a;}};function ProAtlasSheet(_a2,_a3,_a4){this.mapView=_a2;this.bUpper=_a4;this.packageId="map";this.layerId=null;this.projId=null;this.vendor=1;this.scale=0;this.magnify=1;this.angle=0;this.gazoSize=new Size(256,256);this.tileSize=new Size(this.gazoSize.width,this.gazoSize.height);this.div=document.createElement("div");this.div.style.position="absolute";this.div.style.top="0px";this.div.style.left="0px";_a3.appendChild(this.div);this.tileArray=new Array();this.tileXCount=0;this.tileYCount=0;this.tileCount=0;}ProAtlasSheet.prototype.getCurrentPackage=function(){return this.mapView.getMapPackage(this.packageId);};ProAtlasSheet.prototype.getTileById=function(id){for(var i=0;i<this.tileCount;++i){var _a7=this.tileArray[i];if((_a7.id!=null)&&(_a7.id.x==id.x)&&(_a7.id.y==id.y)){return _a7;}}return null;};ProAtlasSheet.prototype.getTileByIndex=function(_a8){return this.tileArray[_a8];};ProAtlasSheet.prototype.getFirstEditableTile=function(){for(var i=0;i<this.tileCount;++i){var _aa=this.tileArray[i];if(!_aa.enable){return _aa;}}return null;};ProAtlasSheet.prototype.resetAllTiles=function(){var _ab;if(this.mapView.mapCtrl.vacantTilePath){_ab=this.mapView.mapCtrl.vacantTilePath;}else{_ab="vacantTile.gif";}this.magnify=1;var _ac,_ad;_ac=Math.round(this.gazoSize.width*this.magnify);_ad=Math.round(this.gazoSize.height*this.magnify);for(var i=0;i<this.tileCount;++i){var _af=this.tileArray[i];_af.id=null;_af.centerLatLon=null;_af.enable=false;if(_af.initialized){_af.img.src=_ab;}_af.img.width=_ac;_af.img.height=_ad;_af.img.style.left=0+"px";_af.img.style.top=0+"px";AlpsEvent.triggerEvent(this.mapView.mapCtrl,"tileImgRemoved",_af);}this.magnify=0;};ProAtlasSheet.prototype.getVisible=function(){return (this.div.style.visibility=="visible")?true:false;};ProAtlasSheet.prototype.setVisible=function(_b0){this.div.style.visibility=(_b0?"visible":"hidden");};ProAtlasSheet.prototype.setOpacity=function(val){if(_bi.type==1){for(var i=0;i<this.tileCount;++i){this.tileArray[i].img.style.filter="alpha(opacity=0)";this.tileArray[i].img.filters.alpha.Opacity=(val*100);}}else{if(_bi.type==2){this.div.style.MozOpacity=val;}else{if(_bi.type==3||(_bi.type==4&&_bi.version>=9)){this.div.style.opacity=val;}else{if(val<0.5){this.setVisible(false);}else{this.setVisible(true);}}}}};ProAtlasSheet.prototype.ResetOpacity=function(){if(_bi.type==1){for(var i=0;i<this.tileCount;++i){this.tileArray[i].img.style.filter="";}}else{if(_bi.type==2){}else{if(_bi.type==3){}else{}}}};ProAtlasSheet.prototype.setZIndex=function(val){this.div.style.zIndex=val;};ProAtlasSheet.prototype.isImageAllLoaded=function(){if(_bi.type==3){return true;}else{var ret=true;for(var i=0;i<this.tileCount;++i){if(!this.tileArray[i].img.complete){ret=false;}}return ret;}};ProAtlasSheet.prototype.setTileCount=function(_b7,_b8,_b9){if(_b7==0||_b8==0){return;}var _ba=this.gazoSize;var _bb=this.tileSize;_bb.width=_ba.width*this.magnify;_bb.height=_ba.height*this.magnify;if(_b9){var _bc=Math.floor(_b7/_bb.width)+2;var _bd=Math.floor(_b8/_bb.height)+2;var _be=_bc*_bd;var _bf=_be-this.tileCount;if(_bf>0){for(var i=0;i<_bf;++i){var _c1=new Tile(this);this.div.appendChild(_c1.img);this.tileArray.push(_c1);}}else{if(_bf<0){for(var i=0;i<-_bf;++i){var _c1=this.tileArray.pop();this.div.removeChild(_c1.img);AlpsEvent.triggerEvent(this.mapView.mapCtrl,"tileImgRemoved",_c1);}}}this.tileXCount=_bc;this.tileYCount=_bd;this.tileCount=_be;}var _c2,_c3;_c2=Math.round(_bb.width);_c3=Math.round(_bb.height);for(var i=0;i<this.tileCount;++i){this.tileArray[i].img.width=_c2;this.tileArray[i].img.height=_c3;}};ProAtlasSheet.prototype.setCenterAndScale=function(_c4,_c5,_c6,_c7,_c8,_c9,_ca,_cb,_cc){var _cd=false;if(_cb!=undefined){this.vendor=_cb;}var _ce=false;if(this.packageId!=_c5&&this.mapView.ExistMapPackage(_c5)){_ce=true;var _cf=0;if(this.layerId!=null&&_c6==null){_cf=this.mapView.getMapPackage(this.packageId).getLayerScale(this.layerId);}this.packageId=_c5;if(_cf!=0){_c6=this.getCurrentPackage().getLayerId(_cf);}}if(_c6==null){_c6=0;}var _d0=this.getCurrentPackage();if(_c6<0||_c6>=_d0.layerCollect.length){_c6=this.layerId;}var _d1=_d0.layerCollect[_c6];var _d2;var _cf;if(this.vendor==1){if(_ca){if(this.mapView.mapCtrl.layerCodeList){_d2=_d1.getEnableProjInfo(this.mapView.mapCtrl.layerCodeList[_d0.id],this.projId);}if(!_d2){_d2=_d1.getNearestProjInfo(_c4);}this.projId=_d2.id;}else{_d2=_d1.getProjInfoById(this.projId);}if(_d2.code==2){_cf=_d2.scale/_c7;}else{_cf=_d1.scale/_c7;}}else{_d2=_d1.projInfo_inc;_cf=_d2.scale/_c7;}if(this.mapView.mapCtrl.getMapserverSrcType()!=2){_c8=0;}var _d3=false;var _d4=datumConvert(_c4,_cc,_d2.datum,_d3);this.mapView.setCenterAndScale(_d2,_d4,_cf,_c8);if(_ce||this.layerId!=_c6||this.angle!=_c8||_cd){this.resetAllTiles();}if(this.layerId!=_c6){this.layerId=_c6;}if(this.magnify!=_c7||_cd){this.magnify=_c7;this.setTileCount(this.mapView.conv.m_windowWidth,this.mapView.conv.m_windowHeight,_c9);}if(this.angle!=_c8){this.angle=_c8;}if(this.scale!=_cf){this.scale=_cf;}this.configureAllTiles(_c9);if(_bi.type==1){var _d5=this.mapView.mapContainer.offsetWidth;var _d6=this.mapView.mapContainer.offsetHeight;}if(_cd){AlpsEvent.triggerEvent(this.mapView.mapCtrl,"vendorChanged");}};ProAtlasSheet.prototype.setAllTilesFlag=function(_d7){for(var i=0;i<this.tileCount;++i){this.tileArray[i].isImgLoaded=_d7;}};ProAtlasSheet.prototype.configureAllTiles=function(_d9){if(this.mapView.conv.m_projCode==2&&this.vendor==2){this.configureAllTilesYUS(_d9);}else{this.configureAllTilesNormal(_d9);}};ProAtlasSheet.prototype.configureAllTilesNormal=function(_da){if(this.layerId==null){return;}var _db=this.mapView.conv.LL2Log(this.mapView.conv.getProjOrigin());var _dc=_db.x*-1;var _dd=_db.y*-1;var _de=_dc+this.mapView.conv.m_windowWidth;var _df=_dd+this.mapView.conv.m_windowHeight;var _e0=(_dc+_de)/2;var _e1=(_dd+_df)/2;var _e2=new Point(Math.floor(_e0/this.tileSize.width),Math.floor(_e1/this.tileSize.height));var _e3=new Point(Math.round(this.mapView.conv.m_windowWidth/2+(_e2.x*this.tileSize.width-_e0)),Math.round(this.mapView.conv.m_windowHeight/2+(_e2.y*this.tileSize.height-_e1)));var _e4,_e5,_e6,_e7;if(this.tileXCount%2!=0){var _e8=Math.floor(this.tileXCount/2);_e4=_e2.x-_e8;_e6=_e2.x+_e8;}else{var _e8=Math.floor(this.tileXCount/2);if(_e0/this.tileSize.width-_e2.x>0.5){_e4=_e2.x-(_e8-1);_e6=_e2.x+_e8;}else{_e4=_e2.x-_e8;_e6=_e2.x+(_e8-1);}}if(this.tileYCount%2!=0){var _e8=Math.floor(this.tileYCount/2);_e5=_e2.y-_e8;_e7=_e2.y+_e8;}else{var _e8=Math.floor(this.tileYCount/2);if(_e1/this.tileSize.height-_e2.y>0.5){_e5=_e2.y-(_e8-1);_e7=_e2.y+_e8;}else{_e5=_e2.y-_e8;_e7=_e2.y+(_e8-1);}}for(var i=0;i<this.tileCount;++i){this.getTileByIndex(i).enable=false;}var _ea=new Array();var _eb=new Point((_dc+_de)/2,(_dd+_df)/2);for(var j=_e5;j<=_e7;++j){for(var i=_e4;i<=_e6;++i){var id=new Point(i,j);var _ee=this.getTileById(id);if(_ee!=null){_ee.enable=true;var _ef=false;this.configureTile(_ee,_ef,_e2,_e3);}else{if(_da){var _f0=new Point((i+0.5)*this.tileSize.width,(j+0.5)*this.tileSize.height);var _f1=Point.sqdist(_eb,_f0);var _f2=null;var _f3=this.getCurrentPackage().getNextMapserver(this.vendor).type;if(_f3==1||_f3==3){_f2=this.mapView.conv.Log2LL(new Point(_f0.x-_dc,_f0.y-_dd));}var _f4=new TileRequest(id,_f1,_f2);_ea.push(_f4);}}}}_ea.sort(tileSort);for(var i=0;i<_ea.length;++i){var _f5=_ea[i];var _ee=this.getFirstEditableTile();if(_ee!=null){AlpsEvent.triggerEvent(this.mapView.mapCtrl,"tileImgRemoved",_ee);_ee.enable=true;_ee.id=_f5.id;_ee.centerLatLon=_f5.centerLatLon;var _ef=true;this.configureTile(_ee,_ef,_e2,_e3);}}};ProAtlasSheet.prototype.configureAllTilesYUS=function(_f6){if(this.layerId==null){return;}var _f7=this.mapView.conv.LL2Log(this.mapView.conv.getProjOrigin());var _f8=_f7.x*-1;var _f9=_f7.y*-1;_f9*=-1;var _fa=_f8+this.mapView.conv.m_windowWidth;var _fb=_f9-this.mapView.conv.m_windowHeight;var _fc=(_f8+_fa)/2;var _fd=(_fb+_f9)/2;var _fe=new Point(Math.floor(_fc/this.tileSize.width),Math.floor(_fd/this.tileSize.height));var _ff=new Point(Math.round(this.mapView.conv.m_windowWidth/2+(_fe.x*this.tileSize.width-_fc)),Math.round(-this.mapView.conv.m_windowHeight/2+(_fe.y*this.tileSize.height-_fd)));var _100,_101,_102,_103;if(this.tileXCount%2!=0){var temp=Math.floor(this.tileXCount/2);_100=_fe.x-temp;_102=_fe.x+temp;}else{var temp=Math.floor(this.tileXCount/2);if(_fc/this.tileSize.width-_fe.x>0.5){_100=_fe.x-(temp-1);_102=_fe.x+temp;}else{_100=_fe.x-temp;_102=_fe.x+(temp-1);}}if(this.tileYCount%2!=0){var temp=Math.floor(this.tileYCount/2);_101=_fe.y-temp;_103=_fe.y+temp;}else{var temp=Math.floor(this.tileYCount/2);if(_fd/this.tileSize.height-_fe.y>0.5){_101=_fe.y-(temp-1);_103=_fe.y+temp;}else{_101=_fe.y-temp;_103=_fe.y+(temp-1);}}for(var i=0;i<this.tileCount;++i){this.getTileByIndex(i).enable=false;}var _106=new Array();var _107=new Point((_f8+_fa)/2,(_fb+_f9)/2);for(var j=_101;j<=_103;++j){for(var i=_100;i<=_102;++i){var id=new Point(i,j);var tile=this.getTileById(id);if(tile!=null){tile.enable=true;var _10b=false;this.configureTileYUS(tile,_10b,_fe,_ff);}else{if(_f6){var _10c=new Point((i+0.5)*this.tileSize.width,(j+0.5)*this.tileSize.height);var _10d=Point.sqdist(_107,_10c);var _10e=null;var _10f=this.getCurrentPackage().getNextMapserver(this.vendor).type;if(_10f==1||_10f==3){_10e=this.mapView.conv.Log2LL(new Point(_10c.x-_f8,_10c.y-_fb));}var _110=new TileRequest(id,_10d,_10e);_106.push(_110);}}}}_106.sort(tileSort);for(var i=0;i<_106.length;++i){var _111=_106[i];var tile=this.getFirstEditableTile();if(tile!=null){AlpsEvent.triggerEvent(this.mapView.mapCtrl,"tileImgRemoved",tile);tile.enable=true;tile.id=_111.id;tile.centerLatLon=_111.centerLatLon;var _10b=true;this.configureTileYUS(tile,_10b,_fe,_ff);}}};function tileSort(a,b){return a.sqdist-b.sqdist;}ProAtlasSheet.prototype.configureTile=function(tile,_115,_116,_117){var _118=(tile.id.x-_116.x)*Math.round(this.tileSize.width);var _119=(tile.id.y-_116.y)*Math.round(this.tileSize.height);var _11a=_117.x+_118;var _11b=_117.y+_119;tile.img.style.left=_11a+"px";tile.img.style.top=_11b+"px";if(_115==true){tile.setTileURL();}};ProAtlasSheet.prototype.configureTileYUS=function(tile,_11d,_11e,_11f){var _120=(tile.id.x-_11e.x)*Math.round(this.tileSize.width);var _121=(tile.id.y-_11e.y)*Math.round(this.tileSize.height);var _122=_11f.x+_120;var _123=_11f.y+_121+this.tileSize.height;tile.img.style.left=_122+"px";tile.img.style.top=-_123+"px";if(_11d==true){tile.setTileURL();}};ProAtlasSheet.prototype.release=function(){_objrelease(this);};function TileRequest(id,_125,_126){this.id=id;this.sqdist=_125;this.centerLatLon=_126;}function ProAtlasMapView(_127,_128){this.mapContainer=_127;this.mapCtrl=_128;this.packageCollect=new Array;this.conv=new CoordinatesConversion();this.draggableCursor="";this.draggingCursor="";this.fadeinTimerId=0;this.fadeinElapseTime=30;this.mapContainer.style.overflow="hidden";if(this.mapContainer.style.position!="absolute"){this.mapContainer.style.position="relative";}this.viewContainer=document.createElement("div");this.viewContainer.style.position="absolute";this.viewContainer.style.top="0px";this.viewContainer.style.left="0px";this.mapContainer.appendChild(this.viewContainer);this.backSheet=new ProAtlasSheet(this,this.viewContainer,false);this.frontSheet=new ProAtlasSheet(this,this.viewContainer,true);this.frontSheet.setVisible(true);this.backSheet.setVisible(false);this.setVisibleCopyright(true);}ProAtlasMapView.prototype.grabCursor=function(){if(_bi.type==2&&_bi.os!=null){this.mapContainer.style["cursor"]="-moz-grab";}else{if(this.draggableCursor.length){this.mapContainer.style["cursor"]="url("+this.draggableCursor+"), default";}}};ProAtlasMapView.prototype.grabbingCursor=function(){if(_bi.type==2&&_bi.os!=null){this.mapContainer.style["cursor"]="-moz-grabbing";}else{if(this.draggingCursor.length){this.mapContainer.style["cursor"]="url("+this.draggingCursor+"), move";}}};ProAtlasMapView.prototype.toString=function(){var str="ProAtlasMapView\n";for(var i=0;i<this.packageCollect.length;++i){var _12b=this.packageCollect[i];var aaa=this.getMapPackage(_12b);str+=aaa.toString();}return str;};var _mAlpsCopy="";ProAtlasMapView.prototype.setVisibleCopyright=function(_12d){if(!this.copyright){this.copyright=this.createCopyright(_mAlpsCopy);this.copyright.style.right="3px";this.copyright.style.bottom="3px";this.mapContainer.appendChild(this.copyright);}this.copyright.style.visibility=_12d?"visible":"hidden";};ProAtlasMapView.prototype.createCopyright=function(_12e){var obj=document.createElement("div");obj.style.position="absolute";obj.style.fontSize="12px";obj.style.fontFamily="Arial, Helvetica, sans-serif";obj.style.fontWeight="bold";if(_bi.type==1){obj.unselectable="on";obj.onselectstart=Nothing;}else{obj.style.MozUserSelect="none";}obj.oncontextmenu=Nothing;obj.innerHTML=_12e;return obj;};ProAtlasMapView.prototype.getVisibleCopyright=function(){if(!this.copyright){return false;}return this.copyright.style.visibility=="visible";};ProAtlasMapView.prototype.createCenterMark=function(path,size){this.centerImg=ImageMaker.createImg(path,"visible",0,size,size);this.mapContainer.appendChild(this.centerImg);this.centerImg.style.left=(this.mapContainer.offsetWidth-this.centerImg.width)/2+"px";this.centerImg.style.top=(this.mapContainer.offsetHeight-this.centerImg.height)/2+"px";};ProAtlasMapView.prototype.createCenterMark2=function(){var _132="http://i.yimg.jp/images/map/api/ui_forprint.gif";this.centerImg=document.createElement("div");this.centerImg.style.overflow="hidden";this.centerImg.style.width="33px";this.centerImg.style.height="33px";this.centerImg.style.position="absolute";var img=document.createElement("img");img.style.border="0px none";img.style.margin="0px";img.style.padding="0px";img.style.position="absolute";img.style.left="0px";img.style.top="0px";img.style.width="66px";img.style.height="48px";img.src=_132;if(_bi.type==1){img.unselectable="on";img.onselectstart=Nothing;img.galleryImg="no";}else{img.style.MozUserSelect="none";}img.oncontextmenu=Nothing;this.centerImg.appendChild(img);this.mapContainer.appendChild(this.centerImg);this.centerImg.style.left=(this.mapContainer.offsetWidth-this.centerImg.offsetWidth)/2+"px";this.centerImg.style.top=(this.mapContainer.offsetHeight-this.centerImg.offsetHeight)/2+"px";};ProAtlasMapView.prototype.getVisibleCenterMark=function(){if(!this.centerImg){return false;}return this.centerImg.style.visibility=="visible";};ProAtlasMapView.prototype.setVisibleCenterMark=function(_134){if(!this.centerImg){return;}this.centerImg.style.visibility=_134?"visible":"hidden";};ProAtlasMapView.prototype.addMapPackage=function(_135){this.packageCollect.push(_135.id);this.packageCollect[_135.id]=_135;};ProAtlasMapView.prototype.getMapPackage=function(_136){return this.packageCollect[_136];};ProAtlasMapView.prototype.ExistMapPackage=function(_137){for(var i=0;i<this.packageCollect.length;++i){if(this.packageCollect[i]==_137){return true;}}return false;};ProAtlasMapView.prototype.resizeMapView=function(){this.conv.setWindowSize(this.mapContainer.offsetWidth,this.mapContainer.offsetHeight);var _139=this.mapCtrl.zoomTimerId?false:true;this.frontSheet.setTileCount(this.mapContainer.offsetWidth,this.mapContainer.offsetHeight,_139);var _139=true;this.frontSheet.configureAllTiles(_139);if(this.centerImg){this.centerImg.style.left=(this.mapContainer.offsetWidth-this.centerImg.offsetWidth)/2+"px";this.centerImg.style.top=(this.mapContainer.offsetHeight-this.centerImg.offsetHeight)/2+"px";}};ProAtlasMapView.prototype.flipSheet=function(){var _13a=this.frontSheet;this.frontSheet=this.backSheet;this.backSheet=_13a;if(!this.frontSheet.bUpper){this.viewContainer.removeChild(this.frontSheet.div);this.viewContainer.appendChild(this.frontSheet.div);this.frontSheet.bUpper=true;this.backSheet.bUpper=false;}this.frontSheet.setVisible(true);if(_bi.type==4){this.backSheet.setVisible(false);this.backSheet.resetAllTiles();}};ProAtlasMapView.prototype.fadeinFlipSheet=function(type){var _13c=this.frontSheet;this.frontSheet=this.backSheet;this.backSheet=_13c;if(!this.frontSheet.bUpper){this.viewContainer.removeChild(this.frontSheet.div);this.viewContainer.appendChild(this.frontSheet.div);this.frontSheet.bUpper=true;this.backSheet.bUpper=false;}this.frontSheet.setOpacity(0);this.frontSheet.setVisible(true);var func="this.timerFadein(1,'"+type+"')";this.fadeinTimerId=_setTimeout(this,this.timerFadein,10,1,type);};ProAtlasMapView.prototype.timerFadein=function(val,type){if(val>10){this.frontSheet.setOpacity(1);this.frontSheet.ResetOpacity();this.backSheet.ResetOpacity();if(_bi.type==4){this.backSheet.setVisible(false);this.backSheet.resetAllTiles();}this.fadeinTimerId=0;if(type=="package"){AlpsEvent.triggerEvent(this.mapCtrl,"packageChanged");if(this.frontSheet.angle!=this.backSheet.angle){AlpsEvent.triggerEvent(this.mapCtrl,"angleChanged");}if(this.frontSheet.scale!=this.backSheet.scale){AlpsEvent.triggerEvent(this.mapCtrl,"layerChanged");}}else{if(type=="angle"){AlpsEvent.triggerEvent(this.mapCtrl,"angleChanged");}else{if(type=="layer"){AlpsEvent.triggerEvent(this.mapCtrl,"layerChanged");}else{if(type=="mapmove"){AlpsEvent.triggerEvent(this.mapCtrl,"premapMoved");}else{if(type=="vendor"){AlpsEvent.triggerEvent(this.mapCtrl,"vendorChanged");}}}}}}else{this.frontSheet.setOpacity(val/10);var _140=val+3.5;var func="this.timerFadein("+_140+",'"+type+"')";this.fadeinTimerId=_setTimeout(this,this.timerFadein,this.fadeinElapseTime,_140,type);}};ProAtlasMapView.prototype.isFadeinFlipping=function(){return this.fadeinTimerId!=0;};ProAtlasMapView.prototype.stopFadeinFlipping=function(){if(this.fadeinTimerId){clearTimeout(this.fadeinTimerId);this.fadeinTimerId=0;this.frontSheet.setOpacity(1);this.frontSheet.ResetOpacity();this.backSheet.ResetOpacity();if(_bi.type==4){this.backSheet.setVisible(false);this.backSheet.resetAllTiles();}}};ProAtlasMapView.prototype.setCenterAndScale=function(_142,_143,_144,_145){var org;var info;if(_142.code!=2){org=new LLPoint(_142.origin.lat,_142.origin.lon);info=_142.subInfo;}else{info=_142.level;}this.conv.setProjConv(_142.code,org,info);this.conv.setScale(_144);this.conv.setAngle(_145);this.conv.setCenter(_143);};ProAtlasMapView.prototype.getNextPackageId=function(id){for(var i=0;i<this.packageCollect.length;++i){var _14a=this.packageCollect[i];if(_14a==id){i+=1;if(i==this.packageCollect.length){i=0;}break;}}return this.packageCollect[i];};ProAtlasMapView.prototype.release=function(){_objrelease(this.packageCollect,true);_objrelease(this);};_layerScaleList=new Object;_layerScaleList.v1=[5000,10000,25000,70000,250000,500000,1000000,3000000,6103510,48828076,390624609];_layerScaleList.v2=[2500,5000,10000,20000,25000,40000,70000,130000,250000,500000,1000000,1600000,3051755,6103510,12207019,24414038,48828076,97656152,195312305,390624609,781249219,1562498438];var _maxMagnify=5;var _minMagnify=0.5;var _buttonLeft=0;var _buttonRight=1;var _buttonMiddle=2;var _keyLayerScale=250000;function ProAtlasMapCtrl(_14b,_14c,_14d,_14e){this.version="v1";this.mouseX=0;this.mouseY=0;this.mouseDownX=0;this.mouseDownY=0;this.scrollType=0;this.autoScrollTimerId=0;this.enableDragScroll=true;this.enableDbClickCentering=true;this.enableSingleClickCentering=false;this.isMouseMoved=false;this.isMouseDragged=false;this.isMouseDown=false;this.mouseDownTime=null;this.zoomTimerId=0;this.zoomElapseTime=33;this.targetMagnify=0;this.stepMagnify=0;this.isSmoothZoomEnd=false;this.enableWheelOperation=true;this.enableZoomendFadeinEfct=false;this.enableReverseWheelOperation=false;this.cntrngTimerId=0;this.cntrngElapseTime=10;this.cntrngTotalTime=300;this.cntrngCrrntStep=0;this.targetSize=new Size(0,0);this.currentPos=new Point(0,0);this.flightScrollTimerId=0;this.flightScrollElapseTime=30;this.coefficientOfAirResistance=10;this.objectMass=2;this.accelerationOfJetEngine=5000;this.velocityX=0;this.velocityY=0;this.arrowKeys=new KeyCodesArray();this.enableKeyboardOperation=true;this.enableMagnifyOperation=true;this.enableLayerOperation=true;this.enableSmoothLayerOperation=true;this.enableAngleOperation=false;this.enableSmoothScroll=true;this.enablePackageOperation=false;this.mouseIsOnTheMap=false;this.vectorOpe=new Object;this.vectorOpe.visibleVecHeimen=true;this.vectorOpe.visibleVecTyuki=true;this.vectorOpe.visibleVecRaster=true;this.vectorOpe.vecSpecType="normal";this.vectorOpe.specHide=new Array;this.enableAutoLayerChange=false;this.datum="tokyo97";this.getDatumTimerId=0;this.yahooMapLayer=null;this.yahooMapLayerType="";this.yahooCopyright="";this.mapWidth=_14b.offsetWidth;this.mapHeight=_14b.offsetHeight;var _14f=_14b.style.display;_14b.style.display="block";this.mapView=new ProAtlasMapView(_14b,this);AlpsEvent.bindBuiltInEvent(window,"resize",this,this.onResize);this.eventSrc=_14b.setCapture?_14b:window;AlpsEvent.bindBuiltInEvent(_14b,"mousedown",this,this.onMouseDown);AlpsEvent.bindBuiltInEvent(this.eventSrc,"mousemove",this,this.onMouseMove);AlpsEvent.bindBuiltInEvent(this.eventSrc,"mouseup",this,this.onMouseUp);if(_bi.type==2){AlpsEvent.bindBuiltInEvent(window,"mouseout",this,this.onWindowMouseOut);}AlpsEvent.bindBuiltInEvent(_14b,"mouseover",this,this.onMouseOver);AlpsEvent.bindBuiltInEvent(_14b,"mouseout",this,this.onMouseOut);AlpsEvent.bindEvent(this,"premapMoved",this,this.premapMoved);AlpsEvent.bindEvent(this,"mapMoving",this,this.mapMoving);AlpsEvent.bindEvent(this,"layerChanged",this,this.layerChanged);AlpsEvent.bindEvent(this,"packageChanged",this,this.packageChanged);AlpsEvent.bindEvent(this,"vendorChanged",this,this.vendorChanged);this.premapMovedTimerId=0;AlpsEvent.bindEvent(this,"layerListChanged",this,this.layerListChanged);if(_bi.type==3){AlpsEvent.bindBuiltInEvent(window.document,"keypress",this,this.onKeyDown);}else{AlpsEvent.bindBuiltInEvent(window.document,"keydown",this,this.onKeyDown);}AlpsEvent.bindBuiltInEvent(window.document,"keyup",this,this.onKeyUp);this.mouseWheelHandler=AlpsEvent.makeBinder(this,this.onMouseWheel);this.addWheelEvent();AlpsEvent.bindBuiltInEvent(_14b,"click",this,this.onClick);AlpsEvent.bindBuiltInEvent(_14b,"dblclick",this,this.onDblClick);AlpsEvent.bindBuiltInEvent(_14b,"contextmenu",this,this.onContextMenu);this.loadMap(_14c,_14d);this.layerScaleList=new Object;this.layerCodeList=new Object;for(var i=0;i<this.mapView.packageCollect.length;++i){var _151=this.mapView.packageCollect[i];this.layerScaleList[_151]=new Array;var _152=this.mapView.getMapPackage(_151).layerCollect;for(var j=0;j<_152.length;++j){this.layerScaleList[_151].push(_152[j].scale);}this.layerCodeList[_151]=new Array;}if(_14e){if(_14e.version){this.version=_14e.version;}if(_14e.datum){this.datum=_14e.datum;}this.packageTo(_14e.packageId);var _154;if(_14e.layerId>=0){_154=_14e.layerId;}else{if(_14e.scale){_154=this.getLayerId(_14e.scale,0,true);}}this.moveAndLayerTo(_14e.pos,_154,false);}else{this.defaultTo();}this.onResizeEnd();_14b.style.display=_14f;}ProAtlasMapCtrl.prototype.addWheelEvent=function(){if(_bi.type==2){AlpsEvent.addBuiltInEvent(window.document,"DOMMouseScroll",this.mouseWheelHandler);}else{if(_bi.type==4){AlpsEvent.addBuiltInEvent(this.mapView.mapContainer,"mousewheel",this.mouseWheelHandler);}else{AlpsEvent.addBuiltInEvent(window.document,"mousewheel",this.mouseWheelHandler);}}};ProAtlasMapCtrl.prototype.removeWheelEvent=function(){if(_bi.type==2){AlpsEvent.removeBuiltInEvent(window.document,"DOMMouseScroll",this.mouseWheelHandler);}else{if(_bi.type==4){AlpsEvent.removeBuiltInEvent(this.mapView.mapContainer,"mousewheel",this.mouseWheelHandler);}else{AlpsEvent.removeBuiltInEvent(window.document,"mousewheel",this.mouseWheelHandler);}}};ProAtlasMapCtrl.prototype.toString=function(){var str="ProAtlasMapCtrl\n";str+=this.mapView.toString();return str;};ProAtlasMapCtrl.prototype.loadMap=function(_156,_157){if(typeof (_156)=="object"){var _158=new MapPackage(_156);this.mapView.addMapPackage(_158);}else{if(typeof (_156)=="string"){this.loadXML(_156,_157);}}};ProAtlasMapCtrl.prototype.loadXML=function(_159,_15a){var doc=null;if(_15a!=null&&_15a=="string"){doc=AlpsUtil.getXMLDOMFromStr(_159);}else{doc=AlpsUtil.getXMLDOM(_159);}if(!doc){return;}var n=doc.getElementsByTagName("proatlasmap")[0];if(!n){return;}var nl0=n.childNodes;for(var i=0;i<nl0.length;++i){var n0=nl0[i];if(n0.nodeType==1&&n0.nodeName=="mappackage"){var _160=new MapPackage(n0);this.mapView.addMapPackage(_160);}else{if(n0.nodeType==1&&n0.nodeName=="defaultposition"){this.loadDefaultPosition(n0);}else{if(n0.nodeType==1&&n0.nodeName=="centermark"){this.loadCenterMark(n0);}else{if(n0.nodeType==1&&n0.nodeName=="autoscrollanchor"){this.loadAnchor(n0);}else{if(n0.nodeType==1&&n0.nodeName=="vacanttile"){this.loadVacantTile(n0);}else{if(n0.nodeType==1&&n0.nodeName=="yahoolayerservername"){this.yahooMapLayer=AlpsUtil.getNodeContent(n0);this.yahooMapLayerType=n0.getAttribute("type");}else{if(n0.nodeType==1&&n0.nodeName=="datumconvservername"&&typeof (_dc)!="undefined"){_dc.server=AlpsUtil.getNodeContent(n0);}else{if(n0.nodeType==1&&n0.nodeName=="draggable_cursor"){this.mapView.draggableCursor=n0.getAttribute("src");this.mapView.grabCursor();}else{if(n0.nodeType==1&&n0.nodeName=="dragging_cursor"){this.mapView.draggingCursor=n0.getAttribute("src");}}}}}}}}}}if(!this.mapView.centerImg){this.mapView.createCenterMark2();}if(!this.anchorImg){this.loadAnchor2();}};ProAtlasMapCtrl.prototype.loadCenterMark=function(n0){var path=n0.getAttribute("src");var size=n0.getAttribute("size");this.mapView.createCenterMark(path,size);};ProAtlasMapCtrl.prototype.loadAnchor=function(n0){var path=n0.getAttribute("src");var size=n0.getAttribute("size");this.anchorImg=ImageMaker.createImg(path,"hidden",0,size,size);this.mapView.mapContainer.appendChild(this.anchorImg);};ProAtlasMapCtrl.prototype.loadAnchor2=function(){var _167="http://i.yimg.jp/images/map/api/ui_forprint.gif";this.anchorImg=document.createElement("div");this.anchorImg.style.overflow="hidden";this.anchorImg.style.width="33px";this.anchorImg.style.height="33px";this.anchorImg.style.visibility="hidden";this.anchorImg.style.position="absolute";var img=document.createElement("img");img.style.border="0px none";img.style.margin="0px";img.style.padding="0px";img.style.position="absolute";img.style.left="-34px";img.style.top="0px";img.style.width="66px";img.style.height="48px";img.src=_167;if(_bi.type==1){img.unselectable="on";img.onselectstart=Nothing;img.galleryImg="no";}else{img.style.MozUserSelect="none";}img.oncontextmenu=Nothing;this.anchorImg.appendChild(img);this.mapView.mapContainer.appendChild(this.anchorImg);};ProAtlasMapCtrl.prototype.loadVacantTile=function(n0){this.vacantTilePath=n0.getAttribute("src");var _16a=ImageMaker.createImg(this.vacantTilePath,"hidden",0);this.mapView.mapContainer.appendChild(_16a);};ProAtlasMapCtrl.prototype.loadDefaultPosition=function(n0){var nl1=n0.childNodes;for(var i=0;i<nl1.length;++i){var n1=nl1[i];if(n1.nodeType==1&&n1.nodeName=="mappackage"){this.defPackageId=AlpsUtil.getNodeContent(n1);}else{if(n1.nodeType==1&&n1.nodeName=="position"){this.defPos=loadLatLonFromDOMNode(n1);}else{if(n1.nodeType==1&&n1.nodeName=="scale"){this.defScale=parseInt(AlpsUtil.getNodeContent(n1));}}}}};ProAtlasMapCtrl.prototype.onResize=function(){if(_bi.type==1||_bi.type==4||_bi.type==3){this.resizeEnd=(this.resizeEnd==null)?(new Object()):this.resizeEnd;clearTimeout(this.resizeEnd);this.resizeEnd=_setTimeout(this,this.onResizeEnd,100);}else{this.onResizeEnd();}};ProAtlasMapCtrl.prototype.onResizeEnd=function(){this.mapView.resizeMapView();var _16f=this.getContainer();this.mapWidth=_16f.offsetWidth;this.mapHeight=_16f.offsetHeight;AlpsEvent.triggerEvent(this,"resize");};ProAtlasMapCtrl.prototype.getWindowSize=function(){var sz=new Size(0,0);if(window.self&&self.innerWidth){sz.width=self.innerWidth;sz.height=self.innerHeight;return sz;}if(document.documentElement&&document.documentElement.clientHeight){sz.width=document.documentElement.clientWidth;sz.height=document.documentElement.clientHeight;return sz;}sz.width=document.body.clientWidth;sz.height=document.body.clientHeight;return sz;};ProAtlasMapCtrl.prototype.onMouseDown=function(e){if(e.button!=0&&e.button!=1){CancelBubble(e);return false;}this.mapView.grabbingCursor();var _172=this.log2LatLon(getRelativePos(e,this.mapView.mapContainer));AlpsEvent.triggerEvent(this,"mouseDown",_172);this.isMouseDown=true;this.isMouseMoved=false;this.isMouseDragged=false;this.mouseX=e.screenX;this.mouseY=e.screenY;this.mouseDownX=e.screenX;this.mouseDownY=e.screenY;if(this.mapView.mapContainer.setCapture){this.mapView.mapContainer.setCapture();}CancelBubble(e);if(this.arrowKeys.contains(16)){if(this.anchorImg){var pos=getRelativePos(e,this.mapView.mapContainer);this.anchorImg.style.left=pos.x-this.anchorImg.offsetWidth/2+"px";this.anchorImg.style.top=pos.y-this.anchorImg.offsetHeight/2+"px";this.anchorImg.style.visibility="visible";}this.scrollType=1;this.autoScrollCount=0;this.autoScroll();}else{this.scrollType=0;}this.mouseDownTime=(new Date()).getTime();return false;};ProAtlasMapCtrl.prototype.onMouseMove=function(e){var _175=this.mapView.mapContainer;var log=getRelativePos(e,_175);if(log.x>0&&log.y>0&&log.x<this.mapWidth&&log.y<this.mapHeight){var _177=this.log2LatLon(log);AlpsEvent.triggerEvent(this,"mouseMove",_177);}this.isMouseMoved=true;if(!this.isMouseDown){return false;}var _178=e.screenX-this.mouseX;var _179=e.screenY-this.mouseY;if(Math.abs(_178)>0||Math.abs(_179)>0){this.isMouseDragged=true;if(this.scrollType==0&&this.enableDragScroll){this.dragScroll(_178,_179);}this.mouseX=e.screenX;this.mouseY=e.screenY;}return false;};ProAtlasMapCtrl.prototype.onMouseUp=function(e){if(this.mapView.mapContainer.releaseCapture){this.mapView.mapContainer.releaseCapture();}this.mapView.grabCursor();var _17b=this.mapView.mapContainer;var log=getRelativePos(e,_17b);if(log.x>0&&log.y>0&&log.x<this.mapWidth&&log.y<this.mapHeight){var _17d=this.log2LatLon(log);AlpsEvent.triggerEvent(this,"mouseUp",_17d);}if(_bi.type==4&&e.button==2){var _17d=this.log2LatLon(log);AlpsEvent.triggerEvent(this,"click",this.toOutside(_17d,true),_buttonRight);}if(this.scrollType==1){if(this.anchorImg){this.anchorImg.style.visibility="hidden";}clearTimeout(this.autoScrollTimerId);this.autoScrollTimerId=0;AlpsEvent.triggerEvent(this,"premapMoved",true);this.isMouseDown=false;return false;}var _17e=(new Date()).getTime();if(_17e-this.mouseDownTime<=500&&!this.isMouseMoved){}else{if(this.isMouseDown&&this.isMouseMoved&&this.enableDragScroll){AlpsEvent.triggerEvent(this,"premapMoved",true);}}this.isMouseDown=false;return false;};ProAtlasMapCtrl.prototype.autoScroll=function(){var _17f=this.mouseX-this.mouseDownX;var _180=this.mouseY-this.mouseDownY;var _181=new Point(this.mapView.conv.m_windowWidth/2+_17f/10,this.mapView.conv.m_windowHeight/2+_180/10);var _182=this.mapView.conv.Log2LL(_181);this.moveTo(_182,null,true,false,true);if(this.autoScrollCount>=30){this.autoScrollCount=0;AlpsEvent.triggerEvent(this,"premapMoved",true);}else{this.autoScrollCount+=1;}this.autoScrollTimerId=_setTimeout(this,this.autoScroll,10);};ProAtlasMapCtrl.prototype.dragScroll=function(_183,_184){var _185=new Point(this.mapView.conv.m_windowWidth/2-_183,this.mapView.conv.m_windowHeight/2-_184);var _186=this.mapView.conv.Log2LL(_185);this.moveTo(_186,null,true,false,true);};ProAtlasMapCtrl.prototype.onWindowMouseOut=function(e){if(!e.relatedTarget&&this.isMouseDown){this.onMouseUp(e);}};ProAtlasMapCtrl.prototype.onMouseOver=function(e){var _189=this.mapView.mapContainer;var log=getRelativePos(e,_189);if(log.x>=0&&log.y>=0&&log.x<=this.mapWidth&&log.y<=this.mapHeight){if(!this.mouseIsOnTheMap){this.mouseIsOnTheMap=true;var _18b=this.log2LatLon(log);AlpsEvent.triggerEvent(this,"mouseOver",_18b);}}};ProAtlasMapCtrl.prototype.onMouseOut=function(e){var _18d=this.mapView.mapContainer;var log=getRelativePos(e,_18d);if(log.x<=0||log.y<=0||log.x>=this.mapWidth||log.y>=this.mapHeight){if(this.mouseIsOnTheMap){this.mouseIsOnTheMap=false;var _18f=this.log2LatLon(log);AlpsEvent.triggerEvent(this,"mouseOut",_18f);}}};ProAtlasMapCtrl.prototype.onKeyDown=function(e){if(!this.enableKeyboardOperation){return true;}e=(e?e:window.event);switch(e.keyCode){case 33:if(this.enableLayerOperation){var _191=this.mapView.frontSheet.layerId+1;if(this.IsEnableLayer(this.mapView.frontSheet.packageId,_191)){this.layerTo(_191,null,true);}CancelBubble(e);return false;}else{return true;}case 34:if(this.enableLayerOperation){var _191=this.mapView.frontSheet.layerId-1;if(this.IsEnableLayer(this.mapView.frontSheet.packageId,_191)){this.layerTo(_191,null,true);}CancelBubble(e);return false;}else{return true;}case 36:if(this.enableMagnifyOperation){var _192=1;if(this.arrowKeys.contains(16)){if(this.mapView.frontSheet.magnify>1){_192=1;}else{_192=_minMagnify;}}else{_192=this.mapView.frontSheet.magnify/1.2;}this.magnifyTo(_192,true);CancelBubble(e);return false;}else{return true;}case 35:if(this.enableMagnifyOperation){var _192=1;if(this.arrowKeys.contains(16)){if(this.mapView.frontSheet.magnify<1){_192=1;}else{_192=_maxMagnify;}}else{_192=this.mapView.frontSheet.magnify*1.2;}this.magnifyTo(_192,true);CancelBubble(e);return false;}else{return true;}case 45:if(this.enableSmoothLayerOperation){var _191=this.mapView.frontSheet.layerId+1;if(this.IsEnableLayer(this.mapView.frontSheet.packageId,_191)){this.smoothLayerTo(_191,true);}CancelBubble(e);return false;}else{return true;}case 46:if(this.enableSmoothLayerOperation){var _191=this.mapView.frontSheet.layerId-1;if(this.IsEnableLayer(this.mapView.frontSheet.packageId,_191)){this.smoothLayerTo(_191,true);}CancelBubble(e);return false;}else{return true;}case 82:if(this.enableAngleOperation){var _193=this.getCurrentAngle()+5;if(this.arrowKeys.contains(16)){this.smoothAngleTo(_193);}else{this.angleTo(_193,true);}CancelBubble(e);return false;}else{return true;}case 76:if(this.enableAngleOperation){var _193=this.getCurrentAngle()-5;if(this.arrowKeys.contains(16)){this.smoothAngleTo(_193);}else{this.angleTo(_193,true);}CancelBubble(e);return false;}else{return true;}case 32:if(this.enablePackageOperation){var _194=this.mapView.getNextPackageId(this.getCurrentPackageId());this.smoothPackageTo(_194);CancelBubble(e);return false;}else{return true;}case 37:case 38:case 39:case 40:this.arrowKeys.add(e.keyCode);this.startFlightScroll();CancelBubble(e);return false;case 16:this.arrowKeys.add(e.keyCode);CancelBubble(e);return false;case 18:if(_bi.type==2&&_bi.subType==1){CancelBubble(e);return false;}return true;}return true;};ProAtlasMapCtrl.prototype.onKeyUp=function(e){switch(e.keyCode){case 37:case 38:case 39:case 40:case 16:this.arrowKeys.remove(e.keyCode);CancelBubble(e);return false;}return true;};ProAtlasMapCtrl.prototype.smoothZoom=function(_196){var _197=_196;if(!this.isSmoothZoomEnd){var _198=this.mapView.frontSheet.magnify;var _199=_198*this.stepMagnify;if(_199<0.01){_199=0.01;this.isSmoothZoomEnd=true;}else{if(_199>100){_199=100;this.isSmoothZoomEnd=true;}else{if((this.stepMagnify>1&&_199>this.targetMagnify)||(this.stepMagnify<1&&_199<this.targetMagnify)){_199=this.targetMagnify;this.isSmoothZoomEnd=true;}else{if(this.stepMagnify==1){_199=this.targetMagnify;this.isSmoothZoomEnd=true;}}var _19a=this.mapView.frontSheet.packageId;var _19b=this.mapView.frontSheet.layerId;var _19c=this.mapView.frontSheet.angle;var _19d=false;var _19e=false;var _19f=this.getCurrentMapDatum();var _1a0=this.getTargetVendor(this.getCurrentPackageId(),_19b);this.mapView.frontSheet.setCenterAndScale(_197,_19a,_19b,_199,_19c,_19d,_19e,_1a0,_19f);AlpsEvent.triggerEvent(this,"layerChanging");}}var _1a1;if(!this.enableZoomendFadeinEfct||(_bi.type==2&&_bi.subType==1&&_bi.version<1.5)||(_bi.type==2&&_bi.subType==3&&_bi.version<1.8)||(_bi.type==2&&_bi.subType==2)||(_bi.type==4&&_bi.version<9)){_1a1=10;}else{_1a1=10;}this.zoomTimerId=_setTimeout(this,this.smoothZoom,_1a1,_197);}else{var _19a=this.mapView.backSheet.packageId;var _19b=this.mapView.backSheet.layerId;this.mapView.backSheet.magnify=1;var _19d=true;this.mapView.backSheet.setTileCount(this.mapView.conv.m_windowWidth,this.mapView.conv.m_windowHeight,_19d);var _19c=this.mapView.backSheet.angle;var _19e=true;var _19f=this.getCurrentMapDatum();var _1a0=this.getTargetVendor(this.getCurrentPackageId(),_19b);this.mapView.backSheet.setCenterAndScale(_197,_19a,_19b,this.mapView.backSheet.magnify,_19c,_19d,_19e,_1a0,_19f);this.zoomTimerId=0;if(!this.enableZoomendFadeinEfct||(_bi.type==2&&_bi.subType==1&&_bi.version<1.5)||(_bi.type==2&&_bi.subType==3&&_bi.version<1.8)||(_bi.type==2&&_bi.subType==2)||(_bi.type==4&&_bi.version<9)){this.mapView.flipSheet();AlpsEvent.triggerEvent(this,"layerChanged");}else{this.mapView.fadeinFlipSheet("layer");}}};ProAtlasMapCtrl.prototype.onMouseWheel=function(e){if(!this.enableWheelOperation){return;}e=(e?e:window.event);var _1a3=e.srcElement||e.target;var _1a4=e.wheelDelta?e.wheelDelta:e.detail*-1;if(_bi.type==4&&_bi.version<9){_1a4*=-1;}while(_1a3!=this.mapView.mapContainer){if(_1a3.parentNode==null){return;}_1a3=_1a3.parentNode;}if(this.enableReverseWheelOperation){_1a4*=-1;}var _1a5;if(_1a4<0){_1a5=this.mapView.frontSheet.layerId-1;}else{_1a5=this.mapView.frontSheet.layerId+1;}var _1a6=this.mapView.frontSheet.vendor;if(_1a6==1){var _1a7=this.mapView.frontSheet.packageId;var _1a8=this.mapView.frontSheet.getCurrentPackage().layerCollect[_1a5];if(!_1a8){return;}if(_1a4<0&&!this.IsEnableLayer(_1a7,_1a5)&&_1a8.IsExistVendor("alps")&&this.IsEnableLayer(_1a7,this.getLayerId(_keyLayerScale,0,true))){return;}}else{if(_1a6==2){var _1a7=this.mapView.frontSheet.packageId;var _1a8=this.mapView.frontSheet.getCurrentPackage().layerCollect[_1a5];if(!_1a8){return;}if(_1a4<0&&!this.IsEnableLayer(_1a7,_1a5)&&!this.IsEnableLayer(_1a7,this.getLayerId(_keyLayerScale,0,true))&&_1a8.projInfo_inc.level==0){return;}}}this.smoothLayerTo(_1a5,true);CancelBubble(e);return;};ProAtlasMapCtrl.prototype.onClick=function(e){if(!this.isMouseMoved){var pos=getRelativePos(e,this.mapView.mapContainer);var _1ab=this.mapView.conv.Log2LL(pos);if(this.enableSingleClickCentering){if(this.enableSmoothScroll){this.startSmoothCentering(_1ab,true);}else{this.moveTo(_1ab,null,true,false,true);}}AlpsEvent.triggerEvent(this,"click",this.toOutside(_1ab,true),_buttonLeft);}};ProAtlasMapCtrl.prototype.onDblClick=function(e){var pos=getRelativePos(e,this.mapView.mapContainer);var _1ae=this.mapView.conv.Log2LL(pos);if(this.enableDbClickCentering){if(this.enableSmoothScroll){this.startSmoothCentering(_1ae,true);}else{this.moveTo(_1ae,null,true,false,true);}}AlpsEvent.triggerEvent(this,"dbClick",this.toOutside(_1ae,true));};ProAtlasMapCtrl.prototype.onContextMenu=function(e){if(_bi.type==1||_bi.type==2||_bi.type==3){var pos=getRelativePos(e,this.mapView.mapContainer);var _1b1=this.mapView.conv.Log2LL(pos);AlpsEvent.triggerEvent(this,"click",this.toOutside(_1b1,true),_buttonRight);}};ProAtlasMapCtrl.prototype.startSmoothCentering=function(_1b2,_1b3,_1b4){this.stopFlightScroll(_1b3);AlpsEvent.triggerEvent(this,"mapSmoothMoving");this.targetLatLon=new LLPoint(_1b2.lat,_1b2.lon);this.cntrngCount=0;if(_1b3==null){_1b3=false;}this.cntrngTimerId=_setTimeout(this,this.smoothCentering,1,_1b3,_1b4);};ProAtlasMapCtrl.prototype.smoothCentering=function(_1b5,_1b6){this.cntrngTimerId=0;var _1b7=this.mapView.conv.LL2Log(this.mapView.conv.m_center);var _1b8=this.mapView.conv.LL2Log(this.targetLatLon);if(!_1b6&&(_1b8.x<0||_1b8.x>this.mapView.conv.m_windowWidth||_1b8.y<0||_1b8.y>this.mapView.conv.m_windowHeight)){this.moveTo(this.targetLatLon,null,_1b5,false,true);}else{if((Math.abs(_1b7.x-_1b8.x)<2&&Math.abs(_1b7.y-_1b8.y)<2)||this.cntrngCount>30){this.moveTo(this.targetLatLon,null,_1b5,false,true);}else{if(this.cntrngCount<3){this.cntrngCount+=1;var _1b9=new Point((_1b7.x*4+_1b8.x)/5,(_1b7.y*4+_1b8.y)/5);var _1ba=this.mapView.conv.Log2LL(_1b9);this.moveTo(_1ba,null,_1b5,true,true);this.cntrngTimerId=_setTimeout(this,this.smoothCentering,this.cntrngElapseTime,_1b5,_1b6);}else{this.cntrngCount+=1;var _1b9=new Point((_1b7.x+_1b8.x)/2,(_1b7.y+_1b8.y)/2);var _1ba=this.mapView.conv.Log2LL(_1b9);this.moveTo(_1ba,null,_1b5,true,true);this.cntrngTimerId=_setTimeout(this,this.smoothCentering,this.cntrngElapseTime,_1b5,_1b6);}}}};ProAtlasMapCtrl.prototype.stopSmoothCentering=function(_1bb){if(this.cntrngTimerId!=0){clearTimeout(this.cntrngTimerId);this.cntrngTimerId=0;if(_1bb==null){_1bb=false;}AlpsEvent.triggerEvent(this,"premapMoved",_1bb);return true;}else{return false;}};ProAtlasMapCtrl.prototype.startFlightScroll=function(){if(this.flightScrollTimerId==0){this.flightScrollCount=0;this.flightScrollTimerId=_setTimeout(this,this.flightScroll,5);}};ProAtlasMapCtrl.prototype.stopFlightScroll=function(_1bc){if(this.flightScrollTimerId!=0){clearTimeout(this.flightScrollTimerId);this.flightScrollTimerId=0;this.velocityX=0;this.velocityY=0;if(_1bc==null){_1bc=false;}AlpsEvent.triggerEvent(this,"premapMoved",_1bc);return true;}else{return false;}};ProAtlasMapCtrl.prototype.flightScroll=function(){var _1bd=0;var _1be=0;var _1bf=this.accelerationOfJetEngine;if(this.arrowKeys.contains(16)){_1bf*=3;}if(this.arrowKeys.contains(37)){_1bd-=_1bf;}if(this.arrowKeys.contains(39)){_1bd+=_1bf;}if(this.arrowKeys.contains(38)){_1be-=_1bf;}if(this.arrowKeys.contains(40)){_1be+=_1bf;}this.flightScrollCore(_1bd,_1be,this.flightScrollElapseTime/1000);if(this.velocityX!=0||this.velocityY!=0){if(this.flightScrollCount>=50){this.flightScrollCount=0;AlpsEvent.triggerEvent(this,"premapMoved",true);}else{this.flightScrollCount+=1;}this.flightScrollTimerId=_setTimeout(this,this.flightScroll,this.flightScrollElapseTime);}else{this.flightScrollTimerId=0;AlpsEvent.triggerEvent(this,"premapMoved",true);}};ProAtlasMapCtrl.prototype.flightScrollCore=function(_1c0,_1c1,_1c2){var _1c3=-this.coefficientOfAirResistance*this.velocityX;var _1c4=-this.coefficientOfAirResistance*this.velocityY;var _1c5=this.objectMass*_1c0+_1c3;var _1c6=this.objectMass*_1c1+_1c4;var aX=_1c5/this.objectMass;var aY=_1c6/this.objectMass;var _1c9=this.velocityX*_1c2+0.5*aX*_1c2*_1c2;var _1ca=this.velocityY*_1c2+0.5*aY*_1c2*_1c2;if(Math.abs(_1c9)<2&&Math.abs(_1ca)<2){this.velocityX=0;this.velocityY=0;}else{this.velocityX=_1c9/_1c2;this.velocityY=_1ca/_1c2;if(_1c9!=0||_1ca!=0){var _1cb=new Point(this.mapView.conv.m_windowWidth/2+_1c9,this.mapView.conv.m_windowHeight/2+_1ca);var _1cc=this.mapView.conv.Log2LL(_1cb);this.moveTo(_1cc,true,true,false,true);}}};ProAtlasMapCtrl.prototype.mapMoving=function(){if(this.mapView.backSheet.getVisible()){this.mapView.backSheet.setVisible(false);this.mapView.backSheet.resetAllTiles();}if(this.premapMovedTimerId){window.clearTimeout(this.premapMovedTimerId);this.premapMovedTimerId=0;}};ProAtlasMapCtrl.prototype.premapMoved=function(_1cd){if(this.getDatumTimerId){window.clearTimeout(this.getDatumTimerId);this.getDatumTimerId=0;}if(typeof (_dc)=="undefined"||!_dc.server){AlpsEvent.triggerEvent(this,"mapMoved",_1cd);}else{this.getDatumTimerId=_setTimeout(this,this.timer_updateDatumInfo,_delaytime,_1cd);}if(this.premapMovedTimerId){window.clearTimeout(this.premapMovedTimerId);this.premapMovedTimerId=0;}this.premapMovedTimerId=_setTimeout(this,this.timer_updateLayerScaleList,_delaytime);};ProAtlasMapCtrl.prototype.timer_updateDatumInfo=function(_1ce){if(typeof (_dc)=="undefined"||!_dc.server){AlpsEvent.triggerEvent(this,"mapMoved",_1ce);return;}var _1cf=this.getCurrentMapDatum();var _1d0=this;if(!_dc.getExistsMesh(this.mapView.conv.m_center)){AlpsEvent.triggerEvent(_1d0,"mapMoved",_1ce);}else{var _1d1=function(dB,dL){AlpsEvent.triggerEvent(_1d0,"mapMoved",_1ce);};if(_1cf=="wgs84"){_dc.getRevParam(this.mapView.conv.m_center,_1d1);}else{if(_1cf=="tokyo97"){_dc.getParam(this.mapView.conv.m_center,_1d1);}else{AlpsEvent.triggerEvent(_1d0,"mapMoved",_1ce);}}}};ProAtlasMapCtrl.prototype.timer_updateLayerScaleList=function(){if(this.yahooMapLayer){this.updateLayerScaleList();}else{for(var i=0;i<this.mapView.packageCollect.length;++i){this.updateLayerScaleList(this.mapView.packageCollect[i]);}}};ProAtlasMapCtrl.prototype.layerListChanged=function(_1d5){if(_1d5!=this.getCurrentPackageId()){return;}if(_1d5==this.mapView.frontSheet.packageId&&this.mapView.frontSheet.vendor==1){var _1d6=this.mapView.frontSheet.getCurrentPackage().layerCollect[this.mapView.frontSheet.layerId];var _1d7=this.mapView.frontSheet.projId;var _1d8=_1d6.getEnableProjInfo(this.layerCodeList[_1d5],_1d7);if(_1d8&&_1d7!=_1d8.id){this.mapView.frontSheet.projId=_1d8.id;var _1d9=this.mapView.frontSheet.packageId;var _1da=this.mapView.conv.m_center;var _1db=this.mapView.frontSheet.layerId;var _1dc=this.mapView.frontSheet.magnify;var _1dd=this.mapView.frontSheet.angle;var _1de=true;var _1df=true;this.mapView.frontSheet.setCenterAndScale(_1da,_1d9,_1db,_1dc,_1dd,_1de,_1df);}}this.autoLayerChange();};ProAtlasMapCtrl.prototype.autoLayerChange=function(){if(!this.enableAutoLayerChange){return;}if(this.mapView.frontSheet.vendor==1){var _1e0=this.getCurrentLayerId(true);var _1e1=this.getCurrentPackageId();if(this.IsEnableLayer(_1e1,_1e0)){return;}var _1e2=this.mapView.frontSheet.getCurrentPackage().layerCollect[_1e0];if(!_1e2){return;}if(this.IsEnableLayer(_1e1,this.getLayerId(_keyLayerScale,0,true))){_1e0+=1;this.smoothLayerTo(_1e0,true);}else{if(!_1e2.IsExistVendor("inc")){_1e0+=1;this.smoothLayerTo(_1e0,true);}else{this.smoothVendorTo(2);}}}else{if(this.mapView.frontSheet.vendor==2){var _1e0=this.getCurrentLayerId(true);var _1e1=this.getCurrentPackageId();if(this.IsEnableLayer(_1e1,_1e0)){this.smoothVendorTo(1);}else{var _1e2=this.mapView.frontSheet.getCurrentPackage().layerCollect[_1e0];if(_1e2){if((this.IsEnableLayer(_1e1,this.getLayerId(_keyLayerScale,0,true))&&_1e2.IsExistVendor("alps"))||(!this.IsEnableLayer(_1e1,this.getLayerId(_keyLayerScale,0,true))&&(_1e2.projInfo_inc.level==-2))){_1e0+=1;this.smoothLayerTo(_1e0,true);}}}}}};ProAtlasMapCtrl.prototype.updateLayerScaleList=function(_1e3){if(_1e3){if(this.mapView.getMapPackage(_1e3).layerServerType=="callback"){this.updateLayerScaleListByJson(_1e3);}else{this.updateLayerScaleListByXMLHttp(_1e3);}}else{if(this.yahooMapLayerType=="callback"){this.updateYahooLayerScaleListByJason();}else{this.updateYahooLayerScaleListByXMLHttp();}}};ProAtlasMapCtrl.prototype.updateLayerScaleListByXMLHttp=function(_1e4){var _1e5=AlpsUtil.getXMLHttp();if(!_1e5){return;}var _1e6=this.mapView.conv.m_center;var _1e7=this.getCurrentMapDatum();var p=datumConvert(_1e6,_1e7,"tokyo97");var _1e9=this.mapView.getMapPackage(_1e4).layerServerName;if(!_1e9){return;}var _1ea=this;var _1eb="getLayerTimerId_"+_1e4;_1e5.open("POST",_1e9,true);_1e5.onreadystatechange=function(){if(_1e5.readyState==4){if(_1ea[_1eb]){window.clearTimeout(_1ea[_1eb]);_1ea[_1eb]=null;}var _1ec=_1ea.mapView.conv.m_center;if(_1ec.lat!=_1e6.lat||_1ec.lon!=_1e6.lon||_1ea.getCurrentMapDatum()!=_1e7){return;}if(_1e5.status==200&&_1e5.responseXML){_1ea.layerScaleList[_1e4]._clear();_1ea.layerCodeList[_1e4]._clear();var _1ed=AlpsUtil.getElementContent(_1e5.responseXML,"layers");if(_1ed){var s=_1ed.split(",");for(var i=0;i<s.length;++i){_1ea.layerScaleList[_1e4].push(parseInt(s[i]));}}var nR=_1e5.responseXML.getElementsByTagName("result")[0];var _1f1=nR.childNodes;for(var i=0;i<_1f1.length;++i){var n=_1f1[i];if(n.nodeType==1&&n.nodeName=="layer"){var code=n.getAttribute("code");var _1f4=AlpsUtil.getNodeContent(n);var _1f5=new Object;_1f5.scale=_1f4;_1f5.code=code;_1ea.layerCodeList[_1e4].push(_1f5);}}AlpsEvent.triggerEvent(_1ea,"layerListChanged",_1e4);}else{}}};var doc=AlpsUtil.createXMLDOM();var _1f7=doc.createElement("query");doc.appendChild(_1f7);var _1f8=doc.createElement("coordinates");_1f7.appendChild(_1f8);_1f8.appendChild(doc.createTextNode(p.toString()));_1e5.send(doc);if(this[_1eb]){window.clearTimeout(this[_1eb]);this[_1eb]=null;}this[_1eb]=_setTimeout(this,this.getLayerTimeoutFn,3000,_1e4);};ProAtlasMapCtrl.prototype.getLayerTimeoutFn=function(_1f9){var _1fa="getLayerTimerId_"+_1f9;this[_1fa]=null;};ProAtlasMapCtrl.prototype.updateYahooLayerScaleListByXMLHttp=function(){var _1fb=AlpsUtil.getXMLHttp();if(!_1fb){return;}var _1fc=this.mapView.conv.m_center;var _1fd=this.getCurrentMapDatum();var p=datumConvert(_1fc,_1fd,"tokyo97");var _1ff=this.yahooMapLayer;if(!_1ff){return;}var _200=this;var _201="getLayerTimerId";_1fb.open("POST",_1ff,true);_1fb.onreadystatechange=function(){if(_1fb.readyState==4){if(_200[_201]){window.clearTimeout(_200[_201]);_200[_201]=null;}var _202=_200.mapView.conv.m_center;if(_202.lat!=_1fc.lat||_202.lon!=_1fc.lon||_200.getCurrentMapDatum()!=_1fd){return;}if(_1fb.status==200&&_1fb.responseXML){var _203=_1fb.responseXML.getElementsByTagName("mappackage");for(var j=0;j<_203.length;++j){var _205=_203[j];var _206=_205.getAttribute("id");if(!_200.IsExistPackage(_206)){continue;}_200.layerScaleList[_206]._clear();_200.layerCodeList[_206]._clear();var _207=AlpsUtil.getElementContent(_205,"layers");if(_207){var s=_207.split(",");for(var i=0;i<s.length;++i){_200.layerScaleList[_206].push(parseInt(s[i]));}}var nR=_205;var _20b=nR.childNodes;for(var i=0;i<_20b.length;++i){var n=_20b[i];if(n.nodeType==1&&n.nodeName=="layer"){var code=n.getAttribute("code");var _20e=n.getAttribute("copyright");var _20f=AlpsUtil.getNodeContent(n);var _210=new Object;_210.scale=_20f;_210.code=code;_210.copyright=_20e;_200.layerCodeList[_206].push(_210);}}AlpsEvent.triggerEvent(_200,"layerListChanged",_206);}}else{_200.getYahooLayerTimeoutFn();}}};var doc=AlpsUtil.createXMLDOM();var _212=doc.createElement("query");doc.appendChild(_212);var _213=doc.createElement("coordinates");_212.appendChild(_213);_213.appendChild(doc.createTextNode(p.toString()));_1fb.send(doc);if(this[_201]){window.clearTimeout(this[_201]);this[_201]=null;}this[_201]=_setTimeout(this,this.getYahooLayerTimeoutFn,3000);};ProAtlasMapCtrl.prototype.getYahooLayerTimeoutFn=function(){var _214="getLayerTimerId";this[_214]=null;var _215=this.getPackageList();for(var i=0;i<_215.length;++i){}};ProAtlasMapCtrl.prototype.updateLayerScaleListByJson=function(_217){var _218=this.mapView.conv.m_center;var _219=this.getCurrentMapDatum();var p=datumConvert(_218,_219,"tokyo97");var _21b=this.mapView.getMapPackage(_217).layerServerName;if(!_21b){return;}_21b=_21b+"?c="+p.toString();var _21c=this;_cb.send(_21b,function(ary){if(ary!=undefined){var _21e=_21c.mapView.conv.m_center;if(_21e.lat!=_218.lat||_21e.lon!=_218.lon||_21c.getCurrentMapDatum()!=_219){return;}_21c.layerScaleList[_217]._clear();_21c.layerCodeList[_217]._clear();for(var i=0;i<ary.length;++i){_21c.layerScaleList[_217].push(parseInt(ary[i].scale));var _220=new Object;_220.scale=ary[i].scale;_220.code=ary[i].code;_21c.layerCodeList[_217].push(_220);}AlpsEvent.triggerEvent(_21c,"layerListChanged",_217);}else{}});};ProAtlasMapCtrl.prototype.updateYahooLayerScaleListByJason=function(){var _221=this.mapView.conv.m_center;var _222=this.getCurrentMapDatum();var p=datumConvert(_221,_222,"tokyo97");var _224=this.mapView.frontSheet.packageId;var _225=parseInt(this.mapView.frontSheet.layerId);var _226=this.yahooMapLayer;var _227=String(this.getCurrentVendor());if(!_226){return;}_226=_226+"?c="+p.toString()+"&sc="+(_225+1)+"&mode="+_224+"&vendor="+_227;var _228=this;_cb.send(_226,function(obj){if(obj!=undefined){var _22a=_228.mapView.conv.m_center;if(_22a.lat!=_221.lat||_22a.lon!=_221.lon||_222!=_228.getCurrentMapDatum()){return;}_228.yahooCopyright=obj["copyright"];if(_228.yahooCopyright==undefined){_228.yahooCopyright="";}var _22b=_228.getPackageList();for(var j=0;j<_22b.length;++j){var _22d=_22b[j];var ary=obj[_22d];if(ary!=undefined){_228.layerScaleList[_22d]._clear();_228.layerCodeList[_22d]._clear();for(var i=0;i<ary.length;++i){_228.layerScaleList[_22d].push(parseInt(ary[i].scale));var _230=new Object;_230.scale=ary[i].scale;_230.code=ary[i].code;_230.copyright=ary[i].copyright;if(_230.copyright==undefined){_230.copyright="";}_228.layerCodeList[_22d].push(_230);}AlpsEvent.triggerEvent(_228,"layerListChanged",_22d);}else{}}}else{}});};ProAtlasMapCtrl.prototype.layerChanged=function(){this.autoLayerChange();};ProAtlasMapCtrl.prototype.packageChanged=function(){};ProAtlasMapCtrl.prototype.vendorChanged=function(){};ProAtlasMapCtrl.prototype.IsEnableLayer=function(_231,_232){var _233=this.mapView.getMapPackage(_231);var _234=_233.getLayerScale(_232);var _235=this.layerScaleList[_231];for(var i=0;i<_235.length;++i){if(_235[i]==_234){return true;}}return false;};ProAtlasMapCtrl.prototype.toInside=function(_237,_238){var _239=this.getCurrentMapDatum();return datumConvert(_237,(_238?this.datum:_239),_239);};ProAtlasMapCtrl.prototype.toOutside=function(inLL,_23b){var _23c=this.getCurrentMapDatum();return datumConvert(inLL,_23c,(_23b?this.datum:_23c));};ProAtlasMapCtrl.prototype.toInsideLayerId=function(_23d,_23e){var _23f=_23d;if(_23e){if(this.version=="v1"){_23f=this.layerId_V1_2_V2(_23d);}}return _23f;};ProAtlasMapCtrl.prototype.toOutsideLayerId=function(_240,_241){var _242=_240;if(_241){if(this.version=="v1"){_242=this.layerId_V2_2_V1(_240);}}return _242;};ProAtlasMapCtrl.prototype.layerId_V1_2_V2=function(_243){var _244=_layerScaleList.v1[_243];var _245=this.getNearestLayerId(_layerScaleList.v2,_244);return _245;};ProAtlasMapCtrl.prototype.layerId_V2_2_V1=function(_246){var _247=_layerScaleList.v2[_246];var _248=this.getNearestLayerId(_layerScaleList.v1,_247);return _248;};ProAtlasMapCtrl.prototype.getNearestLayerId=function(_249,_24a){var _24b=null;var _24c=10000;for(var i=_249.length-1;i>=0;--i){var s=_249[i];var diff=s/_24a;if(diff<1){diff=1/diff;}if(diff<_24c){_24c=diff;_24b=i;}}return _24b;};ProAtlasMapCtrl.prototype.getCurrentMapDatum=function(){var _250="tokyo97";var _251=this.mapView.frontSheet.vendor;var _252=this.getCurrentLayerId(true);if(_252==null){return null;}var _253=this.mapView.frontSheet.getCurrentPackage().layerCollect[_252];if(_251==1){var proj=_253.getProjInfoById(this.mapView.frontSheet.projId);if(proj&&proj.datum!=undefined){_250=proj.datum;}}else{if(_251==2){var proj=_253.projInfo_inc;if(proj&&proj.datum!=undefined){_250=proj.datum;}}}return _250;};ProAtlasMapCtrl.prototype.getTargetVendor=function(_255,_256){var _257=this.mapView.frontSheet.vendor;var _258=this.mapView.getMapPackage(_255);var _259=_258?_258.layerCollect[_256]:null;if(_257==1&&_259){var _25a=this.IsEnableLayer(_255,_256);var _25b=_259.IsExistVendor("inc");var _25c=this.IsEnableLayer(_255,this.getLayerId(_keyLayerScale,0,true));if(!_259.IsExistVendor("alps")||(!_25a&&_25b&&!_25c)){_257=2;}}else{if(_257==2&&_259){if(_259.IsExistVendor("alps")&&(this.IsEnableLayer(_255,_256)||this.IsEnableLayer(_255,this.getLayerId(_keyLayerScale,0,true)))){_257=1;}}}return _257;};ProAtlasMapCtrl.prototype.moveTo=function(_25d,_25e,_25f,_260,_261){var _262=this.datum;if(_261){_262=this.getCurrentMapDatum();}var _263=this.checkScrollRange(_25d);if(_260==null){_260=false;}if(!_260){this.stopSmoothCentering(_25f);}if(_25e==null){_25e=false;}if(!_25e){this.stopFlightScroll(_25f);}var _264=this.mapView.frontSheet.packageId;var _265=this.mapView.frontSheet.layerId;var _266=this.mapView.frontSheet.magnify;var _267=this.mapView.frontSheet.angle;var _268=true;var _269=false;this.mapView.frontSheet.setCenterAndScale(_263,_264,_265,_266,_267,_268,_269,this.mapView.frontSheet.vendor,_262);AlpsEvent.triggerEvent(this,"mapMoving");if(!this.isMouseDown&&!_260&&this.velocityX==0&&this.velocityY==0){if(_25f==null){_25f=false;}AlpsEvent.triggerEvent(this,"premapMoved",_25f);}};ProAtlasMapCtrl.prototype.checkScrollRange=function(_26a){var _26b=this.mapView.frontSheet.getCurrentPackage().layerCollect[this.getCurrentLayerId(true)];var _26c=_26b.getProjInfoById(this.mapView.frontSheet.projId);var _26d=new LLPoint(_26a.lat,_26a.lon);if(!_26b.scrollrange.enable){return _26d;}if(_26c){var conv=new CoordinatesConversion();if(_26c.code!=2){conv.setProjConv(_26c.code,new LLPoint(_26c.origin.lat,_26c.origin.lon),_26c.subInfo);}else{conv.setProjConv(_26c.code,null,_26c.subInfo);}conv.setScale(this.getCurrentScale()/this.getCurrentMagnify());conv.setAngle(0);conv.setCenter(this.mapView.conv.m_center);var _26f=conv.LL2Meter(_26d);var _270=false;if(_26b.scrollrange.bottomleftLatLon){var _271=conv.LL2Meter(_26b.scrollrange.bottomleftLatLon);if(_26f.x<_271.x){_270=true;_26f.x=_271.x;}if(_26f.y<_271.y){_270=true;_26f.y=_271.y;}}if(_26b.scrollrange.toprightLatLon){var _272=conv.LL2Meter(_26b.scrollrange.toprightLatLon);if(_272.x<_26f.x){_270=true;_26f.x=_272.x;}if(_272.y<_26f.y){_270=true;_26f.y=_272.y;}}if(_270){_26d=conv.Meter2LL(_26f);}}if(_26b.scrollrange.top){if(_26b.scrollrange.top<_26d.lat){_26d.lat=_26b.scrollrange.top;}}if(_26b.scrollrange.bottom){if(_26b.scrollrange.bottom>_26d.lat){_26d.lat=_26b.scrollrange.bottom;}}if(_26b.scrollrange.left){if(_26b.scrollrange.left>_26d.lon){_26d.lon=_26b.scrollrange.left;}}if(_26b.scrollrange.right){if(_26b.scrollrange.right<_26d.lon){_26d.lon=_26b.scrollrange.right;}}return _26d;};ProAtlasMapCtrl.prototype.smoothMoveTo=function(_273,_274){var _275=this.getCurrentMapDatum();var _276=this;var _277=true;datumConvert(_273,this.datum,_275,_277,function(_278){_276.stopSmoothCentering();_276.stopFlightScroll();_276.startSmoothCentering(_278,false,_274);});};ProAtlasMapCtrl.prototype.emergeMoveTo=function(_279){var _27a=this.getCurrentMapDatum();var _27b=this.checkScrollRange(_279);var _27c=false;this.stopSmoothCentering(_27c);this.stopFlightScroll(_27c);if(this.mapView.isFadeinFlipping()){this.mapView.stopFadeinFlipping();}this.mapView.backSheet.setVisible(false);this.mapView.backSheet.resetAllTiles();var _27d=this.mapView.frontSheet.packageId;var _27e=this.mapView.frontSheet.layerId;var _27f=this.mapView.frontSheet.magnify;var _280=this.mapView.frontSheet.angle;var _281=true;var _282=true;this.mapView.backSheet.setCenterAndScale(_27b,_27d,_27e,_27f,_280,_281,_282,this.mapView.frontSheet.vendor,_27a);this.mapView.fadeinFlipSheet("mapmove");};ProAtlasMapCtrl.prototype.packageTo=function(_283){if(this.zoomTimerId!=0){return;}this.stopSmoothCentering();this.stopFlightScroll();var _284=this.mapView.getMapPackage(_283);var _285=null;var _286=0;if(this.mapView.frontSheet.layerId!=null){_286=this.mapView.getMapPackage(this.mapView.frontSheet.packageId).getLayerScale(this.mapView.frontSheet.layerId);}if(_286!=0){_285=this.mapView.getMapPackage(_283).getLayerId(_286,0,true);}var _287=this.getTargetVendor(_283,_285);var _288=this.getCurrentMapDatum();this.mapView.backSheet.setVisible(false);this.mapView.backSheet.resetAllTiles();var _289=this.mapView.conv.m_center;var _28a=this.mapView.frontSheet.magnify;var _28b=this.mapView.frontSheet.angle;var _28c=true;var _28d=true;this.mapView.backSheet.setCenterAndScale(_289,_283,_285,_28a,_28b,_28c,_28d,_287,_288);this.mapView.flipSheet();AlpsEvent.triggerEvent(this,"packageChanged");if(this.mapView.frontSheet.angle!=this.mapView.backSheet.angle){AlpsEvent.triggerEvent(this,"angleChanged");}if(this.mapView.frontSheet.scale!=this.mapView.backSheet.scale){AlpsEvent.triggerEvent(this,"layerChanged");}};ProAtlasMapCtrl.prototype.smoothPackageTo=function(_28e){if(_bi.type==4&&_bi.version<9){this.packageTo(_28e);return;}if(this.mapView.fadeinTimerId!=0){return;}if(this.zoomTimerId!=0){return;}if(_28e==this.mapView.frontSheet.packageId){return;}this.stopSmoothCentering();this.stopFlightScroll();AlpsEvent.triggerEvent(this,"smoothPackageChanging",this.mapView.frontSheet.packageId,_28e);var _28f=this.mapView.getMapPackage(_28e);var _290=null;var _291=0;if(this.mapView.frontSheet.layerId!=null){_291=this.mapView.getMapPackage(this.mapView.frontSheet.packageId).getLayerScale(this.mapView.frontSheet.layerId);}if(_291!=0){_290=this.mapView.getMapPackage(_28e).getLayerId(_291,0,true);}var _292=this.getTargetVendor(_28e,_290);var _293=this.getCurrentMapDatum();this.mapView.backSheet.setVisible(false);this.mapView.backSheet.resetAllTiles();var _294=this.mapView.conv.m_center;var _295=this.mapView.frontSheet.magnify;var _296=this.mapView.frontSheet.angle;var _297=true;var _298=true;this.mapView.backSheet.setCenterAndScale(_294,_28e,_290,_295,_296,_297,_298,_292,_293);this.mapView.fadeinFlipSheet("package");};ProAtlasMapCtrl.prototype.layerTo=function(_299,_29a,_29b){if(this.zoomTimerId!=0){return;}_29a=this.mapView.frontSheet;var _29c=_29a.getCurrentPackage();if(_29b){if(0<=_299&&_299<_29c.layerCollect.length){if(!_29c.layerCollect[_299].operation){return;}}}_299=this.toInsideLayerId(_299,!_29b);if(_299<0){_299=0;}else{if(_29a.getCurrentPackage().layerCollect.length<=_299){_299=_29a.getCurrentPackage().layerCollect.length-1;}}this.stopSmoothCentering(_29b);this.stopFlightScroll(_29b);var _29d=this.getTargetVendor(this.getCurrentPackageId(),_299);var _29e=this.getCurrentMapDatum();this.mapView.backSheet.setVisible(false);this.mapView.backSheet.resetAllTiles();var _29f=_29a.packageId;var _2a0=this.mapView.conv.m_center;var _2a1=_29a.magnify;var _2a2=_29a.angle;var _2a3=true;var _2a4=true;this.mapView.frontSheet.setCenterAndScale(_2a0,_29f,_299,_2a1,_2a2,_2a3,_2a4,_29d,_29e);AlpsEvent.triggerEvent(this,"layerChanged");};ProAtlasMapCtrl.prototype.smoothLayerTo=function(_2a5,_2a6){if(this.zoomTimerId!=0){return;}if(this.mapView.isFadeinFlipping()){this.mapView.stopFadeinFlipping();}_2a5=this.toInsideLayerId(_2a5,!_2a6);var _2a7=this.mapView.frontSheet.getCurrentPackage();if(_2a7!=null&&_2a5<0){_2a5=0;}else{if(_2a7!=null&&_2a7.layerCollect.length<=_2a5){_2a5=_2a7.layerCollect.length-1;}}if(_2a5==this.mapView.frontSheet.layerId){return;}if(_2a6){if(!_2a7.layerCollect[_2a5].operation){return;}}this.stopSmoothCentering(_2a6);this.stopFlightScroll(_2a6);var _2a8=this.toOutsideLayerId(this.mapView.frontSheet.layerId,true);var _2a9=this.toOutsideLayerId(_2a5,true);AlpsEvent.triggerEvent(this,"smoothLayerChanging",_2a8,_2a9);var _2aa=this.getCurrentMapDatum();var _2ab=this.getTargetVendor(this.getCurrentPackageId(),_2a5);this.mapView.backSheet.setVisible(false);this.mapView.backSheet.resetAllTiles();this.mapView.backSheet.magnify=1;var _2ac=true;this.mapView.backSheet.setTileCount(this.mapView.conv.m_windowWidth,this.mapView.conv.m_windowHeight,_2ac);var _2ad=this.mapView.frontSheet.packageId;var _2ae=this.mapView.conv.m_center;var _2af=this.mapView.frontSheet.angle;var _2b0=true;this.mapView.backSheet.setCenterAndScale(_2ae,_2ad,_2a5,this.mapView.backSheet.magnify,_2af,_2ac,_2b0,_2ab,_2aa);var _2b1;if(this.mapView.frontSheet.vendor==2){_2b1=_2a7.layerCollect[this.getCurrentLayerId(true)].projInfo_inc.scale;}else{_2b1=_2a7.getLayerScale(this.mapView.frontSheet.layerId);}var _2b2;if(_2ab==2){var _2b3=_2a7?_2a7.layerCollect[_2a5]:null;_2b2=_2b3?_2b3.projInfo_inc.scale:this.getCurrentScale();}else{_2b2=_2a7.getLayerScale(_2a5);}this.targetMagnify=_2b1/_2b2;if(!this.enableZoomendFadeinEfct||(_bi.type==2&&_bi.subType==1&&_bi.version<1.5)||(_bi.type==2&&_bi.subType==3&&_bi.version<1.8)||(_bi.type==2&&_bi.subType==2)||(_bi.type==4&&_bi.version<9)){this.stepMagnify=Math.pow(this.targetMagnify,0.1);}else{this.stepMagnify=Math.pow(this.targetMagnify,0.1);}this.isSmoothZoomEnd=false;this.smoothZoom(new LLPoint(_2ae.lat,_2ae.lon));};ProAtlasMapCtrl.prototype.moveAndLayerTo=function(_2b4,_2b5,_2b6){if(this.zoomTimerId!=0){return;}this.stopSmoothCentering();this.stopFlightScroll();var _2b7=this.datum;if(_2b6){_2b7=this.getCurrentMapDatum();}_2b5=this.toInsideLayerId(_2b5,!_2b6);var _2b8=this.mapView.frontSheet.getCurrentPackage();if(_2b8!=null&&_2b5<0){_2b5=0;}else{if(_2b8!=null&&_2b8.layerCollect.length<=_2b5){_2b5=_2b8.layerCollect.length-1;}}var _2b9=this.getTargetVendor(this.getCurrentPackageId(),_2b5);this.mapView.backSheet.setVisible(false);this.mapView.backSheet.resetAllTiles();var _2ba=this.mapView.frontSheet.packageId;var _2bb=this.mapView.frontSheet.magnify;var _2bc=this.mapView.frontSheet.angle;var _2bd=true;var _2be=true;this.mapView.backSheet.setCenterAndScale(_2b4,_2ba,_2b5,_2bb,_2bc,_2bd,_2be,_2b9,_2b7);this.mapView.flipSheet();AlpsEvent.triggerEvent(this,"mapMoving");AlpsEvent.triggerEvent(this,"premapMoved",false);AlpsEvent.triggerEvent(this,"layerChanged");};ProAtlasMapCtrl.prototype.magnifyTo=function(_2bf,_2c0,_2c1){if(this.zoomTimerId!=0){return;}if(this.mapView.isFadeinFlipping()){this.mapView.stopFadeinFlipping();}if(_2c1==undefined){_2c1=true;}if(_2c1){if(_2bf<_minMagnify){_2bf=_minMagnify;}if(_2bf>_maxMagnify){_2bf=_maxMagnify;}}else{if(_2bf<0.01){_2bf=0.01;}if(_2bf>100){_2bf=100;}}if(this.getCurrentMagnify()==_2bf){return;}this.stopSmoothCentering(_2c0);this.stopFlightScroll(_2c0);this.mapView.backSheet.setVisible(false);var _2c2=this.mapView.conv.m_center;var _2c3=this.mapView.frontSheet.packageId;var _2c4=this.mapView.frontSheet.layerId;var _2c5=this.mapView.frontSheet.angle;var _2c6=false;this.mapView.frontSheet.setCenterAndScale(_2c2,_2c3,_2c4,_2bf,_2c5,_2c1,_2c6);AlpsEvent.triggerEvent(this,"magnifyChanged");};ProAtlasMapCtrl.prototype.defaultTo=function(){var _2c7=this.mapView.getMapPackage(this.defPackageId).getLayerId(this.defScale,0,false);this.magnifyTo(1);this.packageTo(this.defPackageId);this.moveAndLayerTo(this.defPos,_2c7,false);};ProAtlasMapCtrl.prototype.latLon2Log=function(_2c8){var inLL=this.toInside(_2c8,true);var _2ca=this.mapView.conv.LL2Log(inLL);if(this.getCurrentScale()>=6103510){if(_2ca.x<0){var _2cb=this.mapView.conv.LL2Log(new LLPoint(_2c8.lat,180));var _2cc=this.mapView.conv.LL2Log(new LLPoint(_2c8.lat,-180));var newX=_2cb.x+(_2ca.x-_2cc.x);var _2ce=this.mapWidth/2;if(newX-_2ce<_2ce-_2ca.x){_2ca.x=newX;}}else{if(_2ca.x>this.mapWidth){var _2cb=this.mapView.conv.LL2Log(new LLPoint(_2c8.lat,180));var _2cc=this.mapView.conv.LL2Log(new LLPoint(_2c8.lat,-180));var newX=_2cc.x-(_2cb.x-_2ca.x);var _2ce=this.mapWidth/2;if(_2ce-newX<_2ca.x-_2ce){_2ca.x=newX;}}}}return _2ca;};ProAtlasMapCtrl.prototype.log2LatLon=function(_2cf){var _2d0=this.mapView.conv.Log2LL(_2cf);return this.toOutside(_2d0,true);};ProAtlasMapCtrl.prototype.setEnableDragScroll=function(_2d1){this.enableDragScroll=_2d1;};ProAtlasMapCtrl.prototype.getEnableDragScroll=function(){return this.enableDragScroll;};ProAtlasMapCtrl.prototype.setEnableDbClickCentering=function(_2d2){this.enableDbClickCentering=_2d2;};ProAtlasMapCtrl.prototype.getEnableDbClickCentering=function(){return this.enableDbClickCentering;};ProAtlasMapCtrl.prototype.setEnableSingleClickCentering=function(_2d3){this.enableSingleClickCentering=_2d3;};ProAtlasMapCtrl.prototype.getEnableSingleClickCentering=function(){return this.enableSingleClickCentering;};ProAtlasMapCtrl.prototype.setEnableKeyboardOperation=function(_2d4){this.enableKeyboardOperation=_2d4;if(!_2d4){this.arrowKeys.sleep();}else{this.arrowKeys.wakeup();this.startFlightScroll();}};ProAtlasMapCtrl.prototype.getEnableKeyboardOperation=function(){return this.enableKeyboardOperation;};ProAtlasMapCtrl.prototype.setEnableMagnifyOperation=function(_2d5){this.enableMagnifyOperation=_2d5;};ProAtlasMapCtrl.prototype.getEnableMagnifyOperation=function(){return this.enableMagnifyOperation;};ProAtlasMapCtrl.prototype.setEnableLayerOperation=function(_2d6){this.enableLayerOperation=_2d6;};ProAtlasMapCtrl.prototype.getEnableLayerOperation=function(){return this.enableLayerOperation;};ProAtlasMapCtrl.prototype.setEnableSmoothLayerOperation=function(_2d7){this.enableSmoothLayerOperation=_2d7;};ProAtlasMapCtrl.prototype.getEnableSmoothLayerOperation=function(){return this.enableSmoothLayerOperation;};ProAtlasMapCtrl.prototype.setEnableAngleOperation=function(_2d8){this.enableAngleOperation=_2d8;};ProAtlasMapCtrl.prototype.getEnableAngleOperation=function(){return this.enableAngleOperation;};ProAtlasMapCtrl.prototype.setEnableSmoothScroll=function(_2d9){this.enableSmoothScroll=_2d9;};ProAtlasMapCtrl.prototype.getEnableSmoothScroll=function(){return this.enableSmoothScroll;};ProAtlasMapCtrl.prototype.setEnableWheelOperation=function(_2da){this.enableWheelOperation=_2da;if(this.enableWheelOperation){this.addWheelEvent();}else{this.removeWheelEvent();}};ProAtlasMapCtrl.prototype.getEnableWheelOperation=function(){return this.enableWheelOperation;};ProAtlasMapCtrl.prototype.setEnableReverseWheelOperation=function(_2db){this.enableReverseWheelOperation=_2db;};ProAtlasMapCtrl.prototype.getEnableReverseWheelOperation=function(){return this.enableReverseWheelOperation;};ProAtlasMapCtrl.prototype.setEnableZoomendFadeinEfct=function(_2dc){this.enableZoomendFadeinEfct=_2dc;};ProAtlasMapCtrl.prototype.getEnableZoomendFadeinEfct=function(){return this.enableZoomendFadeinEfct;};ProAtlasMapCtrl.prototype.setEnablePackageOperation=function(_2dd){this.enablePackageOperation=_2dd;};ProAtlasMapCtrl.prototype.getEnablePackageOperation=function(){return this.enablePackageOperation;};ProAtlasMapCtrl.prototype.setVisibleCenterMark=function(_2de){this.mapView.setVisibleCenterMark(_2de);};ProAtlasMapCtrl.prototype.getVisibleCenterMark=function(){return this.mapView.getVisibleCenterMark();};ProAtlasMapCtrl.prototype.setVisibleCopyright=function(_2df){this.mapView.setVisibleCopyright(_2df);};ProAtlasMapCtrl.prototype.getVisibleCopyright=function(){this.mapView.getVisibleCopyright();};ProAtlasMapCtrl.prototype.setEnableAutoLayerChange=function(_2e0){this.enableAutoLayerChange=_2e0;};ProAtlasMapCtrl.prototype.getEnableAutoLayerChange=function(){return this.enableAutoLayerChange;};ProAtlasMapCtrl.prototype.setDatum=function(_2e1){this.datum=_2e1;};ProAtlasMapCtrl.prototype.getDatum=function(){return this.datum;};ProAtlasMapCtrl.prototype.getCenterLatLon=function(){return this.toOutside(this.mapView.conv.m_center,true);};ProAtlasMapCtrl.prototype.getCurrentPackageId=function(){return this.mapView.frontSheet.packageId;};ProAtlasMapCtrl.prototype.getPackageList=function(){var _2e2=new Array;for(var i=0;i<this.mapView.packageCollect.length;++i){_2e2.push(this.mapView.packageCollect[i]);}return _2e2;};ProAtlasMapCtrl.prototype.IsExistPackage=function(id){var _2e5=false;for(var i=0;i<this.mapView.packageCollect.length;++i){if(this.mapView.packageCollect[i]==id){_2e5=true;break;}}return _2e5;};ProAtlasMapCtrl.prototype.getCurrentLayerId=function(_2e7){var _2e8=this.mapView.frontSheet.layerId;_2e8=this.toOutsideLayerId(_2e8,!_2e7);return _2e8;};ProAtlasMapCtrl.prototype.getCurrentScale=function(){return this.getLayerScale(this.getCurrentLayerId(true),true);};ProAtlasMapCtrl.prototype.getCurrentMagnify=function(){return this.mapView.frontSheet.magnify;};ProAtlasMapCtrl.prototype.getLayerCount=function(_2e9){var _2ea=this.mapView.frontSheet.getCurrentPackage();var _2eb=_2ea.layerCollect.length;if(!_2e9){if(this.version=="v1"){_2eb=_layerScaleList.v1.length;}else{if(this.version=="v2"){}}}return _2eb;};ProAtlasMapCtrl.prototype.getLayerId=function(_2ec,mode,_2ee){var _2ef=this.mapView.frontSheet.getCurrentPackage().getLayerId(_2ec,mode);_2ef=this.toOutsideLayerId(_2ef,!_2ee);return _2ef;};ProAtlasMapCtrl.prototype.getLayerScale=function(_2f0,_2f1){var _2f2=_2f0;if(!_2f1){_2f2=this.toInsideLayerId(_2f0,!_2f1);}var _2f3=this.mapView.frontSheet.getCurrentPackage();return _2f3.getLayerScale(_2f2);};ProAtlasMapCtrl.prototype.getContainer=function(){return this.mapView.mapContainer;};ProAtlasMapCtrl.prototype.getCurrentVendor=function(){return this.mapView.frontSheet.vendor;};ProAtlasMapCtrl.prototype.getLayerScaleList=function(_2f4){if(_2f4==null){_2f4=this.mapView.frontSheet.packageId;}var ret=new Array;for(var i=0;i<this.layerScaleList[_2f4].length;++i){ret.push(this.layerScaleList[_2f4][i]);}return ret;};ProAtlasMapCtrl.prototype.asyncGetLayerScaleList=function(_2f7,_2f8,_2f9){if(_2f7==null){_2f7=this.mapView.frontSheet.packageId;}if(!this.mapView.ExistMapPackage(_2f7)){return;}var _2fa=this.getCurrentMapDatum();var _2fb=this;var _2fc=true;datumConvert(_2f8,this.datum,_2fa,"tokyo97",function(_2fd){if(_2fb.mapView.getMapPackage(_2f7).layerServerType=="callback"||_2fb.yahooMapLayerType=="callback"){_2fb.asyncGetLayerScaleListByJason(_2f7,_2fd,_2f9);}else{_2fb.asyncGetLayerScaleListByXMLHttp(_2f7,_2fd,_2f9);}});};ProAtlasMapCtrl.prototype.asyncGetLayerScaleListByXMLHttp=function(_2fe,_2ff,_300){var _301=AlpsUtil.getXMLHttp();if(!_301){return;}var _302="";if(this.yahooMapLayer){_302=this.yahooMapLayer;}else{_302=this.mapView.getMapPackage(_2fe).layerServerName;}var _303=this;_301.open("POST",_302,true);_301.onreadystatechange=function(){if(_301.readyState==4){var _304=new Array;if(_301.status==200&&_301.responseXML){if(_303.yahooMapLayer){var _305=_301.responseXML.getElementsByTagName("mappackage");for(var j=0;j<_305.length;++j){var _307=_305[j];if(_2fe!=_307.getAttribute("id")){continue;}var _308=AlpsUtil.getElementContent(_307,"layers");if(_308){var s=_308.split(",");for(var i=0;i<s.length;++i){_304.push(parseInt(s[i]));}}}}else{var _308=AlpsUtil.getElementContent(_301.responseXML,"layers");if(_308){var s=_308.split(",");for(var i=0;i<s.length;++i){_304.push(parseInt(s[i]));}}}}else{var _30b=_303.mapView.getMapPackage(_2fe).layerCollect;for(var i=0;i<_30b.length;++i){_304.unshift(_30b[i].scale);}}_300(_304);}};var doc=AlpsUtil.createXMLDOM();var _30d=doc.createElement("query");doc.appendChild(_30d);var _30e=doc.createElement("coordinates");_30d.appendChild(_30e);_30e.appendChild(doc.createTextNode(_2ff.toString()));_301.send(doc);};ProAtlasMapCtrl.prototype.asyncGetLayerScaleListByJason=function(_30f,_310,_311){var p=this.mapView.conv.m_center;var _313="";if(this.yahooMapLayer){_313=this.yahooMapLayer;}else{_313=this.mapView.getMapPackage(_30f).layerServerName;}if(!_313){return;}_313=_313+"?c="+_310.toString();var _314=this;_cb.send(_313,function(obj){var _316=new Array;if(obj!=undefined){var ary;if(_314.yahooMapLayer){ary=obj[_30f];}else{ary=obj;}if(ary){for(var i=0;i<ary.length;++i){_316.push(parseInt(ary[i].scale));}}else{var _319=_314.mapView.getMapPackage(_30f).layerCollect;for(var i=0;i<_319.length;++i){_316.unshift(_319[i].scale);}}}else{var _319=_314.mapView.getMapPackage(_30f).layerCollect;for(var i=0;i<_319.length;++i){_316.unshift(_319[i].scale);}}_311(_316);});};ProAtlasMapCtrl.prototype.setSize=function(_31a,_31b){if(_31a){this.mapView.mapContainer.style.width=_31a+"px";}if(_31b){this.mapView.mapContainer.style.height=_31b+"px";}this.mapView.resizeMapView();AlpsEvent.triggerEvent(this,"resize");};ProAtlasMapCtrl.prototype.resetCenter=function(){this.mapView.resizeMapView();AlpsEvent.triggerEvent(this,"resize");};ProAtlasMapCtrl.prototype.getProjOrigin=function(){var _31c=this.mapView.conv.getProjOrigin();return new LLPoint(_31c.lat,_31c.lon);};ProAtlasMapCtrl.prototype.getProjection=function(){var _31d=this.mapView.frontSheet.getCurrentPackage().layerCollect[this.mapView.frontSheet.layerId];var _31e;if(this.getCurrentVendor()!==2){var _31e=_31d.getProjInfoById(this.mapView.frontSheet.projId);}else{var _31e=_31d.projInfo_inc;}if(_31e.code==0){return 0;}else{if(_31e.subInfo==0){return 1;}else{return 2;}}};ProAtlasMapCtrl.prototype.getProjFactor=function(){var _31f=this.mapView.frontSheet.getCurrentPackage().layerCollect[this.mapView.frontSheet.layerId];var _320=_31f.getProjInfoById(this.mapView.frontSheet.projId);if(_320.code==0){return _320.subInfo;}else{return 0;}};ProAtlasMapCtrl.prototype.getSuitableScale=function(_321,_322){var _323=this.mapView.conv.m_windowWidth;var _324=this.mapView.conv.m_windowHeight;var _325=this.mapView.conv.LL2Meter(_321);var _326=this.mapView.conv.LL2Meter(_322);var _327=Math.abs(_326.x-_325.x);var _328=Math.abs(_326.y-_325.y);return Math.max(_327/_323*10*1000,_328/_324*10*1000);};ProAtlasMapCtrl.prototype.getSuitableLayerId=function(_329,_32a,_32b){var mode=1;return this.getLayerId(this.getSuitableScale(_329,_32a),mode,_32b);};ProAtlasMapCtrl.prototype.setVecHeimenVisible=function(_32d){var _32e=this.getCurrentMagnify();this.mapView.frontSheet.resetAllTiles();this.mapView.frontSheet.magnify=_32e;this.vectorOpe.visibleVecHeimen=_32d;var _32f=true;this.mapView.frontSheet.configureAllTiles(_32f);};ProAtlasMapCtrl.prototype.getVecHeimenVisible=function(){return this.vectorOpe.visibleVecHeimen;};ProAtlasMapCtrl.prototype.setVecTyukiVisible=function(_330){var _331=this.getCurrentMagnify();this.mapView.frontSheet.resetAllTiles();this.mapView.frontSheet.magnify=_331;this.vectorOpe.visibleVecTyuki=_330;var _332=true;this.mapView.frontSheet.configureAllTiles(_332);};ProAtlasMapCtrl.prototype.getVecTyukiVisible=function(){return this.vectorOpe.visibleVecTyuki;};ProAtlasMapCtrl.prototype.setVecRasterVisible=function(_333){var _334=this.getCurrentMagnify();this.mapView.frontSheet.resetAllTiles();this.mapView.frontSheet.magnify=_334;this.vectorOpe.visibleVecRaster=_333;var _335=true;this.mapView.frontSheet.configureAllTiles(_335);};ProAtlasMapCtrl.prototype.getVecRasterVisible=function(){return this.vectorOpe.visibleVecRaster;};ProAtlasMapCtrl.prototype.setVecSpecType=function(_336){var _337=this.getCurrentMagnify();this.mapView.frontSheet.resetAllTiles();this.mapView.frontSheet.magnify=_337;this.vectorOpe.vecSpecType=_336;var _338=true;this.mapView.frontSheet.configureAllTiles(_338);};ProAtlasMapCtrl.prototype.getVecSpecType=function(){return this.vectorOpe.vecSpecType;};ProAtlasMapCtrl.prototype.getVecSpecTypeList=function(_339,_33a){var _33b=this.mapView.getMapPackage(_339).layerCollect[_33a];var _33c=new Array;for(var i=0;i<_33b.specType.length;++i){var spec=new SpecType();spec.id=_33b.specType[i].id;spec.name=_33b.specType[i].name;_33c.push(spec);}return _33c;};ProAtlasMapCtrl.prototype.setVecSpecItemVisible=function(_33f,_340){if(_340){var _341=new Array;var _342=false;for(var i=0;i<this.vectorOpe.specHide.length;++i){if(this.vectorOpe.specHide[i]==_33f){_342=true;}else{_341.push(this.vectorOpe.specHide[i]);}}if(_342){var _344=this.getCurrentMagnify();this.mapView.frontSheet.resetAllTiles();this.mapView.frontSheet.magnify=_344;this.vectorOpe.specHide=_341;var _345=true;this.mapView.frontSheet.configureAllTiles(_345);}}else{var _342=false;for(var i=0;i<this.vectorOpe.specHide.length;++i){if(this.vectorOpe.specHide[i]==_33f){_342=true;break;}}if(!_342){var _344=this.getCurrentMagnify();this.mapView.frontSheet.resetAllTiles();this.mapView.frontSheet.magnify=_344;this.vectorOpe.specHide.push(_33f);var _345=true;this.mapView.frontSheet.configureAllTiles(_345);}}};ProAtlasMapCtrl.prototype.getVecSpecItemVisible=function(_346){for(var i=0;i<this.vectorOpe.specHide.length;++i){if(this.vectorOpe.specHide[i]==_346){return false;}}return true;};ProAtlasMapCtrl.prototype.getVecSpecItemList=function(_348,_349){var _34a=this.mapView.getMapPackage(_348).layerCollect[_349];var _34b=new Array;for(var i=0;i<_34a.specItem.length;++i){var item=new SpecItem();item.id=_34a.specItem[i].id;item.name=_34a.specItem[i].name;_34b.push(item);}return _34b;};ProAtlasMapCtrl.prototype.angleTo=function(_34e,_34f){if(this.getMapserverSrcType()!=2){return;}if(this.zoomTimerId!=0){return;}if(_34e>=360){_34e-=360;}else{if(_34e<0){_34e+=360;}}if(this.getCurrentAngle()==_34e){return;}this.stopSmoothCentering(_34f);this.stopFlightScroll(_34f);var _350=this.mapView.conv.m_center;var _351=this.mapView.frontSheet.packageId;var _352=this.mapView.frontSheet.layerId;var _353=this.mapView.frontSheet.magnify;var _354=true;var _355=false;this.mapView.backSheet.setCenterAndScale(_350,_351,_352,_353,_34e,_354,_355);this.mapView.flipSheet();AlpsEvent.triggerEvent(this,"angleChanged");};ProAtlasMapCtrl.prototype.getCurrentAngle=function(){return this.mapView.frontSheet.angle;};ProAtlasMapCtrl.prototype.smoothAngleTo=function(_356){if(this.getMapserverSrcType()!=2){return;}if(_bi.type!=1&&_bi.type!=2&&_bi.type!=3){this.angleTo(_356);return;}if(this.mapView.fadeinTimerId!=0){return;}if(this.zoomTimerId!=0){return;}if(_356>=360){_356-=360;}else{if(_356<0){_356+=360;}}if(_356==this.getCurrentAngle()){return;}this.stopSmoothCentering();this.stopFlightScroll();AlpsEvent.triggerEvent(this,"smoothAngleChanging",this.getCurrentAngle(),_356);var _357=this.mapView.conv.m_center;var _358=this.getCurrentPackageId();var _359=this.getCurrentLayerId(true);var _35a=this.mapView.frontSheet.magnify;var _35b=true;var _35c=true;this.mapView.backSheet.setCenterAndScale(_357,_358,_359,_35a,_356,_35b,_35c);this.mapView.fadeinFlipSheet("angle");};ProAtlasMapCtrl.prototype.getMapserverSrcType=function(){if(this.mapView.ExistMapPackage(this.getCurrentPackageId())){var _35d=this.mapView.frontSheet.getCurrentPackage().getNextMapserver(this.mapView.frontSheet.vendor);return _35d.sourceType;}else{return 1;}};ProAtlasMapCtrl.prototype.setVisible=function(_35e){this.mapView.frontSheet.setVisible(_35e);};ProAtlasMapCtrl.prototype.vendorTo=function(_35f){if(_35f==this.mapView.frontSheet.vendor){return;}this.stopSmoothCentering();this.stopFlightScroll();var _360="tokyo97";var _361=this.mapView.frontSheet.getCurrentPackage().layerCollect[this.getCurrentLayerId(true)];var _362=this.mapView.frontSheet.vendor;if(_362==1){var proj=_361.getProjInfoById(this.mapView.frontSheet.projId);_360=proj.datum;}else{if(_362==2){var proj=_361.projInfo_inc;_360=proj.datum;}}this.mapView.backSheet.setVisible(false);this.mapView.backSheet.resetAllTiles();var _364=this.mapView.conv.m_center;var _365=this.mapView.frontSheet.packageId;var _366=this.mapView.frontSheet.layerId;var _367=this.mapView.frontSheet.magnify;var _368=this.mapView.frontSheet.angle;var _369=true;var _36a=true;this.mapView.backSheet.setCenterAndScale(_364,_365,_366,_367,_368,_369,_36a,_35f,_360);this.mapView.flipSheet();AlpsEvent.triggerEvent(this,"vendorChanged");};ProAtlasMapCtrl.prototype.smoothVendorTo=function(_36b){if(_bi.type==4&&_bi.version<9){this.vendorTo(_36c);return;}if(this.mapView.fadeinTimerId!=0){this.mapView.stopFadeinFlipping();}if(_36b==this.mapView.frontSheet.vendor){return;}this.stopSmoothCentering();this.stopFlightScroll();var _36d="tokyo97";var _36e=this.mapView.frontSheet.getCurrentPackage().layerCollect[this.getCurrentLayerId(true)];var _36f=this.mapView.frontSheet.vendor;if(_36f==1){var proj=_36e.getProjInfoById(this.mapView.frontSheet.projId);_36d=proj.datum;}else{if(_36f==2){var proj=_36e.projInfo_inc;_36d=proj.datum;}}AlpsEvent.triggerEvent(this,"smoothVendorChanging",this.mapView.frontSheet.vendor,_36b);this.mapView.backSheet.setVisible(false);this.mapView.backSheet.resetAllTiles();var _371=this.mapView.conv.m_center;var _36c=this.mapView.frontSheet.packageId;var _372=this.mapView.frontSheet.layerId;var _373=this.mapView.frontSheet.magnify;var _374=this.mapView.frontSheet.angle;var _375=true;var _376=true;this.mapView.backSheet.setCenterAndScale(_371,_36c,_372,_373,_374,_375,_376,_36b,_36d);this.mapView.fadeinFlipSheet("vendor");};ProAtlasMapCtrl.prototype.getCurrentZoomLevel=function(){var _377=this.mapView.frontSheet.getCurrentPackage().layerCollect[this.getCurrentLayerId(true)];return _377.projInfo_inc!=undefined?_377.projInfo_inc.level:0;};ProAtlasMapCtrl.prototype.getCenterTileId=function(){var _378=this.mapView.conv.LL2Log(this.mapView.conv.getProjOrigin());var _379=_378.x*-1;var _37a=_378.y*-1;_37a*=-1;var _37b=_379+this.mapView.conv.m_windowWidth;var _37c=_37a-this.mapView.conv.m_windowHeight;var _37d=(_379+_37b)/2;var _37e=(_37c+_37a)/2;var _37f=new Point(Math.floor(_37d/this.mapView.frontSheet.tileSize.width),Math.floor(_37e/this.mapView.frontSheet.tileSize.height));return _37f;};ProAtlasMapCtrl.prototype.getYahooCopyright=function(){var _380=this.getCurrentPackageId();var _381=this.getCurrentScale();var _382=this.layerCodeList[_380];this.yahooCopyright="";for(var i=0;i<_382.length;++i){var _384=_382[i];if(_384.scale==_381){this.yahooCopyright=_384.copyright;break;}}return this.yahooCopyright;};ProAtlasMapCtrl.prototype.release=function(){if(_bi.type!=1){return;}_objrelease(this.vectorOpe,true);_objrelease(this.layerScaleList,true);_objrelease(this.layerCodeList,true);_objrelease(this);};
function Mapsvr(){}Mapsvr.POI=1;Mapsvr.LINE=2;Mapsvr.AREA=3;Mapsvr.CIRCLE=4;function MapsvrBase(){this.construct.apply(this,arguments);}MapsvrBase.prototype.construct=function(id,_2,_3,_4,_5){this.id=id;this.name=_2;this.pos=_3;this.cat=_4;this.popup=_5;this.status=0;};function MapsvrPOI(){this.construct.apply(this,arguments);}MapsvrPOI.prototype=new MapsvrBase();MapsvrPOI.prototype.construct=function(id,_7,_8,_9,_a,_b){MapsvrBase.prototype.construct.call(this,id,_7,_8,_9,_a);this.type=Mapsvr.POI;this.property=_b||new Object();};MapsvrPOI.prototype.constructor=MapsvrPOI;MapsvrPOI.prototype.release=function(){_objrelease(this.property,true);_objrelease(this);};function MapsvrLine(){this.construct.apply(this,arguments);}MapsvrLine.prototype=new MapsvrBase();MapsvrLine.prototype.construct=function(id,_d,_e,_f,_10,_11){MapsvrBase.prototype.construct.call(this,id,_d,_e,_f,_10);this.type=Mapsvr.LINE;this.points=_11||new Array();};MapsvrLine.prototype.constructor=MapsvrLine;MapsvrLine.prototype.release=function(){_objrelease(this);};function MapsvrArea(){this.construct.apply(this,arguments);}MapsvrArea.prototype=new MapsvrBase();MapsvrArea.prototype.construct=function(id,_13,pos,cat,_16,_17){MapsvrBase.prototype.construct.call(this,id,_13,pos,cat,_16);this.type=Mapsvr.AREA;this.points=_17||new Array();};MapsvrArea.prototype.constructor=MapsvrArea;MapsvrArea.prototype.release=function(){_objrelease(this);};function MapsvrCircle(id,_19,pos,_1b,cat){this.type=Mapsvr.CIRCLE;this.id=id;this.name=_19;this.pos=pos;this.radius=_1b;this.cat=cat;this.status=0;}MapsvrCircle.prototype.release=function(){_objrelease(this);};function MapsvrCollection(){this.construct();}MapsvrCollection.prototype.construct=function(){this._list=[];this._map={};};MapsvrCollection.prototype.destruct=function(){_objrelease(this._map,true);_objrelease(this);};MapsvrCollection.prototype.clear=function(){this._list=null;this._list=[];this._map=null;this._map={};};MapsvrCollection.prototype.add=function(_1d){var _1e=this._list;var map=this._map;var _20=_1d.id;if(!map[_20]){_1e.push(_1d);map[_20]=_1d;return _1e.length-1;}for(var i=0,len=_1e.length;i<len;i++){var c=_1e[i];if(c.id==_20){_1e.splice(i,1,_1d);map[_20]=_1d;return i;}}};MapsvrCollection.prototype.remove=function(_24){var _25=this._list;var map=this._map;if(!map[_24]){return -1;}for(var i=0,len=_25.length;i<len;i++){var c=_25[i];if(c.id==_24){_25.splice(i,1);if(map[_24]){delete map[_24];}return i;}}};MapsvrCollection.prototype.isEmpty=function(){return (this._list.length===0)?true:false;};MapsvrCollection.prototype.count=function(){return this._list.length;};MapsvrCollection.prototype.getList=function(){return this._list.slice(0);};MapsvrCollection.prototype.has=function(id){return (typeof this._map[id]!=="undefined")?true:false;};MapsvrCollection.prototype.get=function(id){return this._map[id];};MapsvrCollection.prototype.getAt=function(_2c){return this._list[_2c];};MapsvrCollection.prototype.forEach=function(_2d){if(typeof _2d!="function"){new typeError();}var _2e=this._list;var _2f=(arguments.length!==1)?arguments[1]:null;for(var i=0,len=_2e.length;i<len;i++){_2d.call(_2f,_2e[i]);}};function MapsvrCategoryCollection(){this.construct();}MapsvrCategoryCollection.prototype=new MapsvrCollection();MapsvrCategoryCollection.prototype.construct=function(){MapsvrCollection.prototype.construct.call(this);this._imageCache={};};MapsvrCategoryCollection.prototype.destruct=function(){_objrelease(this._imageCache,true);MapsvrCollection.prototype.destruct.call(this);};MapsvrCategoryCollection.prototype.constructor=MapsvrCategoryCollection;MapsvrCategoryCollection.prototype.addImageCache=function(id,_33,img){var _35=this._imageCache;if(!_35[id]){_35[id]={};}if(_35[id][_33]){_35[id][_33]=null;delete _35[id][_33];}_35[id][_33]=img;};MapsvrCategoryCollection.prototype.getImageCache=function(id,_37){var _38=this._imageCache;if(!_38[id]){_38[id]={};}return _38[id][_37];};MapsvrCategoryCollection.prototype.removeImageCache=function(id){var _3a=this._imageCache;if(_3a[id]){_3a[id]=null;delete _3a[id];}};function MapsvrPOICollection(){this.construct();}MapsvrPOICollection.prototype=new MapsvrCollection();MapsvrPOICollection.prototype.construct=function(){MapsvrCollection.prototype.construct.call(this);this._docs={};this._iconImages={};this._iconTimer={};this._labels={};};MapsvrPOICollection.prototype.destruct=function(){_objrelease(this._iconImages,true);MapsvrCollection.prototype.destruct.call(this);};MapsvrPOICollection.prototype.constructor=MapsvrPOICollection;MapsvrPOICollection.prototype.addIconImage=function(id,_3c,_3d){var _3e=this._iconImages;if(!_3e[id]){_3e[id]={};}if(_3e[id][_3c]){_3e[id][_3c]=null;delete _3e[id][_3c];}_3e[id][_3c]=_3d;};MapsvrPOICollection.prototype.getIconImage=function(id,_40){var _41=this._iconImages;if(!_41[id]){_41[id]={};}return _41[id][_40];};MapsvrPOICollection.prototype.removeIconImage=function(id){var _43=this._iconImages;if(_43[id]){_43[id]=null;delete _43[id];}};MapsvrPOICollection.prototype.clearIconImages=function(){this._iconImages=null;this._iconImages={};};MapsvrPOICollection.prototype.addIconTimer=function(id,t){var _46=this._iconTimer;if(_46[id]){_46[id]=null;delete _46[id];}_46[id]=t;};MapsvrPOICollection.prototype.getIconTimer=function(id){return this._iconTimer[id];};MapsvrPOICollection.prototype.removeIconTimer=function(id){var _49=this._iconTimer;if(_49[id]){_49[id]=null;delete _49[id];}};MapsvrPOICollection.prototype.clearIconTimer=function(){this._iconTimer=null;this._iconTimer={};};MapsvrPOICollection.prototype.addLabel=function(id,_4b){var _4c=this._labels;if(_4c[id]){_4c[id]=null;delete _4c[id];}_4c[id]=_4b;};MapsvrPOICollection.prototype.getLabel=function(id){return this._labels[id];};MapsvrPOICollection.prototype.removeLabel=function(id){var _4f=this._labels;if(_4f[id]){_4f[id]=null;delete _4f[id];}};MapsvrPOICollection.prototype.clearLabels=function(){this._labels=null;this._labels={};};MapsvrPOICollection.prototype.getSortedPOIList=function(_50){var _51=this._list.slice(0);if(_50){_51.sort(function(a,b){return a.pos.distance(_50)-b.pos.distance(_50);});}return _51;};MapsvrPOICollection.prototype.addDoc=function(id,doc){var _56=this._docs;if(_56[id]){_56[id]=null;delete _56[id];}_56[id]=doc;};MapsvrPOICollection.prototype.getDoc=function(id){return this._docs[id];};MapsvrPOICollection.prototype.removeDoc=function(id){var _59=this._docs;if(_59[id]){_59[id]=null;delete _59[id];}};MapsvrPOICollection.prototype.clearDocs=function(){this._docs=null;this._docs={};};MapsvrPOICollection.prototype.clear=function(){this.clearDocs();this.clearIconImages();this.clearLabels();MapsvrCollection.prototype.clear.call(this);};function MapsvrCategory(id,_5b,_5c,_5d){this.id=id;this.name=_5b;this.iconImage=_5c?[_5c]:new Array();this.iconSize=_5d?[_5d]:new Array();this.iconDiff=new Array();this.expandImage=new Array();this.expandSize=new Array();this.expandDiff=new Array();this.style=new Array();this.auto=true;}MapsvrCategory.prototype.release=function(){_objrelease(this);};function MapsvrCtrl(map,_5f,_60,opt){this.map=map;this.currentProjection=this.map.getProjection();this.loadParam(_5f,_60);this.source=new MapsvrCollection();this.POIContents=new MapsvrPOICollection();this.vectorContents=new MapsvrCollection();this.icon=new Array();this.opacity=100;this.popupId="popup";this.ptimer=null;this.ctimer=null;this.category=new Array();this.expand=true;this.popup=true;this.fixPopup=false;this.clickPopup=false;this.currentPopupId=null;this.searchOptimize=true;this.draggable=false;this.isAutoSearch=false;this.useDrawServer=false;this.useLabel=(opt&&opt.label===true);this.enableLabel=false;this.currentDragId=null;this.dragPos=null;this.threshold=null;this.canvas=null;this.canvasPos=null;this.canvasPixel=null;this.graphics=null;this.graphicsPos=null;this.queryParameter=new Array();this.resultProperty=new Object();this.add_source_stack=new Array();this.add_poi_stack=new Array();this.remove_source_stack=new Array();this.remove_poi_stack=new Array();this.use_stack=false;this.is_icon_hidden=false;this.width=map.getContainer().offsetWidth;this.height=map.getContainer().offsetHeight;AlpsEvent.addEvent(map,"mapMoving",_func(this,"mapMoving"));AlpsEvent.addEvent(map,"mapMoved",_func(this,"mapMoved"));AlpsEvent.addEvent(map,"layerChanged",_func(this,"layerChanged"));AlpsEvent.addEvent(map,"smoothLayerChanging",_func(this,"smoothLayerChanging"));AlpsEvent.addEvent(map,"magnifyChanged",_func(this,"magnifyChanged"));AlpsEvent.addEvent(map,"angleChanged",_func(this,"angleChanged"));AlpsEvent.addEvent(map,"smoothAngleChanging",_func(this,"smoothAngleChanging"));AlpsEvent.addEvent(map,"packageChanged",_func(this,"packageChanged"));AlpsEvent.addEvent(map,"resize",_func(this,"onResize"));AlpsEvent.addEvent(map,"mouseMove",_func(this,"onMouseMove"));}MapsvrCtrl.prototype.release=function(){if(_bi.type!=1){return;}_objrelease(this);};MapsvrCtrl.prototype.loadParam=function(_62,_63){if(typeof (_62)!="string"){return this.loadParamObject(_62);}this.contentsServer=null;this.drawServer=null;this.categoryList=new MapsvrCategoryCollection();var doc=null;if(_63=="string"){doc=AlpsUtil.getXMLDOMFromStr(_62);}else{doc=AlpsUtil.getXMLDOM(_62);}if(!doc){return;}var n=doc.getElementsByTagName("poi")[0];if(n){this.contentsServer=n.getAttribute("server");var _66=n.getElementsByTagName("popup")[0];if(_66){this.popupServer=_66.getAttribute("server");this.popupTemp=AlpsUtil.getNodeContent(_66);}var nl0=n.getElementsByTagName("category");for(var i=0;i<nl0.length;i++){var n0=nl0[i];var c=new MapsvrCategory(n0.getAttribute("id"),n0.getAttribute("name"));if(n0.getAttribute("auto")=="no"){c.auto=false;}var nl1=n0.childNodes;for(var j=0;j<nl1.length;j++){var n1=nl1[j];if(n1.nodeType!=1){continue;}if(n1.nodeName=="icon"){var s=parseInt(n1.getAttribute("status")||"0");c.iconImage[s]=n1.getAttribute("src");var w=parseInt(n1.getAttribute("width")||n1.getAttribute("size")||0);var h=parseInt(n1.getAttribute("height")||n1.getAttribute("size")||0);c.iconSize[s]={width:w,height:h};var dx=parseInt(n1.getAttribute("dx")||"0");var dy=parseInt(n1.getAttribute("dy")||"0");c.iconDiff[s]=new Point(dx,dy);}else{if(n1.nodeName=="expand"){var s=parseInt(n1.getAttribute("status")||"0");c.expandImage[s]=n1.getAttribute("src");var w=parseInt(n1.getAttribute("width")||n1.getAttribute("size")||0);var h=parseInt(n1.getAttribute("height")||n1.getAttribute("size")||0);if(w&&h){c.expandSize[s]={width:w,height:h};}var dx=parseInt(n1.getAttribute("dx")||"0");var dy=parseInt(n1.getAttribute("dy")||"0");c.expandDiff[s]=new Point(dx,dy);}}}this.addCategory(c);}}var n=doc.getElementsByTagName("shape")[0];if(n){this.drawServer=n.getAttribute("server");var nl0=n.getElementsByTagName("category");for(var i=0;i<nl0.length;i++){var n0=nl0[i];var c=new MapsvrCategory(n0.getAttribute("id"),n0.getAttribute("name"));var nl1=n0.childNodes;for(var j=0;j<nl1.length;j++){var n1=nl1[j];if(n1.nodeType!=1){continue;}if(n1.nodeName=="line"){var s=parseInt(n1.getAttribute("status")||"0");var _73=n1.getAttribute("style");c.style[s]=_73?("line:"+_73):"line";}else{if(n1.nodeName=="area"){var s=parseInt(n1.getAttribute("status")||"0");var _73=n1.getAttribute("style");c.style[s]=_73?("area:"+_73):"area";}else{if(n1.nodeName=="circle"){var s=parseInt(n1.getAttribute("status")||"0");var _73=n1.getAttribute("style");c.style[s]=_73?("circle:"+_73):"circle";}}}}this.addCategory(c);}}};MapsvrCtrl.prototype.getImageSize=function(img,_75){if(!_75.width){_75.width=img.width;}if(!_75.height){_75.height=img.height;}};MapsvrCtrl.prototype.loadParamObject=function(_76){this.contentsServer=_76.contentsServer;this.drawServer=null;this.categoryList=null;this.categoryList=new MapsvrCategoryCollection();for(var i=0;i<_76.catList.length;i++){var c=_76.catList[i];this.addCategory(new MapsvrCategory(c,_76.catName[c],_76.iconImage[c],_76.iconSize[c]));}};MapsvrCtrl.prototype.hasNoContents=function(){return (this.POIContents.isEmpty()&&this.vectorContents.isEmpty());};MapsvrCtrl.prototype.showCategories=function(cat,_7a){this.category=cat||new Array();if(_7a===true){this.use_stack=true;}if(this.contentsServer){this.findContents(true);}else{this.findContents();}};MapsvrCtrl.prototype.showAllCategories=function(_7b){this.category=new Array();var _7c=this.categoryList.getList();for(var i=0,len=_7c.length;i<len;i++){this.category.push(_7c[i].id);}if(_7b===true){this.use_stack=true;}if(this.contentsServer){this.findContents(true);}else{this.findContents();}};MapsvrCtrl.prototype.addCategory=function(c){for(var i=0;c.iconImage[i];i++){if(!c.iconSize[i]){c.iconSize[i]={width:0,height:0};}if(c.iconSize[i].width&&c.iconSize[i].height){continue;}var img=new Image();img.onload=_func(this,"getImageSize",img,c.iconSize[i]);img.src=c.iconImage[i];}if(this.categoryList.has(c.id)){this.categoryList.removeImageCache(c.id);}this.categoryList.add(c);};MapsvrCtrl.prototype.removeCategory=function(id){if(this.categoryList.has(id)){this.categoryList.remove(id);this.categoryList.removeImageCache(id);}};MapsvrCtrl.prototype.getCategoryList=function(){return this.categoryList.getList();};MapsvrCtrl.prototype.getCategory=function(id){return this.categoryList.get(id);};MapsvrCtrl.prototype.getPOIList=function(_84,_85){if(this.is_icon_hidden===true){return new Array();}var _86;if(_84!==true){_86=this.POIContents.getSortedPOIList(this.map.getCenterLatLon());}else{_86=this.POIContents.getList();}if(_85!==true){return _86;}var nw=new Point(0,0);var ne=new Point(this.width,0);var sw=new Point(0,this.height);var se=new Point(this.width,this.height);var _8b=[];for(var i=0,len=_86.length;i<len;i++){var poi=_86[i];var p=this.map.latLon2Log(poi.pos);if((p.x>nw.x&&p.y>nw.y)&&(p.x<ne.x&&p.y>ne.y)&&(p.x>sw.x&&p.y<sw.y)&&(p.x<se.x&&p.y<se.y)){_8b.push(poi);}}return _8b;};MapsvrCtrl.prototype.getContentsList=function(){return this.source.getList();};MapsvrCtrl.prototype.getContents=function(id){var _91;if(this.is_icon_hidden===false){_91=this.source.get(id);if(!_91){_91=this.POIContents.get(id);}return _91;}};MapsvrCtrl.prototype.addContents=function(_92,_93){var _94=(this.source.has(_92.id))?true:false;var i=this.source.add(_92);this.pointsConvert(_92);if(_93){if(!_94){this.add_source_stack.push(_92.id);}return;}else{if(!this.canvas){this.initCanvas();}}if(this.add_source_stack.length>0||this.remove_source_stack.length>0){if(this.contentsServer){this.findContents(true);}else{this.findContents();}return;}if(_92.type!==Mapsvr.POI){this.POIContents.remove(_92.id);this.vectorContents.add(_92);this.dispShape();}else{this.closePopup(true);if(_94){var doc=this.POIContents.getDoc(_92.id);if(doc){this.canvas.removeChild(doc);}doc=null;}if(this.category._indexOf(_92.cat)>=0){this.POIContents.add(_92);this.createIcon(_92.id);}if(!this.is_icon_hidden){AlpsEvent.triggerEvent(this,"POIListChanged");}}this.add_source_stack._clear();this.remove_source_stack._clear();if(this.isAutoSearch&&this.contentsServer){}};MapsvrCtrl.prototype.removeContents=function(id,_98){if(this.source.has(id)){var _99=this.source.get(id);var i=this.source.remove(id);}else{return;}if(_98){if(i!==-1){this.remove_source_stack.push(_99.id);}return;}else{if(!this.canvas){this.initCanvas();}}if(this.add_source_stack.length>0||this.remove_source_stack.length>0){if(this.contentsServer){this.findContents(true);}else{this.findContents();}return;}var doc=null;this.closePopup(true);if(_99.type==Mapsvr.POI){doc=this.POIContents.getDoc(id);this.POIContents.remove(id);this.POIContents.removeDoc(id);this.POIContents.removeIconImage(id);this.POIContents.removeLabel(id);if(!this.is_icon_hidden){AlpsEvent.triggerEvent(this,"POIListChanged");}}else{this.vectorContents.remove(id);}if(doc){this.canvas.removeChild(doc);}if(_99.type!=Mapsvr.POI){this.dispShape();}this.add_source_stack._clear();this.remove_source_stack._clear();doc=null;};MapsvrCtrl.prototype.clearContents=function(){this.source.clear();if(this.contentsServer){this.findContents(true);}else{this.findContents();}};MapsvrCtrl.prototype.addQueryParameter=function(_9c,_9d,_9e){this.removeQueryParameter(_9c);this.queryParameter.push({name:_9c,value:_9d,type:_9e});};MapsvrCtrl.prototype.removeQueryParameter=function(_9f){for(var i=0;i<this.queryParameter.length;i++){if(this.queryParameter[i].name==_9f){_objrelease(this.queryParameter[i]);this.queryParameter.splice(i,1);i--;}}};MapsvrCtrl.prototype.clearQueryParameter=function(){this.queryParameter._clear();};MapsvrCtrl.prototype.getResultProperty=function(_a1){return this.resultProperty[_a1];};MapsvrCtrl.prototype.setContentsStatus=function(id,_a3){if(!this.POIContents.has(id)&&!this.vectorContents.has(id)){var _a4=this.source.get(id);if(_a4){_a4.status=_a3;}return;}var c=this.POIContents.get(id);if(!c){c=this.vectorContents.get(id);if(c){c.status=_a3;this.dispShape();}return;}c.status=_a3;var doc=this.POIContents.getDoc(id);if(doc){this.canvas.removeChild(doc);this.createIcon(id);}};MapsvrCtrl.prototype.getIconElement=function(id){if(this.POIContents.has(id)&&this.is_icon_hidden===false){return this.POIContents.getIconImage(id,this.POIContents.get(id).status);}};MapsvrCtrl.prototype.setIconOpacity=function(_a8){this.opacity=_a8;this.POIContents.forEach(this.dispIcon,this);};MapsvrCtrl.prototype.getIconOpacity=function(){return this.opacity;};MapsvrCtrl.prototype.setEnableExpand=function(_a9){this.expand=_a9;};MapsvrCtrl.prototype.getEnableExpand=function(){return this.expand;};MapsvrCtrl.prototype.setEnablePopup=function(_aa){this.popup=_aa;};MapsvrCtrl.prototype.getEnablePopup=function(){return this.popup;};MapsvrCtrl.prototype.setIconThreshold=function(_ab){this.threshold=_ab;if(this.contentsServer&&!this.overThreshold()){this.findContents(true);return;}this.toggleIconThreshold();};MapsvrCtrl.prototype.getIconThreshold=function(){return this.threshold;};MapsvrCtrl.prototype.setEnableFixPopup=function(_ac){this.fixPopup=_ac;};MapsvrCtrl.prototype.getEnableFixPopup=function(){return this.fixPopup;};MapsvrCtrl.prototype.setEnableSearchOptimize=function(_ad){this.searchOptimize=_ad;};MapsvrCtrl.prototype.getEnableSearchOptimize=function(){return this.searchOptimize;};MapsvrCtrl.prototype.setEnableAutoSearch=function(_ae){this.isAutoSearch=_ae;};MapsvrCtrl.prototype.getEnableAutoSearch=function(){return this.isAutoSearch;};MapsvrCtrl.prototype.setEnableUseDrawServer=function(_af){this.useDrawServer=_af;};MapsvrCtrl.prototype.getEnableUseDrawServer=function(){return this.useDrawServer;};MapsvrCtrl.prototype.setEnableDraggableMode=function(_b0){this.draggable=_b0;};MapsvrCtrl.prototype.getEnableDraggableMode=function(){return this.draggable;};MapsvrCtrl.prototype.setEnableClickPopup=function(_b1){this.clickPopup=_b1;this.closePopup();if(this.clickPopupEvent){AlpsEvent.removeEvent(this.clickPopupEvent);this.clickPopupEvent=null;}if(this.clickPopup){this.clickPopupEvent=AlpsEvent.addEvent(this,"click",_func(this,"openPopup"));this.popup=false;this.fixPopup=true;}else{this.popup=true;this.fixPopup=false;}};MapsvrCtrl.prototype.getEnableClickPopup=function(){return this.clickPopup;};MapsvrCtrl.prototype.setEnableLabel=function(_b2){if(!this.useLabel){return;}var _b3=(this.enableLabel!==_b2)?true:false;this.enableLabel=_b2;if(_b3){this.labelDisplay=(this.enableLabel===true)?"block":"none";this.POIContents.forEach(this.changeLabelDisplay,this);delete this.labelDisplay;}};MapsvrCtrl.prototype.getEnableLabel=function(){return this.enableLabel;};MapsvrCtrl.prototype.openPopup=function(id,_b5){if(this.POIContents.has(id)){this.showPopup(id,_b5);}};MapsvrCtrl.prototype.closePopup=function(_b6){var e=this.hidePopup();this.currentPopupId=null;if(e){AlpsEvent.triggerEvent(this,"closePopup",_b6);}};MapsvrCtrl.prototype.overThreshold=function(){if(!this.map){return;}if(!this.threshold){return false;}return this.map.getCurrentScale()>this.threshold;};MapsvrCtrl.prototype.releaseContents=function(){this.POIContents.clear();this.vectorContents.clear();};MapsvrCtrl.prototype.findContents=function(_b8){if(this.draggable){this.currentDragId=null;this.dragPos=null;}if(this.use_stack===false){this.releaseContents();}this.resultProperty=new Object();if(!this.category.length){this.pourContents();this.showContents();if(!this.hasNoContents()&&!this.is_icon_hidden){AlpsEvent.triggerEvent(this,"POIListChanged");}return;}if(!_b8){this.pourContents();this.showContents();if(!this.hasNoContents()&&!this.is_icon_hidden){AlpsEvent.triggerEvent(this,"POIListChanged");}return;}if(!this.map){return;}var pos=new Array();pos.push(this.map.log2LatLon(new Point(0,0)));pos.push(this.map.log2LatLon(new Point(this.width,0)));pos.push(this.map.log2LatLon(new Point(this.width,this.height)));pos.push(this.map.log2LatLon(new Point(0,this.height)));var bl=pos[3],tr=pos[1];for(var i=0;i<pos.length;i++){if(pos[i].lat<bl.lat){bl.lat=pos[i].lat;}if(pos[i].lon<bl.lon){bl.lon=pos[i].lon;}if(pos[i].lat>tr.lat){tr.lat=pos[i].lat;}if(pos[i].lon>tr.lon){tr.lon=pos[i].lon;}}var ms=this;var _be=AlpsUtil.getXMLHttp();if(!_be){return;}_be.open("POST",this.contentsServer,true);_be.onreadystatechange=function(){if(_be.readyState==4&&_be.status==200){if(ms.use_stack===false){ms.releaseContents();}ms.resultProperty=new Object();var ver=parseFloat(_be.responseXML.documentElement.getAttribute("version")||"1.0");if(ver<2){var _c0=_be.responseXML.getElementsByTagName("poi");for(var i=0;i<_c0.length;i++){var _c2=AlpsUtil.getProperties(_c0[i]);_c2["identifier_uri"]=AlpsUtil.getElementAttribute(_c0[i],"identifier","uri");var id=_c2["iconid"];var _c4=AlpsUtil.getElementAttribute(_c0[i],"title","name");var cat=AlpsUtil.getElementAttribute(_c0[i],"category","xml:id");if(!cat){cat=AlpsUtil.getElementAttribute(_c0[i],"category","id");}if(!cat){cat=AlpsUtil.getElementAttribute(_c0[i],"category","type");}var _c6=_c0[i].getElementsByTagName("place")[0];var pos=AlpsUtil.getElementAttribute(_c6,"variation","placeID");var _c8=AlpsUtil.getElementContent(_c0[i],"popup");ms.POIContents.add(new MapsvrPOI(id,_c4,new LLPoint(pos),cat,_c8,_c2));}}else{var _c0=_be.responseXML.getElementsByTagName("poiarray");for(var i=0;i<_c0.length;i++){var _c2=AlpsUtil.getProperties(_c0[i]);var pos=_c2["DMS"];var cat=AlpsUtil.getElementAttribute(_c0[i],"category","xml:id");if(!cat){cat=AlpsUtil.getElementAttribute(_c0[i],"category","id");}var poi=_c0[i].getElementsByTagName("poi");var ids=new Array();var _cb=new Array();for(var j=0;j<poi.length;j++){var id=poi[j].getAttribute("xml:id");if(!id){id=poi[j].getAttribute("id");}if(id){ids.push(id);}var _cd=AlpsUtil.getElementAttribute(poi[j],"title","name");if(_cd){_cb.push(_cd);}}var poi=new MapsvrPOI(ids.join(","),_cb.join(","),new LLPoint(pos),cat,null,_c2);ms.POIContents.add(poi);}}var _ce=_be.responseXML.getElementsByTagName("properties")[0];if(_ce){ms.resultProperty=AlpsUtil.getProperties(_ce);}ms.pourContents();ms.showContents();if(!ms.hasNoContents()&&!ms.is_icon_hidden){AlpsEvent.triggerEvent(ms,"POIListChanged");}}};var doc=AlpsUtil.createXMLDOM();var _d0=doc.createElement("query");doc.appendChild(_d0);var _d1=doc.createElement("bottomleft");_d0.appendChild(_d1);_d1.appendChild(doc.createTextNode(bl));var _d2=doc.createElement("topright");_d0.appendChild(_d2);_d2.appendChild(doc.createTextNode(tr));for(var i=0;i<this.category.length;i++){var c=this.categoryList.get(this.category[i]);if(c&&c.style[0]){continue;}if(c&&!c.auto){continue;}var _d4=doc.createElement("category");_d4.appendChild(doc.createTextNode(this.category[i]));_d0.appendChild(_d4);}for(var i=0;i<this.queryParameter.length;i++){var p=this.queryParameter[i];var e=doc.createElement("parameter");_d0.appendChild(e);e.setAttribute("name",p.name);if(p.type=="text"){e.appendChild(doc.createTextNode(p.value));}else{if(p.type=="cdata"){e.appendChild(doc.createCDATASection(p.value));}else{e.setAttribute("value",p.value);}}}if(!doc.getElementsByTagName("category").length){this.pourContents();this.showContents();AlpsEvent.triggerEvent(this,"POIListChanged");return;}_be.setRequestHeader("Content-Type","text/xml");_be.send(doc);};MapsvrCtrl.prototype.pourContents=function(){if(this.category.length){if(this.use_stack===true){this.remove_poi_stack._clear();for(var i=0,len=this.remove_source_stack.length;i<len;i++){var id=this.remove_source_stack[i];if(this.POIContents.has(id)){this.remove_poi_stack.push(id);}else{if(this.vectorContents.has(id)){this.vectorContents.remove(id);}}}this.add_poi_stack._clear();for(var i=0,len=this.add_source_stack.length;i<len;i++){var id=this.add_source_stack[i];var _da=this.source.get(id);if(!_da){continue;}if(this.category._indexOf(_da.cat)>=0){if(_da.type===Mapsvr.POI){this.POIContents.add(_da);this.add_poi_stack.push(id);}else{this.vectorContents.add(_da);}}}}else{var _db;for(var i=0,len=this.source.count();i<len;i++){_db=this.source.getAt(i);if(this.category._indexOf(_db.cat)>=0){if(_db.type===Mapsvr.POI){this.POIContents.add(_db);}else{this.vectorContents.add(_db);}}}}}};MapsvrCtrl.prototype.showContents=function(){if(this.use_stack===true){this.closePopup(true);if(this.hasNoContents()){this.add_source_stack._clear();this.add_poi_stack._clear();this.remove_source_stack._clear();this.remove_poi_stack._clear();this.use_stack=false;this.removeCanvas();return;}if(!this.canvas){this.initCanvas();}for(var i=0,len=this.remove_poi_stack.length;i<len;i++){var _de=this.remove_poi_stack[i];var _df=this.POIContents.get(_de);if(!_df){continue;}var doc=this.POIContents.getDoc(_de);if(doc){this.canvas.removeChild(doc);}this.POIContents.remove(_de);this.POIContents.removeDoc(_de);this.POIContents.removeIconImage(_de);this.POIContents.removeLabel(_de);doc=null;}for(var i=0,len=this.add_poi_stack.length;i<len;i++){var _de=this.add_poi_stack[i];this.createIcon(_de);}}else{this.POIContents.clearIconImages();this.POIContents.clearLabels();this.closePopup(true);if(this.hasNoContents()){this.add_source_stack._clear();this.add_poi_stack._clear();this.remove_source_stack._clear();this.remove_poi_stack._clear();this.use_stack=false;this.removeCanvas();return;}this.clearCanvas();for(var i=0,len=this.POIContents.count();i<len;i++){var _df=this.POIContents.getAt(i);var t=this.POIContents.getIconTimer(_df.id);if(t){window.clearTimeout(t);this.POIContents.removeIconTimer(_df.id);}this.createIcon(_df.id);}}if(!this.vectorContents.isEmpty()){this.pointsConvert();this.dispShape();}else{if(this.graphics){this.graphics.innerHTML="";this.graphics.style.filter="";this.graphics.style.backgroundImage="";}}this.toggleIconThreshold();this.add_source_stack._clear();this.add_poi_stack._clear();this.remove_source_stack._clear();this.remove_poi_stack._clear();this.use_stack=false;};MapsvrCtrl.prototype.createIcon=function(id){var poi=this.POIContents.get(id);if(poi.type!=Mapsvr.POI){return;}if(!this.categoryList.has(poi.cat)){return;}var _e4=this.categoryList.get(poi.cat);var _e5;var _e6=_e4.iconImage[poi.status];var _e7=this.categoryList.getImageCache(poi.cat,poi.status);if(_e7&&_e7.src==_e6){_e5=_e7.cloneNode(true);}else{_e5=ImageMaker.createImg(_e6);_e5.style.cursor="pointer";_e5.style.zIndex=0;this.categoryList.addImageCache(poi.cat,poi.status,_e5);}_e5.onmouseover=_func(this,"expandIcon",id);poi.is_handler_set=false;var _e8=_e4.iconSize[poi.status]||{width:0,height:0};_e5.width=_e8.width;_e5.height=_e8.height;if(!this.docCache){var e=document.createElement("div");var s=e.style;s.position="absolute";s.cursor="default";if(_bi.type==1){e.unselectable="on";e.onselectstart=Nothing;}else{s.MozUserSelect="none";}this.docCache=e;}var doc=this.docCache.cloneNode(true);this.POIContents.addDoc(id,doc);this.POIContents.addIconImage(id,poi.status,_e5);this.dispIcon(poi);if(this.useLabel){var _ec=this.createLabel(poi,_e8);_ec.innerHTML=poi.name;this.POIContents.addLabel(id,_ec);}var _ed=this.resultProperty["order"];if(_ed=="reverse"){this.canvas.insertBefore(doc,this.canvas.firstChild);}else{if(_ed=="random"){var nl=this.canvas.childNodes;var idx=Math.floor(Math.random()*nl.length);this.canvas.insertBefore(doc,nl[idx]);}else{this.canvas.appendChild(doc);}}doc.appendChild(_e5);if(this.useLabel){doc.appendChild(_ec);}};MapsvrCtrl.prototype.createLabel=function(poi,_f1){var _f2=this.POIContents.getIconImage(poi.id,poi.status);var _f3=_f2.style;if(!_f2){return;}if(this.opacity==100){if(_bi.type==1){if(_bi.version!=6){_f3.filter="";}}}var e=this.POIContents.getLabel(poi.id);if(!e){e=this.createLabelElement();e.onmouseover=this.labelOver;e.onmouseout=this.labelOut;}var _f5=e.style;_f5.left=_f1.width+"px";_f5.display=(poi.name&&this.enableLabel===true)?"block":"none";return e;};MapsvrCtrl.prototype.createLabelElement=function(){if(!this.label_template){var e=document.createElement("div");var _f7=e.style;_f7.margin="0px";_f7.padding="1px";_f7.position="absolute";_f7.border="1px solid #999999";_f7.backgroundColor="#ffffff";_f7.opacity=0.7;_f7.MozOpacity=0.7;_f7.filter="alpha(opacity=70)";_f7.zIndex=0;_f7.fontFamily="sans-serif";_f7.fontSize="16px";_f7.cursor="default";_f7.whiteSpace="nowrap";if(_bi.type==1){e.unselectable="on";e.onselectstart=Nothing;}else{_f7.MozUserSelect="none";}this.label_template=e;}return this.label_template.cloneNode(true);};MapsvrCtrl.prototype.labelOver=function(e){e=(e?e:window.event);var t=e.srcElement||e.target;var _fa=t.style;_fa.opacity=1;_fa.MozOpacity=1;_fa.filter="alpha(opacity=100)";_fa.zIndex=1;};MapsvrCtrl.prototype.labelOut=function(e){e=(e?e:window.event);var t=e.srcElement||e.target;var _fd=t.style;_fd.opacity=0.7;_fd.MozOpacity=0.7;_fd.filter="alpha(opacity=70)";_fd.zIndex=0;};MapsvrCtrl.prototype.changeLabelDisplay=function(poi){var _ff=this.POIContents.getLabel(poi.id);if(!_ff){return;}if(poi.name){_ff.style.display=this.labelDisplay;}else{_ff.style.dispShape="none";}};MapsvrCtrl.prototype.triggerEvent=function(type,id,e){if(this.hasNoContents()){return;}if(this.draggable){if(type=="mouseDown"){this.currentDragId=id;this.dragPos=getRelativePos(e||window.event,this.map.getContainer());this.closePopup();}else{if(type=="mouseUp"){if(id==this.currentDragId){this.currentDragId=null;this.dragPos=null;AlpsEvent.triggerEvent(this,"iconMoved",id);}}}}AlpsEvent.triggerEvent(this,type,id);CancelBubble(e);};MapsvrCtrl.prototype.dispShape=function(){if(!this.graphics){return;}var ag=null;if(typeof (AlpsGraphics)!="undefined"){var g=this.createCanvas();this.map.getContainer().insertBefore(g,this.graphics);ag=new AlpsGraphics(g);if(!ag.type){this.map.getContainer().removeChild(g);ag=null;}else{this.map.getContainer().removeChild(this.graphics);this.graphics=g;}}if(!this.useDrawServer&&ag){ag.clear();var _105=2;for(var i=0,len=this.vectorContents.count();i<len;i++){var cnt=this.vectorContents.getAt(i);if(cnt.type==Mapsvr.POI){continue;}if(!this.categoryList.has(cnt.cat)){continue;}var _109=this.categoryList.get(cnt.cat).style[cnt.status];if(!_109){continue;}ag.setStrokeColor(0,0,255);ag.setStrokeOpacity(1);ag.setFillOpacity(0);var s=_109.split(":");for(var j=0;j<s.length;j++){if(!s[j].length){continue;}switch(j){case 1:ag.setStrokeColor(s[j]);break;case 2:ag.setStrokeOpacity(parseFloat(s[j]));break;case 3:_105=parseFloat(s[j]);break;case 4:ag.setFillColor(s[j]);ag.setFillOpacity(1);break;case 5:ag.setFillOpacity(parseFloat(s[j]));break;}}if(cnt.type==Mapsvr.CIRCLE){var p=this.map.latLon2Log(cnt.pos);var r=(cnt.radius>0)?(cnt.radius*10000/this.map.getCurrentScale()):(-cnt.radius);if(!this.isValidCircle(p,r)){continue;}ag.drawCircle(p,r,_105);}else{if(cnt.type==Mapsvr.AREA){var ss=new Array();var org=this.map.latLon2Log(this.map.getProjOrigin());for(var j=0;j<cnt.points.length;j++){ss.push(new Point(org.x+cnt.points[j].x,org.y+cnt.points[j].y));}if(!this.isValidArea(ss)){continue;}ag.drawArea(ss,_105);}else{if(cnt.type==Mapsvr.LINE){var ss=new Array();var org=this.map.latLon2Log(this.map.getProjOrigin());for(var j=0;j<cnt.points.length;j++){ss.push(new Point(org.x+cnt.points[j].x,org.y+cnt.points[j].y));}if(!this.isValidArea(ss)){continue;}ag.drawLine(ss,_105);}}}}this.graphicsPos=this.map.log2LatLon(new Point(0,0));this.moveContents();}else{if(this.drawServer){var bl=this.map.log2LatLon(new Point(0,this.height));var tr=this.map.log2LatLon(new Point(this.width,0));var url=this.drawServer+"?w="+this.width+"&h="+this.height+"&p="+this.makePath();var gp=this.map.log2LatLon(new Point(0,0));if(_bi.type==1){this.graphics.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+url+"')";this.graphicsPos=gp;this.moveContents();}else{var ms=this;var _115=null;var func=function(){if(_115){window.clearTimeout(_115);}if(ms.graphics){ms.graphics.style.backgroundImage="url("+url+")";ms.graphics.style.backgroundPosition="0px 0px";ms.graphics.style.backgroundRepeat="no-repeat";ms.graphicsPos=gp;}ms.moveContents();};var img=new Image();img.onload=func;_115=window.setTimeout(func,2000);img.src=url;}}else{this.graphics.innerHTML="";this.graphics.style.filter="";this.graphics.style.backgroundImage="";}}};MapsvrCtrl.prototype.makePath=function(){var ret=new Array();var _119=0;var _11a=null;for(var i=0,len=this.vectorContents.count();i<len;i++){var cnt=this.vectorContents.getAt(i);if(cnt.type==Mapsvr.POI){continue;}if(!this.categoryList.has(cnt.cat)){continue;}var _11e=this.categoryList.get(cnt.cat).style[cnt.status];if(!_11e){continue;}if(cnt.type==Mapsvr.CIRCLE){var p=this.map.latLon2Log(cnt.pos);var r=(cnt.radius>0)?(cnt.radius*10000/this.map.getCurrentScale()):(-cnt.radius);if(!this.isValidCircle(p,r)){continue;}if(_11e!=_11a){ret.push("s"+_11e);_11a=_11e;}var b=this.makeDword(Math.floor(p.x))+this.makeDword(Math.floor(p.y))+this.makeDword(Math.floor(r));ret.push("c"+b);}else{if(cnt.type==Mapsvr.AREA){var ss=new Array();var org=this.map.latLon2Log(this.map.getProjOrigin());for(var j=0;j<cnt.points.length;j++){ss.push(new Point(org.x+cnt.points[j].x,org.y+cnt.points[j].y));}if(!this.isValidArea(ss)){continue;}var s="";for(var j=0;j<ss.length;j++){if(j>0&&this.isSamePixel(ss[j-1],ss[j])){continue;}s+=this.makeDword(Math.floor(ss[j].x))+this.makeDword(Math.floor(ss[j].y));}var num=s.length/8;if(num<2){continue;}if(_11e!=_11a){ret.push("s"+_11e);_11a=_11e;}_119+=num;ret.push("a"+s);}else{if(cnt.type==Mapsvr.LINE){var s="";var ss=new Array();var pp=null;var pb=null;var org=this.map.latLon2Log(this.map.getProjOrigin());for(var j=0;j<cnt.points.length;j++){var p=new Point(org.x+cnt.points[j].x,org.y+cnt.points[j].y);var b=this.makeDword(Math.floor(p.x))+this.makeDword(Math.floor(p.y));if(pp&&!this.isSamePixel(pp,p)){if(this.isValidLine(pp,p)){if(pb){s+=pb;pb=null;}s+=b;}else{if(s){ss.push(s);s="";}pb=b;}}else{pb=b;}pp=p;}if(s){ss.push(s);s="";}if(ss.length){if(_11e!=_11a){ret.push("s"+_11e);_11a=_11e;}for(var j=0;j<ss.length;j++){var num=ss[j].length/8;if(num<2){continue;}_119+=num;ret.push("l"+ss[j]);}}}}}}var _129=null;if(_119>600){_129=0;var c=Math.ceil(_119/600);for(var i=0;i<ret.length;i++){if(ret[i].charAt(0)=="l"||ret[i].charAt(0)=="a"){var num=(ret[i].length-1)/8;var s=ret[i].charAt(0);for(var j=0;j<num;j++){if(j==0||j==num-1||j%c==0){s+=ret[i].substr(1+j*8,8);_129++;}}ret[i]=s;}}}var s="";for(var i=0;i<ret.length;i++){if(s){s+=",";}if(ret[i].charAt(0)=="s"){s+=":"+ret[i].substring(1);}else{if(ret[i].charAt(0)=="l"){s+=this.fake64encode(this.byterleComp(this.rearrange(ret[i].substring(1))));}else{if(ret[i].charAt(0)=="a"){s+=this.fake64encode(this.byterleComp(this.rearrange(ret[i].substring(1))));}else{if(ret[i].charAt(0)=="c"){s+=this.fake64encode(ret[i].substring(1));}}}}}return s;};MapsvrCtrl.prototype.isSamePixel=function(p1,p2){return Math.floor(p1.x)==Math.floor(p2.x)&&Math.floor(p1.y)==Math.floor(p2.y);};MapsvrCtrl.prototype.isValidLine=function(p1,p2){var _12f=20;var _130=-_12f;var _131=this.width+_12f;var mtop=-_12f;var _133=this.height+_12f;var left=Math.min(p1.x,p2.x);var _135=Math.max(p1.x,p2.x);var top=Math.min(p1.y,p2.y);var _137=Math.max(p1.y,p2.y);return (left<=_131)&&(top<=_133)&&(_135>=_130)&&(_137>=mtop);};MapsvrCtrl.prototype.isValidArea=function(_138){if(!_138.length){return false;}var _139=20;var _13a=-_139;var _13b=this.width+_139;var mtop=-_139;var _13d=this.height+_139;var left=null;var _13f=null;var top=null;var _141=null;for(var i=0;i<_138.length;i++){var p=_138[i];if(left==null||p.x<left){left=p.x;}if(_13f==null||p.x>_13f){_13f=p.x;}if(top==null||p.y<top){top=p.y;}if(_141==null||p.y>_141){_141=p.y;}}return (left<=_13b)&&(top<=_13d)&&(_13f>=_13a)&&(_141>=mtop);};MapsvrCtrl.prototype.isValidCircle=function(p,r){if(!r){return false;}var _146=20;var _147=-_146;var _148=this.width+_146;var mtop=-_146;var _14a=this.height+_146;var left=p.x-r;var _14c=p.x+r;var top=p.y-r;var _14e=p.y+r;return (left<=_148)&&(top<=_14a)&&(_14c>=_147)&&(_14e>=mtop);};MapsvrCtrl.prototype.makeDword=function(val){var ret="";for(var i=0;i<4;i++){var c=(val>>((3-i)*8))&255;if(val<0&&i==0){c=c|128;}ret+=String.fromCharCode(c);}return ret;};MapsvrCtrl.prototype.pointsConvert=function(c){if(!c){for(var i=0,len=this.source.count();i<len;i++){this.pointsConvert(this.source.getAt(i));}}else{if(c.type==Mapsvr.LINE||c.type==Mapsvr.AREA){var org=this.map.latLon2Log(this.map.getProjOrigin());c.points._clear();for(var i=0;i<c.pos.length;i++){var p=this.map.latLon2Log(c.pos[i]);c.points.push(new Point(p.x-org.x,p.y-org.y));}}}};MapsvrCtrl.prototype.dispIcon=function(poi){if(!this.map){return;}if(!poi){return;}if(poi.type!=Mapsvr.POI){return;}var icon=this.POIContents.getIconImage(poi.id,poi.status);var _15a=icon.style;var doc=this.POIContents.getDoc(poi.id);var _15c=doc.style;if(_bi.type==1){var _15d=_15a.filter;var _15e="alpha(opacity="+this.opacity+")";if(_15d){if(_15d.match(/(\(opacity=\d{0,3}\))/)){var now=RegExp.$1;_15a.filter=_15d.replace(now,"(opacity="+this.opacity+")");}else{_15a.filter=_15d+_15e;}}else{_15a.filter=_15e;}}else{_15a.opacity=this.opacity/100;_15a.MozOpacity=this.opacity/100;}var _160=this.categoryList.get(poi.cat);var d=_160.iconDiff[poi.status]||new Point(0,0);var p=this.map.latLon2Log(poi.pos);var cp=this.canvasPixel||new Point(0,0);var size=_160.iconSize[poi.status]||{width:0,height:0};if(this.expand&&_160.expandSize[poi.status]){var fx=size.width?icon.width/size.width:1;var fy=size.height?icon.width/size.height:1;_15c.left=(p.x-cp.x-icon.width/2+d.x*fx|0)+"px";_15c.top=(p.y-cp.y-icon.height/2+d.y*fy|0)+"px";}else{_15c.left=(p.x-cp.x-size.width/2+d.x|0)+"px";_15c.top=(p.y-cp.y-size.height/2+d.y|0)+"px";}};MapsvrCtrl.prototype.adjustIconLabel=function(poi){var icon=this.POIContents.getIconImage(poi.id,poi.status);var _169=icon.style;var doc=this.POIContents.getDoc(poi.id);var _16b=doc.style;var _16c=this.categoryList.get(poi.cat);var d=_16c.iconDiff[poi.status]||new Point(0,0);var p=this.map.latLon2Log(poi.pos);var cp=this.canvasPixel||new Point(0,0);var size=_16c.iconSize[poi.status]||{width:0,height:0};var _171;var _172;var _173;_171=size.width;_172=p.x-cp.x-size.width/2+d.x|0;_173=p.y-cp.y-size.height/2+d.y|0;_16b.left=_172+"px";_16b.top=_173+"px";};MapsvrCtrl.prototype.moveContentsLayerChanged=function(){var _174=(this.isAutoSearch&&this.contentsServer&&!this.overThreshold())?true:false;if(this.canvas&&this.canvasPos){this.canvasPixel=new Point(0,0);this.canvasPos=this.map.log2LatLon(new Point(0,0));this.canvas.style.left="0px";this.canvas.style.top="0px";}if(_174){this.clearCanvas();}else{this.POIContents.forEach(this.adjustIconLabel,this);}if(!this.vectorContents.isEmpty()){this.dispShape();}else{if(this.graphics){this.graphics.innerHTML="";this.graphics.style.filter="";this.graphics.style.backgroundImage="";}}if(this.is_layer_change===true){this.canvas.style.display="block";this.is_layer_change=false;}if(_174){this.findContents(true);return;}this.toggleIconThreshold();if(!this.hasNoContents()&&!this.is_icon_hidden){AlpsEvent.triggerEvent(this,"POIListChanged");}};MapsvrCtrl.prototype.toggleIconThreshold=function(){if(!this.canvas){this.initCanvas();}if(this.overThreshold()){if(this.is_icon_hidden===false){this.canvas.style.display="none";this.is_icon_hidden=true;AlpsEvent.triggerEvent(this,"POIListChanged");}}else{if(this.is_icon_hidden===true){this.canvas.style.display="block";this.is_icon_hidden=false;}}};MapsvrCtrl.prototype.moveContents=function(){if(this.graphics&&this.graphicsPos){var p=this.map.latLon2Log(this.graphicsPos);this.graphics.style.width=this.width+"px";this.graphics.style.height=this.height+"px";this.graphics.style.left=Math.floor(p.x)+"px";this.graphics.style.top=Math.floor(p.y)+"px";}if(this.canvas&&this.canvasPos){var p=(this.canvasPixel=this.map.latLon2Log(this.canvasPos));this.canvas.style.left=Math.floor(p.x)+"px";this.canvas.style.top=Math.floor(p.y)+"px";}};MapsvrCtrl.prototype.moveContentsRedrawShape=function(){this.closePopup(true);this.moveContents();this.dispShape();};MapsvrCtrl.prototype.resizeCanvas=function(){if(this.canvas){this.canvas.style.width=this.width+"px";this.canvas.style.height=this.height+"px";this.canvas.style.left="0px";this.canvas.style.top="0px";this.canvasPixel=new Point(0,0);this.canvasPos=this.map.log2LatLon(new Point(0,0));}};MapsvrCtrl.prototype.createCanvas=function(){var e=document.createElement("div");e.style.position="absolute";e.style.display="block";e.style.width=this.width+"px";e.style.height=this.height+"px";e.style.left="0px";e.style.top="0px";e.oncontextmenu=Nothing;return e;};MapsvrCtrl.prototype.initCanvas=function(){if(!this.graphics){this.graphics=this.createCanvas();this.map.getContainer().appendChild(this.graphics);}if(!this.canvas){this.canvas=this.createCanvas();this.map.getContainer().appendChild(this.canvas);}this.resizeCanvas();};MapsvrCtrl.prototype.clearCanvas=function(){this.initCanvas();this.canvas.innerHTML="";};MapsvrCtrl.prototype.removeCanvas=function(){if(this.graphics){this.map.getContainer().removeChild(this.graphics);this.graphics=null;}if(this.canvas){this.map.getContainer().removeChild(this.canvas);this.canvas=null;}};MapsvrCtrl.prototype.onClick=function(id){var ms=this;return function(e){if(ms.POIContents.isEmpty()){return;}AlpsEvent.triggerEvent(ms,"click",id);CancelBubble(e);};};MapsvrCtrl.prototype.expandIcon=function(id){if(this.POIContents.isEmpty()){return;}var poi=this.POIContents.get(id);var icon=this.POIContents.getIconImage(id,poi.status);if(!poi.is_handler_set){icon.onclick=_func(this,"triggerEvent","click",id);icon.onmousedown=_func(this,"triggerEvent","mouseDown",id);icon.onmouseup=_func(this,"triggerEvent","mouseUp",id);icon.ondblclick=_func(this,"triggerEvent","dblclick",id);icon.onmouseout=_func(this,"deflateIcon",id);poi.is_handler_set=true;}icon.style.zIndex=1;if(this.expand){var t=this.POIContents.getIconTimer(id);window.clearTimeout(t);t=window.setTimeout(_func(this,"gidle",id,true),20);this.POIContents.addIconTimer(id,t);if(!this.fixPopup){this.closePopup();}}else{if(this.popup){this.showPopup(id);}}AlpsEvent.triggerEvent(this,"mouseOver",id);};MapsvrCtrl.prototype.deflateIcon=function(id){if(this.POIContents.isEmpty()){return;}if(this.draggable&&this.currentDragId==id){return;}var icon=this.POIContents.getIconImage(id,this.POIContents.get(id).status);icon.style.zIndex=0;if(this.expand){var t=this.POIContents.getIconTimer(id);if(t){window.clearTimeout(t);}t=window.setTimeout(_func(this,"gidle",id,false),20);this.POIContents.addIconTimer(id,t);}if(!this.fixPopup){this.ptimer=window.setTimeout(_func(this,"closePopup",false),10);}AlpsEvent.triggerEvent(this,"mouseOut",id);};MapsvrCtrl.prototype.gidle=function(id,xp){if(!this.POIContents.has(id)){return;}if(this.is_layer_change){return;}var poi=this.POIContents.get(id);var c=poi.cat;var s=poi.status;var _186=this.categoryList.get(c);var _187=_186.iconSize[s]||{width:0,height:0};var _188=_186.expandSize[s]||_187;var _189=_187.width;var _18a=_187.height;var _18b=Math.max(_187.width,_188.width);var _18c=Math.max(_187.height,_188.height);var dw=Math.ceil((_18b-_189)/8);var dh=Math.ceil((_18c-_18a)/8);var _18f=this.POIContents.getIconImage(id,poi.status);var _190=_18f.width+(xp?dw:-dw);var _191=_18f.height+(xp?dh:-dh);if(xp&&_190>=_18b){_190=_18b;}else{if(!xp&&_190<=_189){_190=_189;}}if(xp&&_191>=_18c){_191=_18c;}else{if(!xp&&_191<=_18a){_191=_18a;}}var _192=_186.iconImage[s];var _193=_186.expandImage[s]||_192;var _194=_186.iconDiff[s]||new Point(0,0);var _195=_186.expandDiff[s]||new Point(0,0);var d=new Point(0,0);var fw=1,fh=1;var dx=Math.ceil((_195.x-_194.x)/8);var dy=Math.ceil((_195.y-_194.y)/8);if(_190<(_18b+_189)/2){_18f.src=_192;d=_194;fw=_190/_189;}else{if(_190==(_18b+_189)/2){if(xp){_18f.src=_193;d=_195;fw=_190/_18b;}else{_18f.src=_192;d=_194;fw=_190/_189;}}else{_18f.src=_193;d=_195;fw=_190/_18b;}}if(_191<(_18c+_18a)/2){_18f.src=_192;d=_194;fh=_191/_18a;}else{if(_191==(_18c+_18a)/2){if(xp){_18f.src=_193;d=_195;fh=_191/_18c;}else{_18f.src=_192;d=_194;fh=_191/_18a;}}else{_18f.src=_193;d=_195;fh=_191/_18c;}}if(_18f.width!=_190||_18f.height!=_191){_18f.width=_190;_18f.height=_191;var _19b=this.map.latLon2Log(poi.pos);var cp=this.canvasPixel||new Point(0,0);var _19d=_18f.style;var _19e=(_bi.type===1&&_bi.version<=6&&_18f.src.match(/\.(png)$/i));var _19f=(_bi.type===1&&_19d.filter.match(/sizingMethod='image'/));if(xp){_19d.left=parseFloat(_19d.left)-(dw/2)+dx+"px";_19d.top=parseFloat(_19d.top)-(dh/2)+dy+"px";if(_19e&&_19f){var _1a0=_19d.filter;_19d.filter=_1a0.replace(/sizingMethod='image'/,"sizingMethod='scale'");}}else{_19d.left=parseFloat(_19d.left)+(dw/2)-dx+"px";_19d.top=parseFloat(_19d.top)+(dh/2)-dy+"px";if(_19e&&_19f){var _1a0=_19d.filter;_19d.filter=_1a0.replace(/sizingMethod='image'/,"sizingMethod='scale'");}}}if(typeof ImageMaker.createImgNoAlpha=="undefined"){_AlphaImageLoader(_18f,_18f.width,_18f.height);}if((xp&&_190<_18b)||(!xp&&_190>_189)||(xp&&_191<_18c)||(!xp&&_191>_18a)){var t=window.setTimeout(_func(this,"gidle",id,xp),5);this.POIContents.addIconTimer(id,t);}else{if(xp&&this.popup){this.showPopup(id);}else{if(this.fixPopup){this.showPopup(this.currentPopupId);}}}};MapsvrCtrl.prototype.hidePopup=function(){window.clearTimeout(this.ptimer);var a=[this.popupId,this.popupId+"_topleft",this.popupId+"_topright",this.popupId+"_bottomleft",this.popupId+"_bottomright"];var e=false;for(var i=0;i<a.length;i++){var p=document.getElementById(a[i]);if(p){if(p.style.display!="none"){p.style.display="none";e=true;}}}return e;};MapsvrCtrl.prototype.showPopup=function(id,_1a7){if(!this.map){return;}if(this.draggable&&this.currentDragId==id){return;}var _1a8=true;if(!id){_1a8=false;id=this.currentPopupId;if(!id){return;}}else{if(this.currentPopupId){if(_1a7===true||id!==this.currentPopupId){this.closePopup();}else{_1a8=false;}}}this.currentPopupId=id;var c=this.POIContents.get(id);if(!c.popup){if(!this.popupServer){return;}if(this.source.has(id)){c=this.source.get(id);}else{return;}}var i=this.POIContents.getIconImage(id,this.POIContents.get(id).status);if(i.style.display=="none"){return;}window.clearTimeout(this.ptimer);var _1ab=this.map.latLon2Log(c.pos);var type="";if(_1ab.y<this.height/3){if(_1ab.x<this.width/2){type="bottomright";}else{type="bottomleft";}}else{if(_1ab.x<this.width/2){type="topright";}else{type="topleft";}}var p=document.getElementById(this.popupId+"_"+type);if(!p){p=document.getElementById(this.popupId);}if(!p){p=document.createElement("div");p.id=this.popupId;p.style.display="none";p.style.backgroundColor="#eef";p.style.color="#000";p.style.borderStyle="solid";p.style.borderColor="#000";p.style.borderWidth="1px 2px 2px 1px";p.style.fontSize="11px";p.style.padding="1px 2px";p.innerHTML="<span id=\"popup_message\"></span>";document.body.appendChild(p);}p.style.position="absolute";var _1ae=this.map.getContainer();if(_1ae.style.zIndex){p.style.zIndex=_1ae.style.zIndex+1;}else{p.style.zIndex=1;}var ms=this;var pm=document.getElementById(p.id+"_message");if(pm){if(c.popup){pm.innerHTML=c.popup;}else{if(this.popupServer){var _1b1=AlpsUtil.getXMLHttp();if(_1b1){_1b1.open("POST",this.popupServer,true);_1b1.onreadystatechange=function(){if(_1b1.readyState==4&&_1b1.status==200){c.popup=_1b1.responseText;if(c.popup){ms.showPopup(ms.currentPopupId);}}};var doc=AlpsUtil.createXMLDOM();var _1b3=doc.createElement("query");doc.appendChild(_1b3);var ids=c.id.split(/,/);for(var j=0;j<ids.length;j++){var id=doc.createElement("id");_1b3.appendChild(id);id.appendChild(doc.createTextNode(ids[j]));}_1b1.setRequestHeader("Content-Type","text/xml");_1b1.send(doc);if(this.popupTemp){pm.innerHTML=this.popupTemp;}else{return;}}}}}var pc=document.getElementById(p.id+"_close");if(pc){pc.onclick=function(){ms.closePopup();};}p.onmouseover=function(){window.clearTimeout(ms.ptimer);};p.onmouseout=function(){window.clearTimeout(ms.ptimer);if(!ms.fixPopup){ms.ptimer=window.setTimeout(_func(ms,"closePopup",false),10);}};var pos=(p.getAttribute("pos")||"right:top").split(":");var dx=parseInt(p.getAttribute("dx")||"0");var dy=parseInt(p.getAttribute("dy")||"0");var op=getObjPos3(i);if(p.parentNode==this.map.getContainer()){p.style.zIndex=2;var func=function(e){if(!e){e=window.event;}e.cancelBubble=true;};p.onmousedown=func;p.onmouseup=func;p.onclick=func;op=getObjPos(i,this.map.getContainer());}p.style.visibility="hidden";p.style.left=p.style.right=p.style.top=p.style.bottom="";p.style.display="block";var pw=p.offsetWidth;var ph=p.offsetHeight;if(pos[0]=="top"){p.style.top=Math.floor(op.y-ph+dy)+"px";}else{if(pos[0]=="bottom"){p.style.top=Math.floor(op.y+i.height+dy)+"px";}else{if(pos[0]=="left"){p.style.left=Math.floor(op.x-pw+dx)+"px";}else{if(pos[0]=="right"){p.style.left=Math.floor(op.x+i.width+dx)+"px";}}}}if(pos[1]=="top"){p.style.top=Math.floor(op.y+dy)+"px";}else{if(pos[1]=="bottom"){p.style.top=Math.floor(op.y+i.height-ph+dy)+"px";}else{if(pos[1]=="left"){p.style.left=Math.floor(op.x+dx)+"px";}else{if(pos[1]=="right"){p.style.left=Math.floor(op.x+i.width-pw+dx)+"px";}else{if(pos[1]=="ctop"){p.style.top=Math.floor(op.y+i.height/2+dy)+"px";}else{if(pos[1]=="cbottom"){p.style.top=Math.floor(op.y+i.height/2-ph+dy)+"px";}else{if(pos[1]=="cleft"){p.style.left=Math.floor(op.x+i.width/2+dx)+"px";}else{if(pos[1]=="cright"){p.style.left=Math.floor(op.x+i.width/2-pw+dx)+"px";}}}}}}}}p.style.visibility="visible";if(_1a8){AlpsEvent.triggerEvent(this,"openPopup",c.id);}};MapsvrCtrl.prototype.fake64encode=function(str){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@/";var len=str.length;var ret="";for(var i=0;i<len;){var c1=str.charCodeAt(i++)&255;if(i==len){ret+=b64.charAt(c1>>2);ret+=b64.charAt((c1&3)<<4);break;}var c2=str.charCodeAt(i++);if(i==len){ret+=b64.charAt(c1>>2);ret+=b64.charAt(((c1&3)<<4)|((c2&240)>>4));ret+=b64.charAt((c2&15)<<2);break;}var c3=str.charCodeAt(i++);ret+=b64.charAt(c1>>2);ret+=b64.charAt(((c1&3)<<4)|((c2&240)>>4));ret+=b64.charAt(((c2&15)<<2)|((c3&192)>>6));ret+=b64.charAt(c3&63);}return ret;};MapsvrCtrl.prototype.rearrange=function(str){var ret="";for(var i=0;i<4;i++){for(var j=0;j<2;j++){for(var k=0;k<str.length/8;k++){ret+=str.charAt(k*8+j*4+i);}}}return ret;};MapsvrCtrl.prototype.byterleComp=function(str){var _1cd=192;var _1ce=(_1cd+3);var _1cf=(256-_1cd);switch(str.length){case 0:return "";case 1:return String.fromCharCode(1+_1cd)+str;}var ret="";var _1d1=str.length;var _1d2="";for(var _1d3=0;_1d3<_1d1;){var _1d4=_1d1-_1d3;if(_1d4>_1ce){_1d4=_1ce;}var cnt=0;for(var i=1;i<_1d4;i++){if(str.charCodeAt(_1d3)==str.charCodeAt(_1d3+i)){cnt=i+1;}else{break;}}if(cnt<3){_1d2+=str.charAt(_1d3++);if(_1d2.length>=(_1cf-1)){ret+=String.fromCharCode(_1d2.length+_1cd)+_1d2;_1d2="";}}else{if(_1d2){ret+=String.fromCharCode(_1d2.length+_1cd)+_1d2;_1d2="";}ret+=String.fromCharCode(cnt-3)+str.charAt(_1d3);_1d3+=cnt;}}if(_1d2){ret+=String.fromCharCode(_1d2.length+_1cd)+_1d2;}return ret;};MapsvrCtrl.prototype.mapMoving=function(){if(this.ctimer){window.clearTimeout(this.ctimer);}this.hidePopup();this.moveContents();this.showPopup(null);};MapsvrCtrl.prototype.mapMoved=function(){if(this.ctimer){window.clearTimeout(this.ctimer);}if(this.isAutoSearch&&this.contentsServer&&!this.overThreshold()){if(_delaytime>0){this.ctimer=window.setTimeout(_func(this,"findContents",true),_delaytime);}else{this.findContents(true);}}else{if(_delaytime>0){this.ctimer=window.setTimeout(_func(this,"moveContentsRedrawShape"),_delaytime);}else{this.moveContentsRedrawShape();}}};MapsvrCtrl.prototype.layerChanged=function(){this.pointsConvert();if(this.ctimer){window.clearTimeout(this.ctimer);}if(_delaytime>0){this.ctimer=window.setTimeout(_func(this,"moveContentsLayerChanged"),_delaytime);}else{this.moveContentsLayerChanged();}};MapsvrCtrl.prototype.smoothLayerChanging=function(){if(this.ctimer){window.clearTimeout(this.ctimer);}this.closePopup(true);if(!this.POIContents.isEmpty()||!this.source.isEmpty()){if(!this.is_layer_change&&this.canvas.style.display=="block"){this.is_layer_change=true;this.canvas.style.display="none";if(this.graphics&&!this.vectorContents.isEmpty()){this.graphics.style.display="none";}}}};MapsvrCtrl.prototype.magnifyChanged=function(){this.pointsConvert();if(this.ctimer){window.clearTimeout(this.ctimer);}var _1d7=(this.contentsServer&&!this.overThreshold())?true:false;if(_delaytime>0){this.ctimer=window.setTimeout(_func(this,"findContents",_1d7),_delaytime);}else{this.findContents(_1d7);}};MapsvrCtrl.prototype.angleChanged=function(){this.pointsConvert();if(this.ctimer){window.clearTimeout(this.ctimer);}if(_delaytime>0){this.ctimer=window.setTimeout(_func(this,"findContents"),_delaytime);}else{this.findContents();}};MapsvrCtrl.prototype.smoothAngleChanging=function(){if(this.ctimer){window.clearTimeout(this.ctimer);}if(!this.hasNoContents()){this.releaseContents();this.showContents();}};MapsvrCtrl.prototype.packageChanged=function(){this.pointsConvert();};MapsvrCtrl.prototype.onResize=function(){this.width=this.map.getContainer().offsetWidth;this.height=this.map.getContainer().offsetHeight;if(this.canvas){this.moveContents();this.resizeCanvas();this.POIContents.forEach(this.adjustIconLabel,this);if(!this.vectorContents.isEmpty()){this.dispShape();}}if(this.contentsServer&&!this.overThreshold()){this.findContents(true);}else{if(!this.hasNoContents()&&!this.is_icon_hidden){AlpsEvent.triggerEvent(this,"POIListChanged");}}};MapsvrCtrl.prototype.onMouseMove=function(p){if(!this.draggable||!this.currentDragId||!this.dragPos){return;}var pos=this.map.latLon2Log(p);var c=this.POIContents.get(this.currentDragId);if(!c){return;}var p=this.map.latLon2Log(c.pos);p.x+=pos.x-this.dragPos.x;p.y+=pos.y-this.dragPos.y;var llp=this.map.log2LatLon(p);c.pos=llp;var _1dc=this.source.get(c.id);if(_1dc){_1dc.pos=llp;}this.dragPos=pos;this.adjustIconLabel(c);AlpsEvent.triggerEvent(this,"iconMoving",c.id);};function getObjPos3(obj){var p=new Point(0,0);if(obj.parentNode===null||obj.style.display=="none"){return p;}var _1df=null;if(obj.getBoundingClientRect){var box=obj.getBoundingClientRect();var _1e1=Math.max(document.documentElement.scrollTop,document.body.scrollTop);var _1e2=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);return new Point(box.left+_1e2,box.top+_1e1);}else{if(document.getBoxObjectFor){var box=document.getBoxObjectFor(obj);p=new Point(box.x,box.y);}else{p=new Point(obj.offsetLeft,obj.offsetTop);_1df=obj.offsetParent;if(_1df!=obj){while(_1df){p.x+=_1df.offsetLeft;p.y+=_1df.offsetTop;_1df=_1df.offsetParent;}}}}if(obj.parentNode){_1df=obj.parentNode;}else{_1df=null;}while(_1df&&_1df.tagName!="BODY"&&_1df.tagName!="HTML"){p.x-=_1df.scrollLeft;p.y-=_1df.scrollTop;if(_1df.parentNode){_1df=_1df.parentNode;}else{_1df=null;}}return p;}function _func(obj,name){var _1e5=new Array();for(var i=2;i<arguments.length;i++){_1e5.push(arguments[i]);}return function(){var args=new Array();for(var i=0;i<_1e5.length;i++){args.push(_1e5[i]);}for(var i=0;i<arguments.length;i++){args.push(arguments[i]);}obj[name].apply(obj,args);};}
function DatumConv(){this.server=null;this.current=null;this.waitlist=new Array();this.waitlist.lock=false;this.cache={length:0};this._datum_exists_mesh=new Array(3622,3623,3624,3724,3725,3831,3926,3927,3928,3942,4027,4028,4042,4128,4129,4142,4229,4230,4329,4429,4529,4530,4531,4629,4630,4631,4728,4729,4730,4731,4828,4829,4830,4831,4839,4928,4929,4930,4931,4932,4933,4934,4939,5029,5030,5031,5032,5033,5034,5035,5036,5039,5129,5130,5131,5132,5133,5134,5135,5136,5137,5138,5139,5229,5231,5232,5233,5234,5235,5236,5237,5238,5239,5240,5332,5333,5334,5335,5336,5337,5338,5339,5340,5432,5433,5435,5436,5437,5438,5439,5440,5536,5537,5538,5539,5540,5541,5636,5637,5638,5639,5640,5641,5738,5739,5740,5741,5839,5840,5841,5842,5939,5940,5941,5942,6039,6040,6041,6139,6140,6141,6239,6240,6241,6243,6339,6340,6341,6342,6343,6439,6440,6441,6442,6443,6444,6445,6540,6541,6542,6543,6544,6545,6641,6642,6643,6644,6645,6741,6742,6840,6841,6842);}DatumConv.prototype.getParam=function(p,_2,_3){if(!this.server){return _2();}this.bilinear(p,function(dB,dL){_2(dB,dL);},_3);};DatumConv.prototype.getRevParam=function(p,_7,_8){if(!this.server){return _7();}var _9=new LLPoint(p.lat-12/3600,p.lon+12/3600);this.bilinear(_9,function(dB,dL){if(arguments.length){var _c=new LLPoint(p.lat-dB,p.lon-dL);_dc.bilinear(_c,function(dB,dL){_7(dB,dL);},_8);}else{_7();}},_8);};DatumConv.prototype.bilinear=function(p,_10,_11){var mc=p.getMeshCode();this.send(mc,function(c,n,e,ne){if(c&&n&&e&&ne){var mi=[Math.floor(mc/1000000),Math.floor(mc/10000)%100,Math.floor(mc/1000)%10,Math.floor(mc/100)%10,Math.floor(mc/10)%10,mc%10];var _18=120*p.lat-80*mi[0]-10*mi[2]-mi[4];var _19=80*(p.lon-(mi[1]+100))-10*mi[3]-mi[5];var dB=_dc.interpolate(c[0],e[0],n[0],ne[0],_19,_18);var dL=_dc.interpolate(c[1],e[1],n[1],ne[1],_19,_18);_10(dB/3600,dL/3600);}else{_10();}},_11);};DatumConv.prototype.interpolate=function(_1c,_1d,_1e,_1f,_20,_21){var a=_1c;var b=_1d-_1c;var c=_1e-_1c;var d=_1f-_1d-_1e+_1c;return a+b*_20+c*_21+d*_20*_21;};DatumConv.prototype.send=function(_26,_27,_28){var ms=""+_26;var _2a="ID"+ms;if(this.cache[_2a]){var m=this.cache[_2a];if(_27){_27(m.c,m.n,m.e,m.ne);}}else{if(!_28){this.waitlist.push([ms,_2a,_27]);if(!this.current){this.popqueue();}}else{_27();}}};DatumConv.prototype.popqueue=function(){var _2c=this.waitlist;if(_2c.lock){return;}_2c.lock=true;var _2d=this.waitlist.splice(0,1)[0];if(this.cache[_2d[1]]){_2c.lock=false;var m=this.cache[_2d[1]];if(_2c.length){_setTimeout(this,this.popqueue,0);}if(_2d[2]){_2d[2](m.c,m.n,m.e,m.ne);}}else{this.current=true;_2c.lock=false;var ms=_2d[0],_30=_2d[1],_31=_2d[2];var e=document.createElement("script");e.type="text/javascript";e.src=this.server+"/"+ms.substr(0,4)+"/"+ms.substr(4,2)+"/"+ms+".json";e.id=_30+"_"+(new Date().getTime().toString(16))+Math.floor(Math.random()*10000);var _33=_setTimeout(this,this.doCurrent,3000);this.current=[e.id,_30,_31,_33];document.body.appendChild(e);}};DatumConv.prototype.invoke=function(c,n,e,ne){var _38=this.current;if(_38){var _39=_38[1];var _3a=this.cache;_3a[_39]={"c":c,"n":n,"e":e,"ne":ne};_3a.length++;if(_3a.length>260){for(var i in _3a){if(i==_39||i=="length"){continue;}delete _3a[i];_3a.length--;break;}}this.doCurrent();}};DatumConv.prototype.doCurrent=function(){var _3c=this.current;if(_3c){var _3d=_3c[1];var m=this.cache[_3d];if(_3c[3]){clearTimeout(_3c[3]);}setTimeout(function(){document.body.removeChild(document.getElementById(_3c[0]));},0);this.current=null;}var _3f=this.waitlist;if(_3f.length){_setTimeout(this,this.popqueue,0);}if(_3c&&_3c[2]){if(m){_3c[2](m.c,m.n,m.e,m.ne);}else{_3c[2]();}}};DatumConv.prototype.getExistsMesh=function(p){var mc=p.getMeshCode();var l=0;var r=this._datum_exists_mesh.length;var m=0;var val=parseInt(mc/10000);var _46=false;while(l<=r){m=parseInt((l+r)/2);if(this._datum_exists_mesh[m]==val){return true;}else{if(this._datum_exists_mesh[m]<val){l=m+1;}else{r=m-1;}}}return false;};var _dc=new DatumConv();
function Slider(m,_2,_3){this.slider=null;this.mapCtrl=m;this.sliderImgPath=_2;if(_3==1){this.slider=new Slider_H(this.mapCtrl,this.sliderImgPath+"g/");}else{if(_3==2){this.slider=new Slider_W(this.mapCtrl,this.sliderImgPath+"y/");}else{if(_3==3){this.slider=new Slider_BW(this.mapCtrl,this.sliderImgPath);}else{if(_3==4){this.slider=new Slider_BH(this.mapCtrl,this.sliderImgPath);}else{this.slider=new Slider_H(this.mapCtrl,this.sliderImgPath+"g/");}}}}}Slider.prototype.getContainer=function(){return this.slider.sliderdiv;};Slider.prototype.getControlNoMap=function(){return this.slider.controlNoMap;};Slider.prototype.setControlNoMap=function(_4){this.slider.controlNoMap=_4;this.slider.layerListChanged(this.mapCtrl.getCurrentPackageId());};Slider.prototype.getEnableBlow=function(){return this.slider._enableBlow;};Slider.prototype.setEnableBlow=function(_5){this.slider._enableBlow=_5;};Slider.prototype.changeMode=function(_6){var _7=this.getControlNoMap();var _8=this.getEnableBlow();this.slider.release();this.mapCtrl.getContainer().removeChild(this.slider.sliderdiv);if(_6==1){this.slider=new Slider_H(this.mapCtrl,this.sliderImgPath+"g/");}else{if(_6==2){this.slider=new Slider_W(this.mapCtrl,this.sliderImgPath+"y/");}else{if(_6==3){this.slider=new Slider_BW(this.mapCtrl,this.sliderImgPath);}else{if(_6==4){this.slider=new Slider_BH(this.mapCtrl,this.sliderImgPath);}else{this.slider=new Slider_H(this.mapCtrl,this.sliderImgPath+"g/");}}}}this.setControlNoMap(_7);this.setEnableBlow(_8);};
function Slider_H(_1,_2){if(_2==undefined){_2="";}else{_2+="/";}this._preImg=new Image();this._preImg.src="http://i.yimg.jp/images/map/api/ui_merge_v3.png";this._WideTooltip=decodeURIComponent("%E7%B8%AE%E5%B0%8F");this._ZoomTooltip=decodeURIComponent("%E6%8B%A1%E5%A4%A7");this._margin=4;this.ui_w=159;this.ui_h=215;this.minus_w=25;this.minus_h=24;this.minus_l=-134;this.minus_t=-45;this.plus_w=25;this.plus_h=24;this.plus_l=-134;this.plus_t=-147;this.mem_w=25;this.mem_h=8;this.mem_l=-109;this.mem_b=-147;this.mem_l2=-134;this.blw_w=67;this.blw_h=21;this.blw_l=0;this.blw_t=-32;this.blw_offsetY=-1;this.blw_offsetX=-5;this.grip_w=24;this.grip_h=9;this.grip_l=-32;this.grip_t=-21;this.grip_offsetY=1;this.gripMouseDown=false;this.gripMouseDownY=0;this.gripPosY=0;this.gripDragged=false;this.gripdiv=null;this.blowdiv=null;this.timerid=null;this.controlNoMap=false;this._enableBlow=true;this.mapCtrl=_1;this.sliderdiv=document.createElement("div");this.mapCtrl.getContainer().appendChild(this.sliderdiv);this.sliderBody=this.createSlider();this.sliderdiv.appendChild(this.sliderBody);this.lc=AlpsEvent.bindEvent(this.mapCtrl,"layerChanged",this,this.layerChanged);this.slc=AlpsEvent.bindEvent(this.mapCtrl,"smoothLayerChanging",this,this.smoothLayerChanging);this.llc=AlpsEvent.bindEvent(this.mapCtrl,"layerListChanged",this,this.layerListChanged);this.pc=AlpsEvent.bindEvent(this.mapCtrl,"packageChanged",this,this.packageChanged);this.layerChanged();}Slider_H.prototype.createSlider=function(){this.layerCount=this.mapCtrl.getLayerCount();var _3=this.layerCount>11?false:true;if(_3){this._BlowLayerScales=[26000000,3000000,500000,70000,10000];}else{this._BlowLayerScales=[200000000,26000000,3000000,500000,70000,10000];}this.layerScales=new Array();var _4=this.mapCtrl.getLayerCount();for(var i=0;i<_4;++i){this.layerScales.push(this.mapCtrl.getLayerScale(i));}var _6=document.createElement("div");_6.style.top=this._margin+"px";_6.style.left=this._margin+"px";_6.style.position="absolute";var _7=document.createElement("div");_6.appendChild(_7);_7.style.position="absolute";_7.style.borderColor="orange";_7.style.borderStyle="none";_7.style.borderWidth="1px";_7.style.cursor="pointer";var _8=document.createElement("div");_7.appendChild(_8);_8.title=this._WideTooltip;_8.style.top="0px";this.setDivStyle(_8,this.minus_w,this.minus_h);AlpsEvent.bindBuiltInEvent(_8,"click",this,this.onWideClick);AlpsEvent.addBuiltInEvent(_8,"mousedown",function(e){CancelBubble(e);return false;});AlpsEvent.addBuiltInEvent(_8,"dblclick",function(e){CancelBubble(e);return false;});_8.appendChild(this.getSliderImg(this.minus_l,this.minus_t));var _b=document.createElement("div");_7.appendChild(_b);_b.style.position="absolute";_b.style.borderStyle="none";_b.style.borderWidth="1px";_b.style.cursor="pointer";_b.style.top=this.minus_h+"px";AlpsEvent.bindBuiltInEvent(_b,"click",this,this.onBgClick2);AlpsEvent.addBuiltInEvent(_b,"mousedown",function(e){CancelBubble(e);return false;});AlpsEvent.addBuiltInEvent(_b,"dblclick",function(e){CancelBubble(e);return false;});for(var i=this.layerCount-1;i>=0;--i){var _e=document.createElement("div");_b.appendChild(_e);_e.style.top=(i*this.mem_h)+"px";_e.title="";this.setDivStyle(_e,this.mem_w,this.mem_h);var _f=this.layerCount-i;if(_f>9){_f=9;}var _10=this.mem_l;for(var j=0;j<this._BlowLayerScales.length;++j){var _12=this.getNearestSliderTop(this._BlowLayerScales[j]);var id=parseInt(_12/this.mem_h);if(id==i){_10=this.mem_l2;break;}}var mm=this.getSliderImg(_10,this.mem_b+((_f)*this.mem_h));mm.setAttribute("layer",this.layerCount-i-1);_e.appendChild(mm);}var _15=document.createElement("div");_7.appendChild(_15);_15.title=this._ZoomTooltip;_15.style.top=this.minus_h+(this.layerCount*this.mem_h)+"px";this.setDivStyle(_15,this.plus_w,this.plus_h);AlpsEvent.bindBuiltInEvent(_15,"click",this,this.onZoomClick);AlpsEvent.addBuiltInEvent(_15,"mousedown",function(e){CancelBubble(e);return false;});AlpsEvent.addBuiltInEvent(_15,"dblclick",function(e){CancelBubble(e);return false;});_15.appendChild(this.getSliderImg(this.plus_l,this.plus_t));var _18=document.createElement("div");_6.appendChild(_18);_18.style.position="absolute";_18.style.borderColor="orange";_18.style.borderStyle="none";_18.style.borderWidth="1px";_18.style.cursor="pointer";_18.style.visibility="hidden";var _19=this;AlpsEvent.addBuiltInEvent(_6,"mouseover",function(e){_19.onBlowMouse("mouseover");});AlpsEvent.addBuiltInEvent(_6,"mouseout",function(e){_19.onBlowMouse("mouseout");});this.blowdiv=_18;for(var i=0;i<this._BlowLayerScales.length;++i){var _1c=this._BlowLayerScales[i];var _1d=document.createElement("div");_18.appendChild(_1d);var _12=this.getNearestSliderTop(_1c);_1d.style.top=(parseInt(_12-(this.mem_h/2)+this.minus_h+this.blw_offsetY))+"px";_1d.style.left=this.mem_w+this.blw_offsetX+"px";this.setDivStyle(_1d,this.blw_w,this.blw_h);AlpsEvent.bindBuiltInEvent(_1d,"click",this,this.onBlowClick);AlpsEvent.addBuiltInEvent(_1d,"mousedown",function(e){CancelBubble(e);return false;});AlpsEvent.addBuiltInEvent(_1d,"dblclick",function(e){CancelBubble(e);return false;});var bm=this.getSliderImg(0,this.blw_t-(i*this.blw_h));bm.setAttribute("layer",this.layerCount-(_12/this.mem_h)-1);_1d.appendChild(bm);}this.gripdiv=document.createElement("div");_6.appendChild(this.gripdiv);this.setDivStyle(this.gripdiv,this.grip_w,this.grip_h);this.gripdiv.style.left="1px";this.gripdiv.appendChild(this.getSliderImg(this.grip_l,this.grip_t));var _21=this.gripdiv.setCapture?this.gripdiv:window;AlpsEvent.bindBuiltInEvent(this.gripdiv,"mousedown",this,this.onGripMouseDown);AlpsEvent.bindBuiltInEvent(_21,"mousemove",this,this.onGripMouseMove);AlpsEvent.bindBuiltInEvent(_21,"mouseup",this,this.onGripMouseUp);AlpsEvent.addBuiltInEvent(this.gripdiv,"dblclick",function(e){CancelBubble(e);return false;});AlpsEvent.addBuiltInEvent(this.gripdiv,"click",function(e){CancelBubble(e);return false;});if(_bi.type==2){AlpsEvent.bindBuiltInEvent(window,"mouseout",this,this.onWindowMouseOut);}return _6;};Slider_H.prototype.getSliderImg=function(l,t){var _26=document.createElement("img");_26.style.border="0px none";_26.style.margin="0px";_26.style.padding="0px";_26.style.position="absolute";_26.style.left=l+"px";_26.style.top=t+"px";_26.style.width=this.ui_w+"px";_26.style.height=this.ui_h+"px";_26.style.filter="";_26.src=this._preImg.src;if(_bi.type==1){_26.unselectable="on";_26.onselectstart=Nothing;_26.galleryImg="no";}else{_26.style.MozUserSelect="none";}_26.oncontextmenu=Nothing;_AlphaImageLoader(_26,this.ui_w,this.ui_h);return _26;};Slider_H.prototype.setDivStyle=function(div,w,h){div.style.overflow="hidden";div.style.width=w+"px";div.style.height=h+"px";div.style.position="absolute";};Slider_H.prototype.onBlowMouse=function(op){if(!this._enableBlow){return;}if(this.timerid){window.clearTimeout(this.timerid);this.timerid=null;}this.timerid=_setTimeout(this,this.blowMouseTimeoutFn,100,op);};Slider_H.prototype.blowMouseTimeoutFn=function(op){if(op=="mouseover"){if(this.blowdiv.style.visibility=="hidden"){this.blowdiv.style.visibility="visible";}}else{if(op=="mouseout"){if(this.blowdiv.style.visibility=="visible"){this.blowdiv.style.visibility="hidden";}}}};function setImageStyle(img){if(_bi.type==1){img.unselectable="on";img.onselectstart=Nothing;img.galleryImg="no";}else{img.style.MozUserSelect="none";}img.oncontextmenu=Nothing;}Slider_H.prototype.onWideClick=function(e){if(!this.mapCtrl){return;}var _2e=parseInt(this.mapCtrl.getCurrentLayerId());this.setLayer(_2e+1);CancelBubble(e);return false;};Slider_H.prototype.onZoomClick=function(e){if(!this.mapCtrl){return;}var _30=parseInt(this.mapCtrl.getCurrentLayerId());this.setLayer(_30-1);CancelBubble(e);return false;};Slider_H.prototype.onBgClick=function(e){e=(e?e:window.event);var _32=e.srcElement||e.target;var x=e.offsetX||e.layerX;var y=e.offsetY||e.layerY;var _35=this.layerCount-Math.ceil((y-this.minus_h)/this.mem_h);this.setLayer(_35);CancelBubble(e);return false;};Slider_H.prototype.onBgClick2=function(e){e=(e?e:window.event);var _37=e.srcElement||e.target;this.setLayer(parseInt(_37.getAttribute("layer")));CancelBubble(e);return false;};Slider_H.prototype.onBlowClick=function(e){e=(e?e:window.event);var _39=e.srcElement||e.target;this.setLayer(parseInt(_39.getAttribute("layer")));CancelBubble(e);return false;};Slider_H.prototype.setLayer=function(_3a){if(!this.mapCtrl){return;}if(_3a>=0&&_3a<=this.layerScales.length-1){this.layerto(this.checkScaleID(_3a));}};Slider_H.prototype.checkScaleID=function(_3b){if(!this.mapCtrl){return;}var s;if(!this.controlNoMap){s=new Array();for(var i=0;i<this.layerCount;++i){s.push(this.mapCtrl.getLayerScale(i));}}else{s=this.mapCtrl.getLayerScaleList();}var _3e=false;if(_3b>=0){var _3f=this.mapCtrl.getLayerScale(_3b);var _40=0;for(var i=0;i<s.length;++i){if(_40==0){_40=s[i];}else{if(Math.abs(_3f-_40)>Math.abs(_3f-s[i])){_40=s[i];}}if(s[i]==_3f){_3e=true;break;}}}return _3e?_3b:this.mapCtrl.getLayerId(_40);};Slider_H.prototype.layerto=function(_41){this.mapCtrl.smoothLayerTo(_41);};Slider_H.prototype.setGripPos=function(_42){if(!this.gripdiv){return;}if(_42>=this.layerScales.length){this.gripdiv.style.visibility="hidden";}else{this.gripdiv.style.visibility="visible";}this.gripdiv.style.top=this.getYByLayerId(_42)+"px";};Slider_H.prototype.getYByLayerId=function(_43){return this.minus_h+(this.layerScales.length-1-_43)*this.mem_h+this.grip_offsetY;};Slider_H.prototype.getLayerIdByY=function(_44){return Math.round(this.getLayerIdByY2(_44));};Slider_H.prototype.getLayerIdByY2=function(_45){return (this.minus_h-_45)/this.mem_h+(this.layerScales.length-1);};Slider_H.prototype.onGripMouseDown=function(e){if(!this.gripMouseDown){this.gripDragged=false;this.gripMouseDownY=e.screenY;this.gripPosY=parseInt(this.gripdiv.style.top);if(this.gripdiv.setCapture){this.gripdiv.setCapture();}this.gripMouseDown=true;CancelBubble(e);}return false;};Slider_H.prototype.onGripMouseMove=function(e){if(this.gripMouseDown){var _48=e.screenY-this.gripMouseDownY;var _49=this.gripPosY+_48;if(_49<this.minus_h){_49=this.minus_h+this._margin;}if(_49>this.minus_h+(this.layerScales.length-1)*this.mem_h){_49=this.minus_h+(this.layerScales.length-1)*this.mem_h;}this.gripdiv.style.top=_49+"px";this.gripDragged=true;var _4a=this.getMagnifyBySliderPos(this.gripPosY,_49);var _4b=false;var _4c=false;this.mapCtrl.magnifyTo(_4a,_4b,_4c);CancelBubble(e);}return false;};Slider_H.prototype.getMagnifyBySliderPos=function(_4d,_4e){var _4f=this.getLayerIdByY(_4d);var _50=this.getLayerIdByY2(_4e);var _51=_50-Math.floor(_50);_50=Math.floor(_50);var _52=0;if(_50>=this.layerScales.length-1){_52=this.layerScales[_50];}else{_52=this.layerScales[_50]*(1-_51)+this.layerScales[_50+1]*_51;}var _53=this.layerScales[_4f]/_52;return _53;};Slider_H.prototype.onGripMouseUp=function(e){if(document.releaseCapture){document.releaseCapture();}if(this.gripMouseDown){if(this.gripDragged){var _55=parseInt(this.gripdiv.style.top);var _56=this.getLayerIdByY(_55);var _57=this.checkScaleID(_56);if(_57!=this.mapCtrl.getCurrentLayerId()){this.setLayer(_57);}else{this.mapCtrl.magnifyTo(1);this.setGripPos(this.mapCtrl.getCurrentLayerId());}}this.gripMouseDown=false;CancelBubble(e);}return false;};Slider_H.prototype.onWindowMouseOut=function(e){if(!e.relatedTarget&&this.gripMouseDown){this.onGripMouseUp(e);}return false;};Slider_H.prototype.smoothLayerChanging=function(_59,_5a){this.setGripPos(_5a);};Slider_H.prototype.layerChanged=function(){if(!this.gripMouseDown){var _5b=this.mapCtrl.getCurrentLayerId();this.setGripPos(_5b);}};Slider_H.prototype.layerListChanged=function(_5c){if(this.mapCtrl.getCurrentPackageId()!=_5c){return;}};Slider_H.prototype.getNearestSliderTop=function(_5d){var _5e=10000;var _5f=0;for(var i=0;i<this.layerCount;i++){var s=this.mapCtrl.getLayerScale(i);var _62=s/_5d;if(_62<1){_62=1/_62;}if(_62<_5e){_5e=_62;_5f=i;}}return (this.layerCount-_5f-1)*this.mem_h;};Slider_H.prototype.packageChanged=function(){this.sliderdiv.removeChild(this.sliderBody);this.sliderBody=this.createSlider();this.sliderdiv.appendChild(this.sliderBody);this.layerChanged();};Slider_H.prototype.getContainer=function(){return this.sliderdiv;};Slider_H.prototype.getControlNoMap=function(){return this.controlNoMap;};Slider_H.prototype.setControlNoMap=function(val){this.controlNoMap=val;this.layerListChanged(this.mapCtrl.getCurrentPackageId());};Slider_H.prototype.getEnableBlow=function(){return this._enableBlow;};Slider_H.prototype.setEnableBlow=function(val){this._enableBlow=val;};Slider_H.prototype.release=function(){AlpsEvent.removeEvent(this.lc);AlpsEvent.removeEvent(this.slc);AlpsEvent.removeEvent(this.llc);AlpsEvent.removeEvent(this.pc);};
function Slider_W(_1,_2){if(_2==undefined){_2="";}else{_2+="/";}this._preImg=new Image();this._preImg.src="http://i.yimg.jp/images/map/api/ui_merge_v3.png";this._WideTooltip=decodeURIComponent("%E7%B8%AE%E5%B0%8F");this._ZoomTooltip=decodeURIComponent("%E6%8B%A1%E5%A4%A7");this._margin=4;this.ui_w=159;this.ui_h=215;this.minus_w=22;this.minus_h=22;this.minus_l=0;this.minus_t=-193;this.plus_w=22;this.plus_h=22;this.plus_l=-133;this.plus_t=-193;this.mem_w=8;this.mem_h=20;this.mem_r=-132;this.mem_t=-193;this.mem_t2=-171;this.blw_w=21;this.blw_h=54;this.blw_l=-67;this.blw_t=0;this.blw_offsetY=-3;this.blw_offsetX=-1;this.grip_w=9;this.grip_h=26;this.grip_l=-57;this.grip_t=0;this.grip_offsetX=1;this.gripMouseDown=false;this.gripMouseDownX=0;this.gripPosX=0;this.gripDragged=false;this.gripdiv=null;this.blowdiv=null;this.timerid=null;this.controlNoMap=false;this._enableBlow=true;this.mapCtrl=_1;this.sliderdiv=document.createElement("div");this.mapCtrl.getContainer().appendChild(this.sliderdiv);this.sliderBody=this.createSlider();this.sliderdiv.appendChild(this.sliderBody);this.lc=AlpsEvent.bindEvent(this.mapCtrl,"layerChanged",this,this.layerChanged);this.slc=AlpsEvent.bindEvent(this.mapCtrl,"smoothLayerChanging",this,this.smoothLayerChanging);this.llc=AlpsEvent.bindEvent(this.mapCtrl,"layerListChanged",this,this.layerListChanged);this.pc=AlpsEvent.bindEvent(this.mapCtrl,"packageChanged",this,this.packageChanged);this.layerChanged();}Slider_W.prototype.createSlider=function(){this.layerCount=this.mapCtrl.getLayerCount();var _3=this.layerCount>11?false:true;if(_3){this._BlowLayerScales=[26000000,3000000,500000,70000,10000];}else{this._BlowLayerScales=[200000000,26000000,3000000,500000,70000,10000];}this.layerScales=new Array();var _4=this.mapCtrl.getLayerCount();for(var i=0;i<_4;++i){this.layerScales.push(this.mapCtrl.getLayerScale(i));}var _6=document.createElement("div");_6.style.top=this._margin+"px";_6.style.left=this._margin+"px";_6.style.position="absolute";var _7=document.createElement("div");_6.appendChild(_7);_7.style.position="absolute";_7.style.borderColor="orange";_7.style.borderStyle="none";_7.style.borderWidth="1px";_7.style.cursor="pointer";var _8=document.createElement("div");_7.appendChild(_8);_8.title=this._WideTooltip;_8.style.left="0px";this.setDivStyle(_8,this.minus_w,this.minus_h);AlpsEvent.bindBuiltInEvent(_8,"click",this,this.onWideClick);AlpsEvent.addBuiltInEvent(_8,"mousedown",function(e){CancelBubble(e);return false;});AlpsEvent.addBuiltInEvent(_8,"dblclick",function(e){CancelBubble(e);return false;});_8.appendChild(this.getSliderImg(this.minus_l,this.minus_t));var _b=document.createElement("div");_7.appendChild(_b);_b.style.position="absolute";_b.style.borderStyle="none";_b.style.borderWidth="1px";_b.style.cursor="pointer";_b.style.left=this.minus_w+"px";AlpsEvent.bindBuiltInEvent(_b,"click",this,this.onBgClick2);AlpsEvent.addBuiltInEvent(_b,"mousedown",function(e){CancelBubble(e);return false;});AlpsEvent.addBuiltInEvent(_b,"dblclick",function(e){CancelBubble(e);return false;});for(var i=this.layerCount-1;i>=0;--i){var _e=document.createElement("div");_b.appendChild(_e);_e.style.left=(i*this.mem_w)+"px";_e.title="";this.setDivStyle(_e,this.mem_w,this.mem_h);var _f=this.layerCount-i;if(_f>9){_f=9;}var top=this.mem_t;for(var j=0;j<this._BlowLayerScales.length;++j){var _12=this.getNearestSliderLeft(this._BlowLayerScales[j]);var id=parseInt(_12/this.mem_w);if(id==i){top=this.mem_t2;break;}}var mm=this.getSliderImg(this.mem_r+((_f)*this.mem_w),top);mm.setAttribute("layer",this.layerCount-i-1);_e.appendChild(mm);}var _15=document.createElement("div");_7.appendChild(_15);_15.title=this._ZoomTooltip;_15.style.left=this.minus_w+(this.layerCount*this.mem_w)+"px";this.setDivStyle(_15,this.plus_w,this.plus_h);AlpsEvent.bindBuiltInEvent(_15,"click",this,this.onZoomClick);AlpsEvent.addBuiltInEvent(_15,"mousedown",function(e){CancelBubble(e);return false;});AlpsEvent.addBuiltInEvent(_15,"dblclick",function(e){CancelBubble(e);return false;});_15.appendChild(this.getSliderImg(this.plus_l,this.plus_t));var _18=document.createElement("div");_6.appendChild(_18);_18.style.position="absolute";_18.style.borderColor="orange";_18.style.borderStyle="none";_18.style.borderWidth="1px";_18.style.cursor="pointer";_18.style.visibility="hidden";var _19=this;AlpsEvent.addBuiltInEvent(_6,"mouseover",function(e){_19.onBlowMouse("mouseover");});AlpsEvent.addBuiltInEvent(_6,"mouseout",function(e){_19.onBlowMouse("mouseout");});this.blowdiv=_18;for(var i=0;i<this._BlowLayerScales.length;++i){var _1c=this._BlowLayerScales[i];var _1d=document.createElement("div");_18.appendChild(_1d);var _12=this.getNearestSliderLeft(_1c);_1d.style.left=(parseInt(_12-(this.mem_w/2)+this.minus_w+this.blw_offsetX))+"px";_1d.style.top=this.mem_h+this.blw_offsetY+"px";this.setDivStyle(_1d,this.blw_w,this.blw_h);AlpsEvent.bindBuiltInEvent(_1d,"click",this,this.onBlowClick);AlpsEvent.addBuiltInEvent(_1d,"mousedown",function(e){CancelBubble(e);return false;});AlpsEvent.addBuiltInEvent(_1d,"dblclick",function(e){CancelBubble(e);return false;});var bm=this.getSliderImg(this.blw_l-(parseInt(i%2)*this.blw_w),this.blw_t-(parseInt(i/2)*this.blw_h));bm.setAttribute("layer",this.layerCount-(_12/this.mem_w)-1);_1d.appendChild(bm);}this.gripdiv=document.createElement("div");_6.appendChild(this.gripdiv);this.setDivStyle(this.gripdiv,this.grip_w,this.grip_h);this.gripdiv.style.top="-2px";this.gripdiv.appendChild(this.getSliderImg(this.grip_l,this.grip_t));var _21=this.gripdiv.setCapture?this.gripdiv:window;AlpsEvent.bindBuiltInEvent(this.gripdiv,"mousedown",this,this.onGripMouseDown);AlpsEvent.bindBuiltInEvent(_21,"mousemove",this,this.onGripMouseMove);AlpsEvent.bindBuiltInEvent(_21,"mouseup",this,this.onGripMouseUp);AlpsEvent.addBuiltInEvent(this.gripdiv,"dblclick",function(e){CancelBubble(e);return false;});AlpsEvent.addBuiltInEvent(this.gripdiv,"click",function(e){CancelBubble(e);return false;});if(_bi.type==2){AlpsEvent.bindBuiltInEvent(window,"mouseout",this,this.onWindowMouseOut);}return _6;};Slider_W.prototype.getSliderImg=function(l,t){var _26=document.createElement("img");_26.style.border="0px none";_26.style.margin="0px";_26.style.padding="0px";_26.style.position="absolute";_26.style.left=l+"px";_26.style.top=t+"px";_26.style.width=this.ui_w+"px";_26.style.height=this.ui_h+"px";_26.style.filter="";_26.src=this._preImg.src;if(_bi.type==1){_26.unselectable="on";_26.onselectstart=Nothing;_26.galleryImg="no";}else{_26.style.MozUserSelect="none";}_26.oncontextmenu=Nothing;_AlphaImageLoader(_26,this.ui_w,this.ui_h);return _26;};Slider_W.prototype.setDivStyle=function(div,w,h){div.style.overflow="hidden";div.style.width=w+"px";div.style.height=h+"px";div.style.position="absolute";};Slider_W.prototype.onBlowMouse=function(op){if(!this._enableBlow){return;}if(this.timerid){window.clearTimeout(this.timerid);this.timerid=null;}this.timerid=_setTimeout(this,this.blowMouseTimeoutFn,100,op);};Slider_W.prototype.blowMouseTimeoutFn=function(op){if(op=="mouseover"){if(this.blowdiv.style.visibility=="hidden"){this.blowdiv.style.visibility="visible";}}else{if(op=="mouseout"){if(this.blowdiv.style.visibility=="visible"){this.blowdiv.style.visibility="hidden";}}}};function setImageStyle(img){if(_bi.type==1){img.unselectable="on";img.onselectstart=Nothing;img.galleryImg="no";}else{img.style.MozUserSelect="none";}img.oncontextmenu=Nothing;}Slider_W.prototype.onWideClick=function(e){if(!this.mapCtrl){return;}var _2e=parseInt(this.mapCtrl.getCurrentLayerId());this.setLayer(_2e+1);CancelBubble(e);return false;};Slider_W.prototype.onZoomClick=function(e){if(!this.mapCtrl){return;}var _30=parseInt(this.mapCtrl.getCurrentLayerId());this.setLayer(_30-1);CancelBubble(e);return false;};Slider_W.prototype.onBgClick=function(e){e=(e?e:window.event);var _32=e.srcElement||e.target;var x=e.offsetX||e.layerX;var _34=this.layerCount-Math.ceil((y-this.minus_w)/this.mem_w);this.setLayer(_34);CancelBubble(e);return false;};Slider_W.prototype.onBgClick2=function(e){e=(e?e:window.event);var _36=e.srcElement||e.target;this.setLayer(parseInt(_36.getAttribute("layer")));CancelBubble(e);return false;};Slider_W.prototype.onBlowClick=function(e){e=(e?e:window.event);var _38=e.srcElement||e.target;this.setLayer(parseInt(_38.getAttribute("layer")));CancelBubble(e);return false;};Slider_W.prototype.setLayer=function(_39){if(!this.mapCtrl){return;}if(_39>=0&&_39<=this.layerScales.length-1){this.layerto(this.checkScaleID(_39));}};Slider_W.prototype.checkScaleID=function(_3a){if(!this.mapCtrl){return;}var s;if(!this.controlNoMap){s=new Array();var _3c=this.mapCtrl.getLayerCount();for(var i=0;i<_3c;++i){s.push(this.mapCtrl.getLayerScale(i));}}else{s=this.mapCtrl.getLayerScaleList();}var _3e=false;if(_3a>=0){var _3f=this.mapCtrl.getLayerScale(_3a);var _40=0;for(var i=0;i<s.length;++i){if(_40==0){_40=s[i];}else{if(Math.abs(_3f-_40)>Math.abs(_3f-s[i])){_40=s[i];}}if(s[i]==_3f){_3e=true;break;}}}return _3e?_3a:this.mapCtrl.getLayerId(_40);};Slider_W.prototype.layerto=function(_41){this.mapCtrl.smoothLayerTo(_41);};Slider_W.prototype.setGripPos=function(_42){if(!this.gripdiv){return;}if(_42>=this.layerScales.length){this.gripdiv.style.visibility="hidden";}else{this.gripdiv.style.visibility="visible";}this.gripdiv.style.left=this.getXByLayerId(_42)+"px";};Slider_W.prototype.getXByLayerId=function(_43){return this.minus_w+(this.layerScales.length-1-_43)*this.mem_w+this.grip_offsetX;};Slider_W.prototype.getLayerIdByX=function(_44){return Math.round(this.getLayerIdByX2(_44));};Slider_W.prototype.getLayerIdByX2=function(_45){return (this.minus_w-_45)/this.mem_w+(this.layerScales.length-1);};Slider_W.prototype.onGripMouseDown=function(e){if(!this.gripMouseDown){this.gripDragged=false;this.gripMouseDownX=e.screenX;this.gripPosX=parseInt(this.gripdiv.style.left);if(this.gripdiv.setCapture){this.gripdiv.setCapture();}this.gripMouseDown=true;CancelBubble(e);}return false;};Slider_W.prototype.onGripMouseMove=function(e){if(this.gripMouseDown){var _48=e.screenX-this.gripMouseDownX;var _49=this.gripPosX+_48;if(_49<this.minus_w){_49=this.minus_w+this._margin;}if(_49>this.minus_w+(this.layerScales.length-1)*this.mem_w){_49=this.minus_w+(this.layerScales.length-1)*this.mem_w;}this.gripdiv.style.left=_49+"px";this.gripDragged=true;var _4a=this.getMagnifyBySliderPos(this.gripPosX,_49);var _4b=false;var _4c=false;this.mapCtrl.magnifyTo(_4a,_4b,_4c);CancelBubble(e);}return false;};Slider_W.prototype.getMagnifyBySliderPos=function(_4d,_4e){var _4f=this.getLayerIdByX(_4d);var _50=this.getLayerIdByX2(_4e);var _51=_50-Math.floor(_50);_50=Math.floor(_50);var _52=0;if(_50>=this.layerScales.length-1){_52=this.layerScales[_50];}else{_52=this.layerScales[_50]*(1-_51)+this.layerScales[_50+1]*_51;}var _53=this.layerScales[_4f]/_52;return _53;};Slider_W.prototype.onGripMouseUp=function(e){if(document.releaseCapture){document.releaseCapture();}if(this.gripMouseDown){if(this.gripDragged){var _55=parseInt(this.gripdiv.style.left);var _56=this.getLayerIdByX(_55);var _57=this.checkScaleID(_56);if(_57!=this.mapCtrl.getCurrentLayerId()){this.setLayer(_57);}else{this.mapCtrl.magnifyTo(1);this.setGripPos(this.mapCtrl.getCurrentLayerId());}}this.gripMouseDown=false;CancelBubble(e);}return false;};Slider_W.prototype.onWindowMouseOut=function(e){if(!e.relatedTarget&&this.gripMouseDown){this.onGripMouseUp(e);}return false;};Slider_W.prototype.smoothLayerChanging=function(_59,_5a){this.setGripPos(_5a);};Slider_W.prototype.layerChanged=function(){if(!this.gripMouseDown){var _5b=this.mapCtrl.getCurrentLayerId();this.setGripPos(_5b);}};Slider_W.prototype.layerListChanged=function(_5c){if(this.mapCtrl.getCurrentPackageId()!=_5c){return;}};Slider_W.prototype.getNearestSliderLeft=function(_5d){var _5e=10000;var _5f=0;for(var i=0;i<this.layerCount;i++){var s=this.mapCtrl.getLayerScale(i);var _62=s/_5d;if(_62<1){_62=1/_62;}if(_62<_5e){_5e=_62;_5f=i;}}return (this.layerCount-_5f-1)*8;};Slider_W.prototype.packageChanged=function(){this.sliderdiv.removeChild(this.sliderBody);this.sliderBody=this.createSlider();this.sliderdiv.appendChild(this.sliderBody);this.layerChanged();};Slider_W.prototype.getContainer=function(){return this.sliderdiv;};Slider_W.prototype.getControlNoMap=function(){return this.controlNoMap;};Slider_W.prototype.setControlNoMap=function(val){this.controlNoMap=val;this.layerListChanged(this.mapCtrl.getCurrentPackageId());};Slider_W.prototype.getEnableBlow=function(){return this._enableBlow;};Slider_W.prototype.setEnableBlow=function(val){this._enableBlow=val;};Slider_W.prototype.release=function(){AlpsEvent.removeEvent(this.lc);AlpsEvent.removeEvent(this.slc);AlpsEvent.removeEvent(this.llc);AlpsEvent.removeEvent(this.pc);};
function Slider_BW(_1,_2){if(_2==undefined){_2="";}else{_2+="/";}this._preImg=new Image();this._preImg.src="http://i.yimg.jp/images/map/api/ui_merge_v3.png";this._WideTooltip=decodeURIComponent("%E7%B8%AE%E5%B0%8F");this._ZoomTooltip=decodeURIComponent("%E6%8B%A1%E5%A4%A7");this.ui_w=159;this.ui_h=215;this.minus_w=22;this.minus_h=22;this.minus_l=-109;this.minus_t=0;this.plus_w=22;this.plus_h=22;this.plus_l=-109;this.plus_t=-22;this.mapCtrl=_1;this.controlNoMap=false;this._enableBlow=true;this.sliderImgPath=_2;this.sliderdiv=document.createElement("div");this.mapCtrl.getContainer().appendChild(this.sliderdiv);this.sliderBody=this.createSlider();this.sliderdiv.appendChild(this.sliderBody);}Slider_BW.prototype.createSlider=function(){this.zoomer=document.createElement("div");this.zoomer.id="zoomer";var _3=document.createElement("div");this.initButton(_3);this.zoomer.appendChild(_3);_3.className="sliderbar";_3.title=this._ZoomTooltip;_3.style.top="0px";this.setDivStyle(_3,this.plus_w,this.plus_h);_3.onclick=_func(this,"zoomIn");_3.appendChild(this.getSliderImg(this.plus_l,this.plus_t));var _4=document.createElement("div");this.initButton(_4);this.zoomer.appendChild(_4);_4.className="sliderbar";_4.title=this._WideTooltip;_4.style.left=this.plus_w+"px";this.setDivStyle(_4,this.minus_w,this.minus_h);_4.onclick=_func(this,"zoomOut");_4.appendChild(this.getSliderImg(this.minus_l,this.minus_t));return this.zoomer;};Slider_BW.prototype.getSliderImg=function(l,t){var _7=document.createElement("img");_7.style.border="0px none";_7.style.margin="0px";_7.style.padding="0px";_7.style.position="absolute";_7.style.left=l+"px";_7.style.top=t+"px";_7.style.width=this.ui_w+"px";_7.style.height=this.ui_h+"px";_7.style.filter="";_7.src=this._preImg.src;if(_bi.type==1){_7.unselectable="on";_7.onselectstart=Nothing;_7.galleryImg="no";}else{_7.style.MozUserSelect="none";}_7.oncontextmenu=Nothing;_AlphaImageLoader(_7,this.ui_w,this.ui_h);return _7;};Slider_BW.prototype.setDivStyle=function(_8,w,h){_8.style.overflow="hidden";_8.style.width=w+"px";_8.style.height=h+"px";_8.style.position="absolute";};Slider_BW.prototype.zoomIn=function(e){var l=this.mapCtrl.getCurrentLayerId()-1;this.mapCtrl.smoothLayerTo(l,true);if(e){CancelBubble(e);}};Slider_BW.prototype.zoomOut=function(e){var l=this.mapCtrl.getCurrentLayerId()+1;this.mapCtrl.smoothLayerTo(l,true);if(e){CancelBubble(e);}};Slider_BW.prototype.initButton=function(e){var _10=function(e){CancelBubble(e);};e.onmouseover=_10;e.onmouseout=_10;e.onmousedown=_10;e.onmouseup=_10;e.onclick=_10;e.ondblclick=_10;e.style.cursor="pointer";};Slider_BW.prototype.layerListChanged=function(_12){};Slider_BW.prototype.release=function(e){};
function Slider_BH(_1,_2){if(_2==undefined){_2="";}else{_2+="/";}this._preImg=new Image();this._preImg.src="http://i.yimg.jp/images/map/api/ui_merge_v3.png";this._WideTooltip=decodeURIComponent("%E7%B8%AE%E5%B0%8F");this._ZoomTooltip=decodeURIComponent("%E6%8B%A1%E5%A4%A7");this.ui_w=159;this.ui_h=215;this.minus_w=22;this.minus_h=22;this.minus_l=-109;this.minus_t=0;this.plus_w=22;this.plus_h=22;this.plus_l=-109;this.plus_t=-22;this.mapCtrl=_1;this.controlNoMap=false;this._enableBlow=true;this.sliderImgPath=_2;this.sliderdiv=document.createElement("div");this.mapCtrl.getContainer().appendChild(this.sliderdiv);this.sliderBody=this.createSlider();this.sliderdiv.appendChild(this.sliderBody);}Slider_BH.prototype.createSlider=function(){this.zoomer=document.createElement("div");this.zoomer.id="zoomer";var _3=document.createElement("div");this.initButton(_3);this.zoomer.appendChild(_3);_3.className="sliderbar";_3.title=this._ZoomTooltip;_3.style.top="0px";this.setDivStyle(_3,this.plus_w,this.plus_h);_3.onclick=_func(this,"zoomIn");_3.appendChild(this.getSliderImg(this.plus_l,this.plus_t));var _4=document.createElement("div");this.initButton(_4);this.zoomer.appendChild(_4);_4.className="sliderbar";_4.title=this._WideTooltip;_4.style.top=this.plus_h+"px";this.setDivStyle(_4,this.minus_w,this.minus_h);_4.onclick=_func(this,"zoomOut");_4.appendChild(this.getSliderImg(this.minus_l,this.minus_t));return this.zoomer;};Slider_BH.prototype.getSliderImg=function(l,t){var _7=document.createElement("img");_7.style.border="0px none";_7.style.margin="0px";_7.style.padding="0px";_7.style.position="absolute";_7.style.left=l+"px";_7.style.top=t+"px";_7.style.width=this.ui_w+"px";_7.style.height=this.ui_h+"px";_7.style.filter="";_7.src=this._preImg.src;if(_bi.type==1){_7.unselectable="on";_7.onselectstart=Nothing;_7.galleryImg="no";}else{_7.style.MozUserSelect="none";}_7.oncontextmenu=Nothing;_AlphaImageLoader(_7,this.ui_w,this.ui_h);return _7;};Slider_BH.prototype.setDivStyle=function(_8,w,h){_8.style.overflow="hidden";_8.style.width=w+"px";_8.style.height=h+"px";_8.style.position="absolute";};Slider_BH.prototype.zoomIn=function(e){var l=this.mapCtrl.getCurrentLayerId()-1;this.mapCtrl.smoothLayerTo(l,true);if(e){CancelBubble(e);}};Slider_BH.prototype.zoomOut=function(e){var l=this.mapCtrl.getCurrentLayerId()+1;this.mapCtrl.smoothLayerTo(l,true);if(e){CancelBubble(e);}};Slider_BH.prototype.initButton=function(e){var _10=function(e){CancelBubble(e);};e.onmouseover=_10;e.onmouseout=_10;e.onmousedown=_10;e.onmouseup=_10;e.onclick=_10;e.ondblclick=_10;e.style.cursor="pointer";};Slider_BH.prototype.layerListChanged=function(_12){};Slider_BH.prototype.release=function(e){};
function YahooCopyright(_1,_2){this.map=_1;this.base=document.createElement("div");this.base.style.zIndex=1;this.base.style.left="0px";this.base.style.bottom="0px";this.base.style.position="absolute";this.base.oncontextmenu=Nothing;this.map.getContainer().appendChild(this.base);this.cr=document.createElement("div");this.cr.style.zIndex=1;this.cr.style.position="static";this.cr.style.fontSize="12px";this.cr.style.fontFamily="Arial, Helvetica, sans-serif";this.cr.style.fontWeight="bold";this.cr.style.textAlign="left";this.cr.style.paddingBottom="0px";this.cr.style.paddingLeft="0px";this.cr.style.paddingRight="0px";this.cr.style.paddingTop="0px";this.cr.style.marginBottom="0px";this.cr.style.marginLeft="0px";this.cr.style.marginRight="0px";this.cr.style.marginTop="0px";this.cr.style.lineHeight="100%";if(_bi.type==1){this.cr.unselectable="on";this.cr.onselectstart=Nothing;}else{this.cr.style.MozUserSelect="none";}this.cr.oncontextmenu=Nothing;this.base.appendChild(this.cr);this.cr2=document.createElement("div");this.cr2.style.zIndex=1;this.cr2.style.position="static";this.cr2.style.fontSize="12px";this.cr2.style.fontFamily="Arial, Helvetica, sans-serif";this.cr2.style.fontWeight="bold";this.cr2.style.textAlign="left";this.cr2.style.paddingBottom="0px";this.cr2.style.paddingLeft="0px";this.cr2.style.paddingRight="0px";this.cr2.style.paddingTop="0px";this.cr2.style.marginBottom="0px";this.cr2.style.marginLeft="0px";this.cr2.style.marginRight="0px";this.cr2.style.marginTop="0px";this.cr2.style.lineHeight="100%";if(_bi.type==1){this.cr2.unselectable="on";this.cr2.onselectstart=Nothing;}else{this.cr2.style.MozUserSelect="none";}this.cr2.oncontextmenu=Nothing;this.base.appendChild(this.cr2);this.cr3=document.createElement("div");this.cr3.style.zIndex=1;this.cr3.style.position="static";this.base.appendChild(this.cr3);this._cpySrv="http://api.maps.yahoo.com/ajax/copy";this.cr_ysat=ImageMaker.createImg();this.cr_ysat.style.position="static";this.cr_ysat.style.display="none";this.cr3.appendChild(this.cr_ysat);this.apiMode=_2;AlpsEvent.bindEvent(this.map,"layerChanged",this,this.showCopyright);AlpsEvent.bindEvent(this.map,"packageChanged",this,this.showCopyright);AlpsEvent.bindEvent(this.map,"vendorChanged",this,this.showCopyright);AlpsEvent.bindEvent(this.map,"layerListChanged",this,this.mapLayerListChanged);}YahooCopyright.prototype.mapLayerListChanged=function(_3){var p=this.map.getCurrentPackageId();if(p!="worldmap"&&p!="map"&&p!="aero"){this.cr.innerHTML="";this.cr2.style.display="none";this.cr3.style.display="none";}if(p==_3){this.showCopyright();}};YahooCopyright.prototype.showCopyright=function(){var _5=this.map.getCurrentPackageId();var _6=this.map.getCurrentVendor();if(_5=="worldmap"||_5=="map"){this.cr.style.color="black";this.cr3.style.display="none";if(_6==1){this.cr2.style.display="none";this.cr.innerHTML=this.map.getYahooCopyright();}else{if(_6==2){this.cr2.style.display="block";this.cr.innerHTML="&copy;"+new Date().getFullYear()+" Yahoo! Inc.";this.cr2.innerHTML="Data &copy; 2008 Navteq, CE Info Systems";}}}else{if(_5=="aero"){this.cr.style.color="white";if(_6==1){this.cr2.style.display="none";this.cr3.style.display="none";this.cr.style.color="white";this.cr.innerHTML=this.map.getYahooCopyright();}else{if(_6==2){this.cr2.style.display="none";this.cr3.style.display="block";var _7=this.map.getCenterTileId();var _8=this.map.getCurrentZoomLevel();this.cr_ysat.style.display="block";this.cr_ysat.src=this._cpySrv+"?x="+_7.x+"&y="+_7.y+"&z="+_8+"&ew=1&ns=1";this.cr.innerHTML="&copy;"+new Date().getFullYear()+" Yahoo! Inc.";}}}else{this.cr.style.color="black";if(_6==1){this.cr.innerHTML=this.map.getYahooCopyright();this.cr2.style.display="none";this.cr3.style.display="none";}else{if(_6==2){this.cr.innerHTML="&copy;"+new Date().getFullYear()+" Yahoo! Inc.";this.cr2.style.display="block";this.cr2.innerHTML="Data &copy; 2008 Navteq, CE Info Systems";this.cr3.style.display="none";}}}}};
function YahooScalebar(_1){this.map=_1;this._preImg=new Image();this._preImg.src="http://i.yimg.jp/images/map/api/ui_forprint.gif";this.ui_w=66;this.ui_h=48;this.zs_w=4;this.zs_h=10;this.zsl_l=0;this.zsl_t=-34;this.zsr_l=-4;this.zsr_t=-34;this.sk_w=66;this.sk_h=4;this.sk_l=0;this.sk_t=-44;this.setObj();AlpsEvent.bindEvent(this.map,"mapMoved",this,this.mapMapMoved);AlpsEvent.bindEvent(this.map,"layerChanged",this,this.mapLayerChanged);AlpsEvent.bindEvent(this.map,"packageChanged",this,this.mapPackageChanged);AlpsEvent.bindEvent(this.map,"vendorChanged",this,this.mapVendorChanged);}YahooScalebar.prototype.setObj=function(){this.dom=document.createElement("div");this.dom.className="scalebar";this.dom.style.width="206px";this.dom.style.height="10px";this.dom.align="left";this.dom.style.bottom="1px";this.dom.style.right="1px";this.dom.style.zIndex=1;this.dom.style.font="normal 9px verdana";this.dom.style.position="absolute";var _2=document.createElement("div");_2.style.top="0px";this.setDivStyle(_2,this.zs_w,this.zs_h);var _3=this.getScaleImg(this.zsl_l,this.zsl_t);_2.appendChild(_3);_2._zsl=true;this.dom.appendChild(_2);this._skmm=document.createElement("div");this._skmm.style.top="3px";this.setDivStyle(this._skmm,206,4);for(var i=0;i<3;i++){var _5=this.getScaleImg(this.sk_l,this.sk_t);_5.style.left=(this.sk_w*i)+"px";this._skmm.appendChild(_5);}this._skmm._kml=true;this.dom.appendChild(this._skmm);var _6=document.createElement("div");_6.style.top="0px";this.setDivStyle(_6,this.zs_w,this.zs_h);var _7=this.getScaleImg(this.zsr_l,this.zsr_t);_6.appendChild(_7);_6._zsr=true;this.dom.appendChild(_6);this._km=document.createElement("span");this._km.innerHTML="";this._km.style.position="absolute";this._km.style.top="-1px";this._km.style.right="0px";this._km._kmt=true;this.dom.appendChild(this._km);this.map.getContainer().appendChild(this.dom);};YahooScalebar.prototype.getScaleImg=function(l,t){var _a=document.createElement("img");_a.style.border="0px none";_a.style.margin="0px";_a.style.padding="0px";_a.style.position="absolute";_a.style.left=l+"px";_a.style.top=t+"px";_a.style.width=this.ui_w+"px";_a.style.height=this.ui_h+"px";_a.style.filter="";_a.src=this._preImg.src;if(_bi.type==1){_a.unselectable="on";_a.onselectstart=Nothing;_a.galleryImg="no";}else{_a.style.MozUserSelect="none";}_a.oncontextmenu=Nothing;_AlphaImageLoader(_a,this.ui_w,this.ui_h);return _a;};YahooScalebar.prototype.setDivStyle=function(_b,w,h){_b.style.overflow="hidden";_b.style.width=w+"px";_b.style.height=h+"px";_b.style.position="absolute";};YahooScalebar.prototype.mapMapMoved=function(){this.update();};YahooScalebar.prototype.mapLayerChanged=function(){this.update();};YahooScalebar.prototype.mapPackageChanged=function(){this.update();};YahooScalebar.prototype.mapVendorChanged=function(){this.update();};YahooScalebar.prototype.update=function(){this._setunits();for(var i=0;i<this.dom.childNodes.length;i++){if(this.dom.childNodes[i]._kml){this.dom.childNodes[i].style.width=this.pkm+"px";}if(this.dom.childNodes[i]._kmt){var _f=this.map.getCurrentPackageId();if(_f=="aero"){this.dom.childNodes[i].style.color="white";}else{this.dom.childNodes[i].style.color="black";}this.dom.childNodes[i].innerHTML=this.ukm;}}for(var i=0;i<this.dom.childNodes.length;i++){var _10=this._km.offsetWidth;if(this.dom.childNodes[i]._zsr){this.dom.childNodes[i].style.right=_10+"px";}if(this.dom.childNodes[i]._kml){this.dom.childNodes[i].style.right=(_10+this.zs_w)+"px";}if(this.dom.childNodes[i]._zsl){this.dom.childNodes[i].style.right=(_10+this.zs_w+this._skmm.offsetWidth)+"px";}}};YahooScalebar.prototype._setunits=function(){var len=10;var _12=this.map.log2LatLon(new Point(this.map.getContainer().offsetWidth/2-len/2,this.map.getContainer().offsetHeight/2));var _13=this.map.log2LatLon(new Point(this.map.getContainer().offsetWidth/2+len/2,this.map.getContainer().offsetHeight/2));var _14=_12.distance(_13);len*=12;_14*=12;var a=10;while(true){if(_14<a){var b=a/10;temp=Math.floor(_14/b)*b;len=len*temp/_14;_14=temp;break;}a*=10;}this.pkm=len;this.ukm=_14<500?Math.round(_14)+" m":Math.round(_14/1000)+" km";};
function YGeoRSS(m,ms,_3){this.rssData=null;this.catId=null;this.waiwaiData=null;this.waiwaiCatId=null;this.waiwaiOption=new Object();this.url="";this.m=m;this.ms=ms;this.strYid=decodeURIComponent("%e3%81%95%e3%82%93");this.strCommentCount=decodeURIComponent("%e3%82%b3%e3%83%a1%e3%83%b3%e3%83%88");this.strMap=decodeURIComponent("%e5%9c%b0%e5%9b%b3%ef%bc%9a");this.strZoom=decodeURIComponent("%e6%8b%a1%e5%a4%a7");this.strInit=decodeURIComponent("%e5%88%9d%e6%9c%9f%e8%a1%a8%e7%a4%ba");this.strClose=decodeURIComponent("%e9%96%89%e3%81%98%e3%82%8b");this.strSite=decodeURIComponent("%e9%96%a2%e9%80%a3%e3%82%b5%e3%82%a4%e3%83%88%e3%82%92%e8%a6%8b%e3%82%8b");AlpsEvent.bindEvent(this,"yGeoRSSLoaded",this,this.yGeoRSSLoaded);if(_3){AlpsEvent.addEvent(this,"yGeoRSSLoaded",_3);}YGeoRSS.waiwai=this;this.initPos=this.m.getCenterLatLon();this.initLayerId=this.m.getCurrentLayerId();}YGeoRSS.prototype.yGeoRSSLoaded=function(_4){AlpsEvent.triggerEvent(this,"yGeoRSSLoaded",_4);};YGeoRSS.prototype.addContents=function(){if(!this.rssData||!this.rssData.rss){return;}var r=this.rssData.rss;if(!r["@attributes"]){return;}if(r["@attributes"].version=="2.0"){var _6=r.channel.item;if(_6){if(_IsArray(_6)){for(var i=0;i<_6.length;i++){var _8=_6[i];var id=_8.guid;var _a=_8.title;var p=null;if(_8["georss:point"]){var _c=_8["georss:point"].split(" ");if(_c.length>1){p=new LLPoint(_c[0],_c[1]);}}else{if(_8["geo:Point"]){p=new LLPoint(_8["geo:Point"]["geo:lat"],_8["geo:Point"]["geo:long"]);}}if(!p){continue;}var _d=p;var _e=this.catId;var _f=this.createRssPopup(_8);var p=new MapsvrPOI(id,_a,_d,_e,_f);this.ms.addContents(p,true);}}else{var _8=_6;var id=_8.guid;var _a=_8.title;var p=null;if(_8["georss:point"]){var _c=_8["georss:point"].split(" ");if(_c.length>1){p=new LLPoint(_c[0],_c[1]);}}else{if(_8["geo:Point"]){p=new LLPoint(_8["geo:Point"]["geo:lat"],_8["geo:Point"]["geo:long"]);}}if(p){var _d=p;var _e=this.catId;var _f=this.createRssPopup(_8);var p=new MapsvrPOI(id,_a,_d,_e,_f);this.ms.addContents(p,true);}}this.ms.findContents();}}};YGeoRSS.prototype.addWaiwai=function(){var _10=this.waiwaiData.Item;if(_10){for(var i=0;i<_10.length;i++){var Poi=_10[i];var id=Poi.PoiId;var _14=Poi.Name;var pos=new LLPoint(Poi.Lat,Poi.Lon);var cat=Poi.WaiwaiDetailData.IconId;var _17=this.createWaiwaiPopup(Poi);var p=new MapsvrPOI(id,_14,pos,cat,_17);this.ms.addContents(p,true);}this.ms.findContents();}};YGeoRSS.prototype.createRssPopup=function(_19){var _1a="";_1a+="<table style='width:256px;overflow:auto;'>";if(_19.link){if(_19.title){_1a+="<tr><td><span style='font-weight:bold;'><a href='"+_19.link+"'>"+_19.title+"</a></span></td></tr>";}else{_1a+="<tr><td><span style='font-weight:bold;'><a href='"+_19.link+"'>"+_19.link+"</a></span></td></tr>";}}else{if(_19.title){_1a+="<tr><td><span style='font-weight:bold;'>"+_19.title+"</span></td></tr>";}}if(_19.description){_1a+="<tr><td>"+_19.description+"</td></tr>";}_1a+="<tr><td><br><br>";if(_19.author){_1a+="<span>author: "+_19.author+"</span><br>";}if(_19.category){_1a+="<span>category: "+_19.category+"</span><br>";}if(_19.comments){_1a+="<span>comments: "+_19.comments+"</span><br>";}if(_19.enclosureUrl){_1a+="<span>enclosure: <a href='"+_19.enclosureUrl+"'>"+_19.enclosureUrl+"</a></span><br>";}if(_19.sourceUrl){if(_19.source){_1a+="<span>source: <a href='"+_19.sourceUrl+"'>"+_19.source+"</a></span><br>";}else{_1a+="<span>source: <a href='"+_19.sourceUrl+"'>"+_19.sourceUrl+"</a></span><br>";}}else{if(_19.source){_1a+="<span>source: "+_19.source+"</span><br>";}}if(_19.pubDate){_1a+="<span>pubDate: "+_19.pubDate+"</span>";}_1a+="</td></tr>";_1a+="</table>";return _1a;};YGeoRSS.prototype.createWaiwaiPopup=function(poi){var dd=poi.DetailData;var wd=poi.WaiwaiDetailData;var _1e="";_1e+="<div style=\"width:420px; font-size:12px;\">";_1e+="<div style=\"margin:0px; padding:0px;\">";_1e+="<div style=\"white-space:normal; padding-left:5px; padding-right:5px; padding-bottom:5px; font-weight:bold;\"><a href=\""+dd.PcUrl+"\" style=\"color:midnightblue;\">"+wd.Title+"</a></div>";_1e+="<div style=\"float:right; padding-top:3px; padding-right:8px; text-align:center;\">";if(dd.ImageUrl){_1e+="<img src=\""+dd.ImageUrl+"\">";}else{_1e+="<img src=\"http://i.yimg.jp/images/map/yy/images/no_image_120-120.gif\">";}_1e+="</div>";var con=wd.Contents;if(wd.Contents.length>160){con=con.substring(0,160)+"...";}var _20=con.match(/(.*<br \/>){5}/);if(_20){con=_20[0]+"...";}_1e+="<div style=\"padding-left:10px; padding-right:5px; width:270px;\"><table><tr><td style=\"white-space:normal;height:130px;line-height:160%;\" valign=\"top\">"+con+"</td></tr></table></div>";_1e+="<div style=\"margin-left:5px;\">";_1e+="<div style=\"line-height:160%;\">";_1e+="<a href=\""+dd.PcUrl+"\"><img border=\"0\" src=\"http://i.yimg.jp/images/map/yy/images/detail_btn.gif\" style=\"vertical-align:middle;\"/></a>&nbsp;<a href=\""+dd.PcUrl+"\" style=\"color:midnightblue;\">"+this.strCommentCount+"("+wd.CommentCount+")</a>";if(wd.Url){_1e+="&nbsp;<a href=\""+wd.Url+"\" style=\"color:midnightblue;\">"+this.strSite+"</a>";}_1e+="<br>";_1e+="[ "+this.strMap+" <a href=\"javascript:YGeoRSS.waiwai.zoom('"+poi.PoiId+"');\" style=\"color:midnightblue;\">"+this.strZoom+"</a> | <a href=\"javascript:YGeoRSS.waiwai.home();\" style=\"color:midnightblue;\">"+this.strInit+"</a> ]<br>";_1e+="</div>";_1e+="<div style=\"margin-top:5px\">"+wd.Createdate+"</div>";_1e+="</div>";_1e+="</div>";_1e+="</div>";return _1e;};YGeoRSS.prototype.zoom=function(_21){var poi=this.ms.getContents(_21);this.m.moveTo(poi.pos);this.m.layerTo(0);};YGeoRSS.prototype.home=function(_23){this.m.moveTo(this.initPos);this.m.layerTo(this.initLayerId);};YGeoRSS.prototype.addWaiwaiPopup=function(){var id="_waiwai_popup";var _25="<span id=\"_waiwai_popup_message\"></span>";if(!document.getElementById(id)){var _26=document.createElement("div");var pos="top:cright";var dx=210;_26.id=id;_26.setAttribute("pos",pos);_26.setAttribute("dx",dx);_26.style.zIndex=0;_26.style.display="none";_26.style.position="absolute";_26.innerHTML=_25;document.body.appendChild(_26);}this.ms.popupId=id;};YGeoRSS.prototype.clearRss=function(){this.rssData=null;};YGeoRSS.prototype.clearWaiwai=function(){this.waiwaiData=null;};YGeoRSS.prototype.setWaiwaiMid=function(mid){this.waiwaiOption["mid"]=mid;};YGeoRSS.prototype.setWaiwaiLimit=function(c){this.waiwaiOption["n"]=c;};YGeoRSS.prototype.setWaiwaiSort=function(s){this.waiwaiOption["sort"]=s;};YGeoRSS.prototype.setWaiwaiOption=function(s){for(var key in s){this.waiwaiOption[key]=s[key];}};YGeoRSS.prototype.getWaiwaiOption=function(){return this.waiwaiOption;};YGeoRSS.prototype.loadXML=function(u){var url="http://map.yahooapis.jp/MapsService/georss2json"+"?callback=_ygrcb.invoke"+"&url="+encodeURIComponent(u);this.url=url;var _30=this;_ygrcb.send(this.url,function(_31){if(_31){_30.removeContents();_30.rssData=_31;_30.addContents();AlpsEvent.triggerEvent(_30,"yGeoRSSLoaded",_31);}else{}});};YGeoRSS.prototype.loadWaiwai=function(){var url="http://map.yahooapis.jp/MapsService/WaiwaiService/V1/searchSpots.php"+"?callback=_ygrcb.invoke"+"&output=json";var op=new Object();if(this.waiwaiOption["sort"]=="distance"||this.waiwaiOption["sort"]==undefined||this.waiwaiOption["sort"]==""){var cp=this.m.getCenterLatLon();var bl=this.m.log2LatLon(new Point(0,0));var _36=cp.distance(bl)/1000;op["lat"]=cp.lat;op["lon"]=cp.lon;op["dist"]=_36;}for(var key in this.waiwaiOption){if(key!="output"){op[key]=this.waiwaiOption[key];}}for(var key in op){if(op[key]!=""){url+="&"+key+"="+op[key];}}this.url=url;var _38=this;_ygrcb.send(this.url,function(_39){if(_39){_38.removeWaiwai();_38.waiwaiData=_39;_38.addWaiwai();AlpsEvent.triggerEvent(_38,"yGeoRSSLoaded",_39);}else{}});};YGeoRSS.prototype.setCategory=function(id){this.catId=id;};YGeoRSS.prototype.setWaiwaiCategories=function(id){this.waiwaiCatId=id;};YGeoRSS.prototype.removeContents=function(){if(!this.rssData||!this.rssData.rss){return;}var r=this.rssData.rss;if(!r["@attributes"]){return;}if(r["@attributes"].version=="2.0"){var _3d=r.channel.item;if(_3d){if(_IsArray(_3d)){var num=_3d.length;for(var i=0;i<num;i++){this.ms.removeContents(_3d[i].guid,true);}}else{this.ms.removeContents(_3d.guid,true);}}}};YGeoRSS.prototype.removeWaiwai=function(){if(this.waiwaiData&&this.waiwaiData.Item){var num=this.waiwaiData.Item.length;for(var i=0;i<num;i++){this.ms.removeContents(this.waiwaiData.Item[i].PoiId,true);}}};YGeoRSS.prototype.showIcon=function(){var id=this.catId;var _43=this.ms.category._indexOf(id);if(_43<0){this.ms.category.push(id);}this.ms.findContents();};YGeoRSS.prototype.showWaiwaiIcon=function(){for(var i=0;i<this.waiwaiCatId.length;i++){var id=this.waiwaiCatId[i];var _46=this.ms.category._indexOf(id);if(_46<0){this.ms.category.push(id);}}this.ms.findContents();};YGeoRSS.prototype.hideIcon=function(){var id=this.catId;var _48=this.ms.category._indexOf(id);if(_48>=0){this.ms.category.splice(_48,1);}this.ms.findContents();};YGeoRSS.prototype.hideWaiwaiIcon=function(){for(var i=0;i<this.waiwaiCatId.length;i++){var id=this.waiwaiCatId[i];var _4b=this.ms.category._indexOf(id);if(_4b>=0){this.ms.category.splice(_4b,1);}}this.ms.findContents();};YGeoRSS.prototype.getData=function(){return this.rssData;};YGeoRSS.prototype.getWaiwaiData=function(){return this.waiwaiData;};YGeoRSS.waiwai=null;function YGeoRSSCallback(){this.cb=new Array();this.timeout=12500;}YGeoRSSCallback.prototype.send=function(url,_4d){var cb=new Object();cb.id="ID"+(new Date().getTime().toString(16))+Math.floor(Math.random()*10000);cb.callback=_4d;var scr=document.createElement("script");scr.id=cb.id;scr.src=url;scr.type="text/javascript";this.cb.push(cb);document.body.appendChild(scr);};YGeoRSSCallback.prototype.invoke=function(){var _50=this.cb[0].callback;if(!_50){return;}var _51=new Array();for(var i=0;i<arguments.length;i++){_51.push(arguments[i]);}var id=this.cb[0].id;setTimeout(function(){document.body.removeChild(document.getElementById(id));},1500);this.cb.shift();_50.apply(this,_51);};function _IsArray(a){return (a.constructor===Array);}var _ygrcb=new YGeoRSSCallback();
function AlpsGraphics(e){if(!e){return;}this.container=e;if(document.namespaces){this.type=AlpsGraphics.RENDERING.VML;}else{if(document.createElementNS){this.svg_xmlns="http://www.w3.org/2000/svg";var _2=document.createElementNS(this.svg_xmlns,"svg");if(_2.width){this.type=AlpsGraphics.RENDERING.SVG;}_2=null;delete _2;}}if(!this.type&&document.createElement("canvas").getContext){this.type=AlpsGraphics.RENDERING.CANVAS;}if(!this.type){return;}while(this.container.hasChildNodes()){this.container.removeChild(this.container.firstChild);}switch(this.type){case AlpsGraphics.RENDERING.VML:if(!document.namespaces.v){document.namespaces.add("v","urn:schemas-microsoft-com:vml");var _3="behavior:url(#default#VML);margin:auto;";if(_bi.version<=7){document.createStyleSheet().addRule("v\\:*",_3);}else{var _4=[];_4.push("v\\:stroke");_4.push("v\\:polyline");_4.push("v\\:fill");_4.push("v\\:oval");var s=document.createStyleSheet();s.cssText=_4.join(",")+"{"+_3+"}";}}break;case AlpsGraphics.RENDERING.CANVAS:this.canvas=document.createElement("canvas");this.canvas.setAttribute("width",this.container.offsetWidth);this.canvas.setAttribute("height",this.container.offsetHeight);this.container.appendChild(this.canvas);break;case AlpsGraphics.RENDERING.SVG:this.svg=document.createElementNS(this.svg_xmlns,"svg");this.svg.setAttribute("width",this.container.offsetWidth);this.svg.setAttribute("height",this.container.offsetHeight);this.svg.setAttribute("viewBox","0 0 "+this.container.offsetWidth+" "+this.container.offsetHeight);this.svg.style.position="relative";this.container.appendChild(this.svg);break;default:break;}this.strokeColor=[0,0,255];this.strokeOpacity=1;this.fillColor=[255,0,0];this.fillOpacity=0.5;}AlpsGraphics.prototype.getContainer=function(){return this.container;};AlpsGraphics.prototype.clear=function(){if(!this.type){return;}switch(this.type){case AlpsGraphics.RENDERING.VML:while(this.container.hasChildNodes()){this.container.removeChild(this.container.firstChild);}break;case AlpsGraphics.RENDERING.CANVAS:var _6=this.canvas.getContext("2d");_6.clearRect(0,0,this.canvas.width,this.canvas.height);break;case AlpsGraphics.RENDERING.SVG:while(this.svg.hasChildNodes()){this.svg.removeChild(this.svg.firstChild);}break;default:break;}};AlpsGraphics.prototype.setStrokeColor=function(_7){if(!this.type){return;}if(arguments.length==3){for(var i=0;i<3;i++){this.strokeColor[i]=parseInt(arguments[i]);}}else{if(typeof (_7)=="string"){for(var i=0;i<3;i++){this.strokeColor[i]=parseInt("0x"+_7.substr(i*2,2));}}}};AlpsGraphics.prototype.setStrokeOpacity=function(_9){if(!this.type){return;}this.strokeOpacity=_9;};AlpsGraphics.prototype.setFillColor=function(_a){if(!this.type){return;}if(arguments.length==3){for(var i=0;i<3;i++){this.fillColor[i]=parseInt(arguments[i]);}}else{if(typeof (_a)=="string"){for(var i=0;i<3;i++){this.fillColor[i]=parseInt("0x"+_a.substr(i*2,2));}}}};AlpsGraphics.prototype.setFillOpacity=function(_c){if(!this.type){return;}this.fillOpacity=_c;};AlpsGraphics.prototype.drawLine=function(p,w){if(!this.type){return;}switch(this.type){case AlpsGraphics.RENDERING.VML:var _f=document.createElement("v:polyline");if(!w||!this.strokeOpacity){_f.stroked=false;}_f.filled=false;var _10=new Array();for(var i=0;i<p.length;i++){_10.push(p[i].x);_10.push(p[i].y);}_f.points=_10.join(",");var _12=document.createElement("v:stroke");_12.weight=w+"px";_12.color="rgb("+this.strokeColor.join(",")+")";_12.opacity=this.strokeOpacity;_12.endcap="round";_12.joinstyle="round";_f.appendChild(_12);this.container.appendChild(_f);break;case AlpsGraphics.RENDERING.CANVAS:var ctx=this.canvas.getContext("2d");ctx.strokeStyle="rgba("+this.strokeColor.join(",")+","+this.strokeOpacity+")";ctx.lineWidth=w;ctx.lineCap="round";ctx.lineJoin="round";ctx.beginPath();ctx.moveTo(p[0].x,p[0].y);for(var i=1;i<p.length;i++){ctx.lineTo(p[i].x,p[i].y);}ctx.stroke();break;case AlpsGraphics.RENDERING.SVG:var pl=document.createElementNS(this.svg_xmlns,"path");var _15=p.length;var _10=new Array();for(var i=0;i<_15;i++){if(i>=1){_10.push("L "+p[i].x+","+p[i].y);}else{_10.push("M "+p[i].x+","+p[i].y);}}pl.setAttribute("d",_10.join(" "));pl.setAttribute("fill","none");pl.setAttribute("stroke","rgb("+this.strokeColor.join(",")+")");pl.setAttribute("stroke-opacity",this.strokeOpacity);pl.setAttribute("stroke-width",w);pl.setAttribute("stroke-linecap","round");pl.setAttribute("stroke-linejoin","round");this.svg.appendChild(pl);break;default:break;}};AlpsGraphics.prototype.drawArea=function(p,w){if(!this.type){return;}switch(this.type){case AlpsGraphics.RENDERING.VML:var _18=document.createElement("v:polyline");if(!w||!this.strokeOpacity){_18.stroked=false;}if(!this.fillOpacity){_18.filled=false;}var _19=new Array();for(var i=0;i<p.length;i++){_19.push(p[i].x);_19.push(p[i].y);}if(p[0].x!=p[p.length-1].x||p[0].y!=p[p.length-1].y){_19.push(p[0].x);_19.push(p[0].y);}_18.points=_19.join(",");var _1b=document.createElement("v:fill");_1b.color="rgb("+this.fillColor.join(",")+")";_1b.opacity=this.fillOpacity;_18.appendChild(_1b);var _1c=document.createElement("v:stroke");_1c.weight=w+"px";_1c.color="rgb("+this.strokeColor.join(",")+")";_1c.opacity=this.strokeOpacity;_1c.endcap="round";_1c.joinstyle="round";_18.appendChild(_1c);this.container.appendChild(_18);break;case AlpsGraphics.RENDERING.CANVAS:var ctx=this.canvas.getContext("2d");ctx.strokeStyle="rgba("+this.strokeColor.join(",")+","+this.strokeOpacity+")";ctx.fillStyle="rgba("+this.fillColor.join(",")+","+this.fillOpacity+")";ctx.lineWidth=w;ctx.lineCap="round";ctx.lineJoin="round";if(this.fillOpacity){ctx.beginPath();ctx.moveTo(p[0].x,p[0].y);for(var i=1;i<p.length;i++){ctx.lineTo(p[i].x,p[i].y);}ctx.closePath();ctx.fill();}if(w&&this.strokeOpacity){ctx.beginPath();ctx.moveTo(p[0].x,p[0].y);for(var i=1;i<p.length;i++){ctx.lineTo(p[i].x,p[i].y);}ctx.closePath();ctx.stroke();}break;case AlpsGraphics.RENDERING.SVG:var pl=document.createElementNS(this.svg_xmlns,"path");var _1f=p.length;var _19=new Array();for(var i=0;i<_1f;i++){if(i>=1){_19.push("L "+p[i].x+","+p[i].y);}else{_19.push("M "+p[i].x+","+p[i].y);}if(i==(_1f-1)){_19.push(" z");}}pl.setAttribute("d",_19.join(" "));pl.setAttribute("fill","none");pl.setAttribute("stroke","rgb("+this.strokeColor.join(",")+")");pl.setAttribute("stroke-opacity",this.strokeOpacity);pl.setAttribute("stroke-width",w);pl.setAttribute("stroke-linecap","round");pl.setAttribute("stroke-linejoin","round");pl.setAttribute("fill","rgb("+this.fillColor.join(",")+")");pl.setAttribute("fill-opacity",this.fillOpacity);pl.style.overflow="hidden";this.svg.appendChild(pl);break;default:break;}};AlpsGraphics.prototype.drawCircle=function(p,r,w){if(!this.type){return;}switch(this.type){case AlpsGraphics.RENDERING.VML:var _23=document.createElement("v:oval");if(!w||!this.strokeOpacity){_23.stroked=false;}if(!this.fillOpacity){_23.filled=false;}_23.style.position="absolute";_23.style.left=(p.x-r)+"px";_23.style.top=(p.y-r)+"px";_23.style.width=(r*2)+"px";_23.style.height=(r*2)+"px";this.container.appendChild(_23);var _24=document.createElement("v:fill");_24.color="rgb("+this.fillColor.join(",")+")";_24.opacity=this.fillOpacity;_23.appendChild(_24);var _25=document.createElement("v:stroke");_25.weight=w+"px";_25.color="rgb("+this.strokeColor.join(",")+")";_25.opacity=this.strokeOpacity;_25.endcap="round";_25.joinstyle="round";_23.appendChild(_25);break;case AlpsGraphics.RENDERING.CANVAS:var ctx=this.canvas.getContext("2d");ctx.strokeStyle="rgba("+this.strokeColor.join(",")+","+this.strokeOpacity+")";ctx.fillStyle="rgba("+this.fillColor.join(",")+","+this.fillOpacity+")";ctx.lineWidth=w;ctx.lineCap="round";ctx.lineJoin="round";if(this.fillOpacity){ctx.beginPath();ctx.moveTo(p.x+r,p.y);ctx.arc(p.x,p.y,r,0,Math.PI*2,true);ctx.fill();}if(w&&this.strokeOpacity){ctx.beginPath();ctx.moveTo(p.x+r,p.y);ctx.arc(p.x,p.y,r,0,Math.PI*2,true);ctx.stroke();}break;case AlpsGraphics.RENDERING.SVG:var c=document.createElementNS(this.svg_xmlns,"circle");c.setAttribute("cx",p.x);c.setAttribute("cy",p.y);c.setAttribute("r",r);c.setAttribute("fill","none");c.setAttribute("stroke","rgb("+this.strokeColor.join(",")+")");c.setAttribute("stroke-opacity",this.strokeOpacity);c.setAttribute("stroke-width",w);c.setAttribute("stroke-linecap","round");c.setAttribute("stroke-linejoin","round");c.setAttribute("fill","rgb("+this.fillColor.join(",")+")");c.setAttribute("fill-opacity",this.fillOpacity);this.svg.appendChild(c);break;}};if(!AlpsGraphics.RENDERING){AlpsGraphics.RENDERING={};}AlpsGraphics.RENDERING.VML=1;AlpsGraphics.RENDERING.CANVAS=2;AlpsGraphics.RENDERING.SVG=3;
function VectorDrawing(_1,_2){this.map=_1;this.ms=_2;this.vectorPopupOrigin="";this.vectorMin=-1500;this.vectorMax=1500;this.bVectorClickPopup=true;this.bVectorPopupOpen=false;this.isMouseDragged=false;var _3=new Point((this.map.mapWidth/2),(this.map.mapHeight/2));this.scrollOffset=new Point((this.vectorMin+_3.x),(this.vectorMin+_3.y));this.vectorContainer=document.createElement("div");this.vectorContainer.id="_vector_graphics";if(_bi){if(_bi.type==2||_bi.type==4){var s=document.createElement("style");if(s){s.innerHTML="@media print{div#_vector_graphics{display:none;}}";var _5=document.getElementsByTagName("head");if(_5){if(_5.length>0){_5[0].appendChild(s);}else{var h=document.createElement("head");if(h){h.appendChild(s);document.appendChild(h);}}}}}}var _7=this.vectorContainer.style;_7.position="absolute";_7.top=(this.vectorMin+_3.y)+"px";_7.left=(this.vectorMin+_3.x)+"px";_7.textAlign="justify";_7.width=(this.vectorMax*2)+"px";_7.height=(this.vectorMax*2)+"px";if(!this.ms.canvas){this.ms.initCanvas();}this.ms.canvas.insertBefore(this.vectorContainer,this.ms.canvas.firstChild);this.vectorGraphics=new AlpsGraphics(this.vectorContainer);this.vectorData=new Array();if(this.vectorGraphics.type===AlpsGraphics.RENDERING.SVG){var _8=this.vectorGraphics.svg;_8.style.position="";_8.style.top=this.vectorMin+"px";_8.style.left=this.vectorMin+"px";}}VectorDrawing.prototype.drawPolyline=function(_9){var p=new Array();var _b=_9["latlon"].length;for(var i=0;i<_b;i++){p[i]=this.map.latLon2Log(_9["latlon"][i]);p[i].x-=this.scrollOffset.x;p[i].y-=this.scrollOffset.y;}var _d=new Point((this.vectorMax*2),(this.vectorMax*2));var _e=new Point(0,0);p=this.getClippingPointOnFixedCanvas(p,"polyline",_d,_e);if(p.length==0){return false;}this.vectorGraphics.setStrokeColor(_9["strokeColor"]);this.vectorGraphics.setStrokeOpacity(_9["strokeOpacity"]);this.vectorGraphics.drawLine(p,_9["strokeWidth"],_9["popup"]);};VectorDrawing.prototype.drawPolygon=function(_f){var p=new Array();var len=_f["latlon"].length;for(var i=0;i<len;i++){p[i]=this.map.latLon2Log(_f["latlon"][i]);p[i].x-=this.scrollOffset.x;p[i].y-=this.scrollOffset.y;}var _13=new Point((this.vectorMax*2),(this.vectorMax*2));var _14=new Point(0,0);p=this.getClippingPointOnFixedCanvas(p,"polygon",_13,_14);if(p.length==0){return false;}this.vectorGraphics.setStrokeColor(_f["strokeColor"]);this.vectorGraphics.setStrokeOpacity(_f["strokeOpacity"]);this.vectorGraphics.setFillColor(_f["fillColor"]);this.vectorGraphics.setFillOpacity(_f["fillOpacity"]);this.vectorGraphics.drawArea(p,_f["strokeWidth"],_f["popup"]);};VectorDrawing.prototype.vectorClear=function(){this.vectorGraphics.clear();};VectorDrawing.prototype.setVectorContainerOrigin=function(){var _15=new Point((this.map.mapWidth/2),(this.map.mapHeight/2));var _16=this.vectorContainer.style;_16.top=(this.vectorMin+_15.y)+"px";_16.left=(this.vectorMin+_15.x)+"px";this.vectorContainerOrigin=this.map.log2LatLon(new Point((this.vectorMin+_15.x),(this.vectorMin+_15.y)));};VectorDrawing.prototype.setScrollOffset=function(p){var _18=new Point((this.map.mapWidth/2),(this.map.mapHeight/2));if(!p||p.constructor!=Point){this.scrollOffset=new Point((this.vectorMin+_18.x),(this.vectorMin+_18.y));return;}this.scrollOffset.x=(this.vectorMin+_18.x)+p.x;this.scrollOffset.y=(this.vectorMin+_18.y)+p.y;};VectorDrawing.prototype.getScrollOffset=function(){return new Point(this.scrollOffset.x,this.scrollOffset.y);};VectorDrawing.prototype.isNeedToRefresh=function(){var _19=this.map.mapWidth;var _1a=this.map.mapHeight;var _1b=0;var _1c=-((this.vectorMax*2)-_19);var _1d=0;var _1e=-((this.vectorMax*2)-_1a);switch(true){case this.scrollOffset.x>_1b:case this.scrollOffset.x<_1c:case this.scrollOffset.y>_1d:case this.scrollOffset.y<_1e:return true;break;default:return false;break;}};VectorDrawing.prototype.get2LinePointIntersection=function(p1,p2,p3,p4){var p=new Point(0,0);var a=p2.y-p1.y;var b=p1.x-p2.x;var u=(p2.y-p1.y)*p1.x-(p2.x-p1.x)*p1.y;var c=p4.y-p3.y;var d=p3.x-p4.x;var v=(p4.y-p3.y)*p3.x-(p4.x-p3.x)*p3.y;if(p3.equals(p4)){return new Point(p3.x,p3.y);}p.x=(d*u-b*v)/(a*d-b*c);p.y=(a*v-c*u)/(a*d-b*c);return p;};VectorDrawing.prototype.isIntersection=function(p1,p2,p3,p4){if(p1.x>=p2.x){if((p1.x<p3.x&&p1.x<p4.x)||(p2.x>p3.x&&p2.x>p4.x)){return false;}}else{if((p2.x<p3.x&&p2.x<p4.x)||(p1.x>p3.x&&p1.x>p4.x)){return false;}}if(p1.y>=p2.y){if((p1.y<p3.y&&p1.y<p4.y)||(p2.y>p3.y&p2.y>p4.y)){return false;}}else{if((p2.y<p3.y&&p2.y<p4.y)||(p1.y>p3.y&&p1.y>p4.y)){return false;}}if(((p1.x-p2.x)*(p3.y-p1.y)+(p1.y-p2.y)*(p1.x-p3.x))*((p1.x-p2.x)*(p4.y-p1.y)+(p1.y-p2.y)*(p1.x-p4.x))>0){return false;}if(((p3.x-p4.x)*(p1.y-p3.y)+(p3.y-p4.y)*(p3.x-p1.x))*((p3.x-p4.x)*(p2.y-p3.y)+(p3.y-p4.y)*(p3.x-p2.x))>0){return false;}return true;};VectorDrawing.prototype.isPointInPolygon=function(p,_2f){var _30=_2f.length;if(_30<1){return false;}if(_30==1){return p.x==_2f[0].x&&p.y==_2f[0].y;}for(var i=0,j=_30-1;i<_30;j=i++){if(_2f[i].y==_2f[j].y&&p.y==_2f[i].y&&((_2f[i].x<=p.x&&p.x<=_2f[j].x)||(_2f[j].x<=p.x&&p.x<=_2f[i].x))){return true;}else{if(_2f[i].y!=_2f[j].y&&((_2f[i].y<=p.y&&p.y<=_2f[j].y)||(_2f[j].y<=p.y&&p.y<=_2f[i].y))&&p.x==(_2f[j].x-_2f[i].x)*(p.y-_2f[i].y)/(_2f[j].y-_2f[i].y)+_2f[i].x){return true;}}}var _33=false;var yy=p.y+0.5;for(var i=0,j=_30-1;i<_30;j=i++){if(((_2f[i].y<=p.y&&p.y<_2f[j].y)||(_2f[j].y<=p.y&&p.y<_2f[i].y))&&p.x<(_2f[j].x-_2f[i].x)*(yy-_2f[i].y)/(_2f[j].y-_2f[i].y)+_2f[i].x){_33=!_33;}}return _33;};VectorDrawing.prototype.getClippingPoint=function(p,_36){var _37=false;var _38=false;var _39=p.length;for(var i=0;i<_39;i++){if(_37!=false){if(p[i].x>_37.x){_37.x=p[i].x;}if(p[i].y>_37.y){_37.y=p[i].y;}}else{_37=new Point(p[i].x,p[i].y);}if(_38!=false){if((p[i].x+0)<(_38.x+0)){_38.x=p[i].x;}if(p[i].y<_38.y){_38.y=p[i].y;}}else{_38=new Point(p[i].x,p[i].y);}}var _3b=new Array();var p3=new Point(_38.x,this.vectorMin);var p4=new Point(_37.x,this.vectorMin);_39=p.length;for(var i=0;i<_39;i++){var p1=new Point(p[i].x,p[i].y);var p2;if(!(i==_39-1)){p2=new Point(p[i+1].x,p[i+1].y);}else{p2=new Point(p[0].x,p[0].y);}if(p1.y>=this.vectorMin){_3b.push(p1);}if(i==_39-1&&_36=="polyline"){break;}if(this.isIntersection(p1,p2,p3,p4)){_3b.push(this.get2LinePointIntersection(p1,p2,p3,p4));}}var _40=new Array();p3=new Point(_38.x,this.vectorMax);p4=new Point(_37.x,this.vectorMax);_39=_3b.length;for(var i=0;i<_39;i++){var p1=new Point(_3b[i].x,_3b[i].y);var p2;if(!(i==_39-1)){p2=new Point(_3b[i+1].x,_3b[i+1].y);}else{p2=new Point(_3b[0].x,_3b[0].y);}if(p1.y<=this.vectorMax){_40.push(p1);}if(i==_39-1&&_36=="polyline"){break;}if(this.isIntersection(p1,p2,p3,p4)){_40.push(this.get2LinePointIntersection(p1,p2,p3,p4));}}_3b=new Array();p3=new Point(this.vectorMin,_38.y);p4=new Point(this.vectorMin,_37.y);var _39=_40.length;for(var i=0;i<_39;i++){var p1=new Point(_40[i].x,_40[i].y);var p2;if(!(i==_39-1)){p2=new Point(_40[i+1].x,_40[i+1].y);}else{p2=new Point(_40[0].x,_40[0].y);}if(p1.x>=this.vectorMin){_3b.push(p1);}if(i==_39-1&&_36=="polyline"){break;}if(this.isIntersection(p1,p2,p3,p4)){_3b.push(this.get2LinePointIntersection(p1,p2,p3,p4));}}_40=new Array();p3=new Point(this.vectorMax,_38.y);p4=new Point(this.vectorMax,_37.y);_39=_3b.length;for(var i=0;i<_39;i++){var p1=new Point(_3b[i].x,_3b[i].y);var p2;if(!(i==_39-1)){p2=new Point(_3b[i+1].x,_3b[i+1].y);}else{p2=new Point(_3b[0].x,_3b[0].y);}if(p1.x<=this.vectorMax){_40.push(p1);}if(i==_39-1&&_36=="polyline"){break;}if(this.isIntersection(p1,p2,p3,p4)){_40.push(this.get2LinePointIntersection(p1,p2,p3,p4));}}return _40;};VectorDrawing.prototype.getClippingPointOnFixedCanvas=function(p,_42,_43,_44){var _45=p.length;if(_45===0){return new Array();}var _46=p[0];var _47=new Point(_46.x,_46.y);var _48=new Point(_46.x,_46.y);for(var i=1;i<_45;i++){_46=p[i];if(_46.x>_47.x){_47.x=_46.x;}if(_46.y>_47.y){_47.y=_46.y;}if((_46.x+0)<(_48.x+0)){_48.x=_46.x;}if(_46.y<_48.y){_48.y=_46.y;}}var _4a=new Array();var p3=new Point(_48.x,_44.y);var p4=new Point(_47.x,_44.y);_45=p.length;for(var i=0;i<_45;i++){var p1=p[i];var p2;if(!(i==_45-1)){p2=p[i+1];}else{p2=p[0];}if(p1.y>=_44.y){_4a.push(p1);}if(i==_45-1&&_42=="polyline"){break;}if(this.isIntersection(p1,p2,p3,p4)){_4a.push(this.get2LinePointIntersection(p1,p2,p3,p4));}}var _4f=new Array();p3=new Point(_48.x,_43.y);p4=new Point(_47.x,_43.y);_45=_4a.length;for(var i=0;i<_45;i++){var p1=_4a[i];var p2;if(!(i==_45-1)){p2=_4a[i+1];}else{p2=_4a[0];}if(p1.y<=_43.y){_4f.push(p1);}if(i==_45-1&&_42=="polyline"){break;}if(this.isIntersection(p1,p2,p3,p4)){_4f.push(this.get2LinePointIntersection(p1,p2,p3,p4));}}_4a=new Array();p3=new Point(_44.x,_48.y);p4=new Point(_44.y,_47.y);var _45=_4f.length;for(var i=0;i<_45;i++){var p1=_4f[i];var p2;if(!(i==_45-1)){p2=_4f[i+1];}else{p2=_4f[0];}if(p1.x>=_44.x){_4a.push(p1);}if(i==_45-1&&_42=="polyline"){break;}if(this.isIntersection(p1,p2,p3,p4)){_4a.push(this.get2LinePointIntersection(p1,p2,p3,p4));}}_4f=new Array();p3=new Point(_43.x,_48.y);p4=new Point(_43.x,_47.y);_45=_4a.length;for(var i=0;i<_45;i++){var p1=_4a[i];var p2;if(!(i==_45-1)){p2=_4a[i+1];}else{p2=_4a[0];}if(p1.x<=_43.x){_4f.push(p1);}if(i==_45-1&&_42=="polyline"){break;}if(this.isIntersection(p1,p2,p3,p4)){_4f.push(this.get2LinePointIntersection(p1,p2,p3,p4));}}return _4f;};VectorDrawing.prototype.xIntersectionPoint=function(p_s,p_e,x0){var x1,y1,x2,y2,y0,m;x1=p_s.x;y1=p_s.y;x2=p_e.x;y2=p_e.y;if(x1==x2){y0=x2;}m=((y2-y1)<<12)/(x2-x1);y0=y1+((m*(x0-x1))>>12);return new Point(x0,y0);};VectorDrawing.prototype.yIntersectionPoint=function(p_s,p_e,y0){var x1,y1,x2,y2,x0,m;x1=p_s.x;y1=p_s.y;x2=p_e.x;y2=p_e.y;if(y1==y2){x0=y2;}m=((x2-x1)<<12)/(y2-y1);x0=x1+((m*(y0-y1))>>12);return new Point(x0,y0);};VectorDrawing.prototype.getPointLineDistance=function(p,lp1,lp2){var dx=(lp2.x-lp1.x);var dy=(lp2.y-lp1.y);var a=Math.pow(dx,2)+Math.pow(dy,2);var b=dx*(lp1.x-p.x)+dy*(lp1.y-p.y);var t=-b/a;if(t<0){t=0;}if(t>1){t=1;}tx=lp1.x+dx*t;ty=lp1.y+dy*t;return Math.sqrt(Math.pow((p.x-tx),2)+Math.pow((p.y-ty),2));};VectorDrawing.prototype.addVectorPopupEvent=function(id,_6b,_6c){var _6d=this.vectorGraphics.type;if(_6d===AlpsGraphics.RENDERING.VML){var pl=this.vectorGraphics.container.getElementsByTagName("polyline");if(pl.length>=1){var lc=pl[pl.length-1];if(lc){if(this.bVectorClickPopup){lc.onclick=_6c(id,_6b);}else{lc.onmouseover=_6c(id,_6b);}}}}else{if(_6d===AlpsGraphics.RENDERING.SVG){var pl=this.vectorGraphics.container.getElementsByTagNameNS(this.vectorGraphics.svg_xmlns,"path");if(pl.length>=1){var lc=pl[pl.length-1];if(lc){if(this.bVectorClickPopup){lc.onclick=_6c(id,_6b);}else{lc.onmouseover=_6c(id,_6b);}}}}}};
var _jsapiVersion="V2";var _imageServer="http://i.yimg.jp/images/map/flashapi/";var _newImageServer="http://i.yimg.jp/images/map/api/";var _yahoomap="";var _yahoopoi="<mapsvr> <poi> <category id=\"L1\"> <icon src=\""+_imageServer+"icon/pin_a_1.gif\" size=\"24\" dx=\"12\" dy=\"-12\"/> </category> <category id=\"L2\"> <icon src=\""+_imageServer+"icon/pin_a_2.gif\" size=\"24\" dx=\"12\" dy=\"-12\"/> </category> <category id=\"L3\"> <icon src=\""+_imageServer+"icon/pin_a_3.gif\" size=\"24\" dx=\"12\" dy=\"-12\"/> </category> <category id=\"L4\"> <icon src=\""+_imageServer+"icon/pin_a_4.gif\" size=\"24\" dx=\"12\" dy=\"-12\"/> </category> <category id=\"L5\"> <icon src=\""+_imageServer+"icon/pin_a_5.gif\" size=\"24\" dx=\"12\" dy=\"-12\"/> </category> <category id=\"S1\"> <icon src=\""+_imageServer+"icon/pin_b_1.gif\" size=\"16\" dx=\"8\" dy=\"-8\"/> </category> <category id=\"S2\"> <icon src=\""+_imageServer+"icon/pin_b_2.gif\" size=\"16\" dx=\"8\" dy=\"-8\"/> </category> <category id=\"S3\"> <icon src=\""+_imageServer+"icon/pin_b_3.gif\" size=\"16\" dx=\"8\" dy=\"-8\"/> </category> <category id=\"S4\"> <icon src=\""+_imageServer+"icon/pin_b_4.gif\" size=\"16\" dx=\"8\" dy=\"-8\"/> </category> <category id=\"S5\"> <icon src=\""+_imageServer+"icon/pin_b_5.gif\" size=\"16\" dx=\"8\" dy=\"-8\"/> </category> </poi> </mapsvr>";var _buf_yahoomap;var _delaytime=0;var _scalebar;var _defaultPos="35.39.26.180,139.43.56.868";var _defaultLayer=3;var _defaultMode="map";if(_jsapiVersion=="V2"){_defaultMode="worldmap";}var _defaultCategory="L1";var _jsapiurl=document.getElementsByTagName("script");_jsapiurl=_jsapiurl[_jsapiurl.length-1].src;var _address_yahoomap;function _initButton(e){var _2=function(e){CancelBubble(e);};e.onmouseover=_2;e.onmouseout=_2;e.onmousedown=_2;e.onmouseup=_2;e.onclick=_2;e.ondblclick=_2;e.style.cursor="pointer";}function YahooMapsCtrl(e,_5,_6,_7,_8,_9,_a){if(!e){return;}if(typeof (e)=="string"){e=document.getElementById(e);}if(!e){return;}if(_a){YMapMode.GUIDEMAP=_a;}this.defaultPos=new YLLPoint(_5||_defaultPos).toLLPoint();this.defaultLayer=_6||_defaultLayer;if(_jsapiVersion=="V2"&&_7=="map"){_7="worldmap";}this.defaultMode=_7||_defaultMode;this.defaultDatum=YDatumType.TOKYO97;if(_jsapiVersion=="multi"){if(_8==YDatumType.TOKYO97||_8==YDatumType.WGS84){this.defaultDatum=_8;}_yahoomap="<proatlasmap><defaultposition><mappackage>map</mappackage><position unit=\"dms\">35/10/1.869,136/53/4.810</position><scale>25000</scale></defaultposition><yahoolayerservername type=\"callback\">http://layer.map.yahoo.co.jp/yml</yahoolayerservername><datumconvservername>http://img.map.yahoo.co.jp/datum</datumconvservername><mappackage id=\"map\" name=\"\u5730\u56f3\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://t.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><layer name=\"2.5\u5343\u8a73\u7d30\"><scale>2500</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"1048575\" datum=\"wgs84\"><level>-2</level></projection></layer><layer name=\"5\u5343\u8a73\u7d30\"><scale>5000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"524287\" datum=\"wgs84\"><level>-1</level></projection></layer><layer name=\"1\u4e07\u8a73\u7d30\"><scale>10000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"262143\" datum=\"wgs84\"><level>0</level></projection></layer><layer name=\"2\u4e07\u8a73\u7d30\"><scale>20000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"131071\" datum=\"wgs84\"><level>1</level></projection></layer><layer name=\"2.5\u4e07\u8a73\u7d30\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>25000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"65535\" datum=\"wgs84\"><level>2</level></projection></layer><layer name=\"4\u4e07\u8a73\u7d30\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>40000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"32767\" datum=\"wgs84\"><level>3</level></projection></layer><layer name=\"7\u4e07\u5e83\u57df\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>70000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"16383\" datum=\"wgs84\"><level>4</level></projection></layer><layer name=\"13\u4e07\u5e83\u57df\"><scale>130000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"8191\" datum=\"wgs84\"><level>5</level></projection></layer><layer name=\"25\u4e07\u5e83\u57df\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>250000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"4095\" datum=\"wgs84\"><level>6</level></projection></layer><layer name=\"50\u4e07\u5e83\u57df\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>500000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"2047\" datum=\"wgs84\"><level>7</level></projection></layer><layer name=\"100\u4e07\u5e83\u57df\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>1000000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"1023\" datum=\"wgs84\"><level>8</level></projection></layer><layer name=\"160\u4e07\u5e83\u57df\"><scale>1600000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"1023\" datum=\"wgs84\"><level>8</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z09\"><scale>3051755</scale><projection type=\"YMercator\" vendor=\"alps\" minTileX=\"0\" maxTileX=\"511\" datum=\"wgs84\"><level>9</level></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"511\" datum=\"wgs84\"><level>9</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z10\"><scale>6103510</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"alps\" minTileX=\"0\" maxTileX=\"255\" datum=\"wgs84\"><level>10</level></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"255\" datum=\"wgs84\"><level>10</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z11\"><scale>12207019</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"alps\" minTileX=\"0\" maxTileX=\"127\" datum=\"wgs84\"><level>11</level></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"127\" datum=\"wgs84\"><level>11</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z12\"><scale>24414038</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"alps\" minTileX=\"0\" maxTileX=\"63\" datum=\"wgs84\"><level>12</level></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"63\" datum=\"wgs84\"><level>12</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z13\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>48828076</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"alps\" minTileX=\"0\" maxTileX=\"31\" datum=\"wgs84\"><level>13</level></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"31\" datum=\"wgs84\"><level>13</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z14\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>97656152</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"alps\" minTileX=\"0\" maxTileX=\"15\" datum=\"wgs84\"><level>14</level></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"15\" datum=\"wgs84\"><level>14</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z15\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>195312305</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"alps\" minTileX=\"0\" maxTileX=\"7\" datum=\"wgs84\"><level>15</level></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"7\" datum=\"wgs84\"><level>15</level></projection></layer><layer name=\"\u4e16\u754c\u7d22\u5f15Z16\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>390624609</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"alps\" minTileX=\"0\" maxTileX=\"3\" datum=\"wgs84\"><level>16</level></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"3\" datum=\"wgs84\"><level>16</level></projection></layer><layer name=\"\u4e16\u754c\u7d22\u5f15Z17\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>781249219</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"alps\" minTileX=\"0\" maxTileX=\"1\" datum=\"wgs84\"><level>17</level></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"1\" datum=\"wgs84\"><level>17</level></projection></layer><layer name=\"\u4e16\u754c\u7d22\u5f15Z18\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>1562498438</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"alps\" minTileX=\"0\" maxTileX=\"0\" datum=\"wgs84\"><level>18</level></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"0\" datum=\"wgs84\"><level>18</level></projection></layer></mappackage><mappackage id=\"aero\" name=\"\u5199\u771f\"><mapservername type=\"presplit\" format=\"jpg\" vendor=\"alps\">http://t.map.yahoo.co.jp/i/maps/a</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/ae/ximg</mapservername><layer name=\"2.5\u5343\u90fd\u5fc3\"><scale>2500</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"1048575\" datum=\"wgs84\"><level>-2</level></projection></layer><layer name=\"\uff11\uff0f\uff15\u5343\u822a\u7a7a\u5199\u771f\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://t.map.yahoo.co.jp/i/maps/a</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/ae/ximg</mapservername><scale>5000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"524287\" datum=\"wgs84\"><level>-1</level></projection></layer><layer name=\"\uff11\uff0f\uff11\u4e07\u822a\u7a7a\u5199\u771f\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://t.map.yahoo.co.jp/i/maps/a</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/ae/ximg</mapservername><scale>10000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"262143\" datum=\"wgs84\"><level>0</level></projection></layer><layer name=\"2\u4e07\u8a73\u7d30\"><scale>20000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"131071\" datum=\"wgs84\"><level>1</level></projection></layer><layer name=\"\uff11\uff0f\uff12\uff0e\uff15\u4e07\u822a\u7a7a\u5199\u771f\"><scale>25000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"65535\" datum=\"wgs84\"><level>2</level></projection></layer><layer name=\"4\u4e07\u8a73\u7d30\"><scale>40000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"32767\" datum=\"wgs84\"><level>3</level></projection></layer><layer name=\"\uff11\uff0f\uff17\u4e07\u885b\u661f\u5199\u771f\"><scale>70000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"16383\" datum=\"wgs84\"><level>4</level></projection></layer><layer name=\"13\u4e07\u5e83\u57df\"><scale>130000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"wgs84\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"8191\" datum=\"wgs84\"><level>5</level></projection></layer><layer name=\"\uff11\uff0f\uff12\uff15\u4e07\u885b\u661f\u5199\u771f\"><scale>250000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"wgs84\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"4095\" datum=\"wgs84\"><level>6</level></projection></layer><layer name=\"\uff11\uff0f\uff15\uff10\u4e07\u885b\u661f\u5199\u771f\"><scale>500000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"wgs84\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"2047\" datum=\"wgs84\"><level>7</level></projection></layer><layer name=\"\uff11\uff0f\uff11\uff10\uff10\u4e07\u885b\u661f\u5199\u771f\"><scale>1000000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"wgs84\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"1023\" datum=\"wgs84\"><level>8</level></projection></layer><layer name=\"160\u4e07\u5e83\u57df\"><scale>1600000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"wgs84\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"1023\" datum=\"wgs84\"><level>8</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z09\"><scale>3051755</scale><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"511\" datum=\"wgs84\"><level>9</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z10\"><scale>6103510</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"255\" datum=\"wgs84\"><level>10</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z11\"><scale>12207019</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"127\" datum=\"wgs84\"><level>11</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z12\"><scale>24414038</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"63\" datum=\"wgs84\"><level>12</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z13\"><scale>48828076</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"31\" datum=\"wgs84\"><level>13</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z14\"><scale>97656152</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"15\" datum=\"wgs84\"><level>14</level></projection></layer><layer name=\"\u4e16\u754c\u5730\u56f3Z15\"><scale>195312305</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"7\" datum=\"wgs84\"><level>15</level></projection></layer><layer name=\"\u4e16\u754c\u7d22\u5f15Z16\"><scale>390624609</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"3\" datum=\"wgs84\"><level>16</level></projection></layer><layer name=\"\u4e16\u754c\u7d22\u5f15Z17\"><scale>781249219</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"1\" datum=\"wgs84\"><level>17</level></projection></layer><layer name=\"\u4e16\u754c\u7d22\u5f15Z18\"><scale>1562498438</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"0\" datum=\"wgs84\"><level>18</level></projection></layer></mappackage><mappackage id=\"b1\" name=\"chika\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://t.map.yahoo.co.jp/i/maps/b1</mapservername><layer name=\"1250\"><scale>1250</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection></layer><layer name=\"2500\"><scale>2500</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection></layer><layer name=\"5000\"><scale>5000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection></layer></mappackage><vacanttile src=\"http://map.yahoo.co.jp/vacantTile.gif\"/></proatlasmap>";}else{if(_jsapiVersion=="V2"){if(_8==YDatumType.TOKYO97||_8==YDatumType.WGS84){this.defaultDatum=_8;}_yahoomap="<proatlasmap><defaultposition><mappackage>worldmap</mappackage><position unit=\"dms\">35/10/1.869,136/53/4.810</position><scale>25000</scale></defaultposition><yahoolayerservername type=\"callback\">http://layer.map.yahoo.co.jp/yml_v2</yahoolayerservername><datumconvservername>http://img.map.yahoo.co.jp/datum</datumconvservername><mappackage id=\"worldmap\"><mapservername type=\"presplit\" format=\"gif\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><layer><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://t.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>5000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"262143\" datum=\"wgs84\"><level>0</level></projection></layer><layer><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://t.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/hx/tl</mapservername><scale>10000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"131071\" datum=\"wgs84\"><level>1</level></projection></layer><layer><scale>25000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"65535\" datum=\"wgs84\"><level>2</level></projection></layer><layer><scale>70000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"16383\" datum=\"wgs84\"><level>4</level></projection></layer><layer><scale>250000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"4095\" datum=\"wgs84\"><level>6</level></projection></layer><layer><scale>500000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"2047\" datum=\"wgs84\"><level>7</level></projection></layer><layer><scale>1000000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"1023\" datum=\"wgs84\"><level>8</level></projection></layer><layer><scale>3000000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"511\" datum=\"wgs84\"><level>9</level></projection></layer><layer><scale>6103510</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"alps\" minTileX=\"0\" maxTileX=\"255\" datum=\"wgs84\"><level>10</level></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"255\" datum=\"wgs84\"><level>10</level></projection></layer><layer><scale>48828076</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"alps\" minTileX=\"0\" maxTileX=\"31\" datum=\"wgs84\"><level>13</level></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"31\" datum=\"wgs84\"><level>13</level></projection></layer><layer><scale>390624609</scale><scrollrange><top>84/59/55</top><bottom>-84/59/57</bottom></scrollrange><projection type=\"YMercator\" vendor=\"alps\" minTileX=\"0\" maxTileX=\"3\" datum=\"wgs84\"><level>16</level></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"3\" datum=\"wgs84\"><level>16</level></projection></layer></mappackage><mappackage id=\"aero\"><mapservername type=\"presplit\" format=\"jpg\" vendor=\"alps\">http://t.map.yahoo.co.jp/i/maps/a</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/ae/ximg</mapservername><layer><scale>5000</scale><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://t.map.yahoo.co.jp/i/maps/a</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/ae/ximg</mapservername><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"262143\" datum=\"wgs84\"><level>0</level></projection></layer><layer><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://t.map.yahoo.co.jp/i/maps/a</mapservername><mapservername type=\"yahoosplit\" format=\"png\" vendor=\"inc\">http://maps.yimg.com/ae/ximg</mapservername><scale>10000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"131071\" datum=\"wgs84\"><level>1</level></projection></layer><layer><scale>25000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"65535\" datum=\"wgs84\"><level>2</level></projection></layer><layer><scale>70000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"tokyo97\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"16383\" datum=\"wgs84\"><level>4</level></projection></layer><layer><scale>250000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"wgs84\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"4095\" datum=\"wgs84\"><level>6</level></projection></layer><layer><scale>500000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"wgs84\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"2047\" datum=\"wgs84\"><level>7</level></projection></layer><layer><scale>1000000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"wgs84\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"1023\" datum=\"wgs84\"><level>8</level></projection></layer><layer><scale>3000000</scale><projection type=\"Mercator\" vendor=\"alps\" datum=\"wgs84\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"511\" datum=\"wgs84\"><level>9</level></projection></layer><layer><scale>6103510</scale><scrollrange><top>89/9/14</top><bottom>-89/0/0</bottom></scrollrange><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"255\" datum=\"wgs84\"><level>10</level></projection></layer><layer><scale>48828076</scale><scrollrange><top>89/9/14</top><bottom>-89/0/0</bottom></scrollrange><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"31\" datum=\"wgs84\"><level>13</level></projection></layer><layer><scale>390624609</scale><scrollrange><top>89/9/14</top><bottom>-89/0/0</bottom></scrollrange><projection type=\"YMercator\" vendor=\"inc\" minTileX=\"0\" maxTileX=\"3\" datum=\"wgs84\"><level>16</level></projection></layer></mappackage><!-- centermark src=\"http://i.yimg.jp/images/maps/cursor/center_cursor.gif\" size=\"33\" / --><!-- autoscrollanchor src=\"http://i.yimg.jp/images/maps/cursor/drag_cursor.gif\" size=\"33\" / --><vacanttile src=\"http://map.yahoo.co.jp/vacantTile.gif\" /></proatlasmap>";}else{_yahoomap="<proatlasmap><defaultposition><mappackage>map</mappackage><position unit=\"msec\">126600000,492750000</position><scale>500000</scale></defaultposition><yahoolayerservername type=\"callback\">http://map.yahooapis.jp/ymap/YahooMapLayer</yahoolayerservername><datumconvservername>http://img.map.yahoo.co.jp/datum</datumconvservername><mappackage id=\"map\"><mapservername type=\"presplit\" format=\"gif\">http://tile01.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\">http://tile02.map.yahoo.co.jp/i/maps/m</mapservername><mapservername type=\"presplit\" format=\"gif\">http://tile03.map.yahoo.co.jp/i/maps/m</mapservername><layer><scale>5000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection></layer><layer><scale>10000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection></layer><layer><scale>25000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection></layer><layer><scale>70000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection></layer><layer><scale>250000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection></layer><layer><scale>500000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection></layer><layer><scale>1000000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection></layer><layer><scale>3000000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection></layer><layer><scale>5000000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection></layer><layer><scale>26000000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection></layer></mappackage><mappackage id=\"aero\"><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile01.map.yahoo.co.jp/i/maps/a</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile02.map.yahoo.co.jp/i/maps/a</mapservername><mapservername type=\"presplit\" format=\"gif\" vendor=\"alps\">http://tile03.map.yahoo.co.jp/i/maps/a</mapservername><layer><scale>5000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection></layer><layer><scale>10000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>sphere</ellipse></projection></layer><layer><scale>25000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection></layer><layer><scale>70000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection></layer><layer><scale>250000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection></layer><layer><scale>500000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection></layer><layer><scale>1000000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection></layer><layer><scale>3000000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection></layer><layer><scale>5000000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection></layer><layer><scale>26000000</scale><projection type=\"Mercator\"><origin unit=\"dms\">36/0/0,137/0/0</origin><ellipse>bessele</ellipse></projection></layer></mappackage><centermark src=\"http://i.yimg.jp/images/maps/cursor/center_cursor.gif\" size=\"33\" /><autoscrollanchor src=\"http://i.yimg.jp/images/maps/cursor/drag_cursor.gif\" size=\"32\" /><vacanttile src=\"http://map.yahoo.co.jp/vacantTile.gif\" /></proatlasmap>";}}var _b="";_b={"pos":this.defaultPos,"layerId":this.defaultLayer-1,"packageId":this.defaultMode,"datum":this.defaultDatum,"version":"v2"};if(_9){this.map=new ProAtlasMapCtrl(e,_9,"url",_b);}else{this.map=new ProAtlasMapCtrl(e,_yahoomap,"string",_b);}this.map.setVisibleCopyright(false);this.map.setEnableKeyboardOperation(false);this.map.setEnableZoomendFadeinEfct(true);this.map.setEnableAutoLayerChange(true);AlpsEvent.addEvent(this.map,"packageChanged",_func(this,"packageChanged"));this.ms=new MapsvrCtrl(this.map,_yahoopoi,"string",{label:true});this.ms.setEnableSearchOptimize(false);this.ms.setEnableLabel(true);AlpsEvent.addEvent(this.map,"mapMoved",_func(this,"mapMoved"));AlpsEvent.addEvent(this.map,"layerChanged",_func(this,"layerChanged"));AlpsEvent.addEvent(this.map,"layerListChanged",_func(this,"layerListChanged"));AlpsEvent.addEvent(this.map,"vendorChanged",_func(this,"vendorChanged"));AlpsEvent.addEvent(this.ms,"POIListChanged",_func(this,"poiListChanged"));AlpsEvent.addEvent(this.ms,"iconMoving",_func(this,"iconMoving"));AlpsEvent.addEvent(this.ms,"openPopup",_func(this,"onOpenPopup"));AlpsEvent.addEvent(this.ms,"closePopup",_func(this,"onClosePopup"));this.popupID=null;this.ms.showAllCategories();this.ui_src="http://i.yimg.jp/images/map/api/ui_jsapi2.png";this.ui_w=128;this.ui_h=186;var _c=document.createElement("div");_c.style.position="relative";_c.style.textAlign="left";_c.style.left="0px";_c.style.top="0px";_c.style.width="100%";_c.style.height="auto";_c.style.zIndex=1;_c.style.margin="0px";_c.style.padding="2px 1px 0px 1px";_c.style.border="0px";_c.oncontextmenu=Nothing;e.appendChild(_c);this.home=document.createElement("div");_initButton(this.home);_c.appendChild(this.home);this.home.className="homebutton";this.home.id="homebutton";this.home.title=decodeURIComponent("%E5%88%9D%E6%9C%9F%E4%BD%8D%E7%BD%AE%E3%81%AB%E7%A7%BB%E5%8B%95%E3%81%99%E3%82%8B");this.home.onclick=_func(this,"homeTo");this.setDivStyle(this.home,25,24);this.home.style.marginRight="5px";this.home.appendChild(this.getSliderImg(-75,-72));var _d=(this.getVisibleCentermark()==true?"%E4%B8%AD%E5%BF%83%E7%82%B9%E3%82%92%E9%9D%9E%E8%A1%A8%E7%A4%BA%E3%81%AB%E3%81%99%E3%82%8B":"%E4%B8%AD%E5%BF%83%E7%82%B9%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B");this.centerbutton=document.createElement("div");_initButton(this.centerbutton);_c.appendChild(this.centerbutton);this.centerbutton.style.display="none";this.centerbutton.className="centermarkbutton";this.centerbutton.id="centermarkbutton";this.centerbutton.title=decodeURIComponent(_d);this.centerbutton.onclick=_func(this,"centerMark");this.setDivStyle(this.centerbutton,25,24);this.centerbutton.style.margin="0px 1px";this.centerbutton_img=this.getSliderImg(0,-72);this.centerbutton.appendChild(this.centerbutton_img);this.b1button=document.createElement("div");_initButton(this.b1button);this.b1button.className="b1button";this.b1button.id="b1button";this.b1button.style.display="none";this.b1button.title=decodeURIComponent("%E3%82%AC%E3%82%A4%E3%83%89%E3%83%9E%E3%83%83%E3%83%97%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B");this.b1button.onclick=_func(this,"changeB1");this.setDivStyle(this.b1button,64,24);this.b1button.style.margin="0px 1px";this.b1button_img=this.getSliderImg(0,-162);this.b1button.appendChild(this.b1button_img);_c.appendChild(this.b1button);this.photobutton=document.createElement("div");_initButton(this.photobutton);this.photobutton.className="photobutton";this.photobutton.id="photobutton";this.photobutton.title=decodeURIComponent("%E8%88%AA%E7%A9%BA%E5%86%99%E7%9C%9F%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B");this.photobutton.onclick=_func(this,"changeAero");this.setDivStyle(this.photobutton,64,24);this.photobutton.style.margin="0px 1px";this.photobutton_img=this.getSliderImg(0,-24);this.photobutton.appendChild(this.photobutton_img);_c.appendChild(this.photobutton);this.mapbutton=document.createElement("div");_initButton(this.mapbutton);this.mapbutton.className="mapbutton";this.mapbutton.id="mapbutton";this.mapbutton.title=decodeURIComponent("%E5%9C%B0%E5%9B%B3%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B");this.mapbutton.onclick=_func(this,"changeMap");this.setDivStyle(this.mapbutton,64,24);this.mapbutton.style.margin="0px 1px";this.mapbutton_img=this.getSliderImg(0,0);this.mapbutton.appendChild(this.mapbutton_img);_c.appendChild(this.mapbutton);this.guidebutton=document.createElement("div");_initButton(this.guidebutton);this.guidebutton.className="guidebutton";this.guidebutton.id="guidebutton";this.guidebutton.style.display="none";this.guidebutton.title=decodeURIComponent("%E3%82%AC%E3%82%A4%E3%83%89%E3%83%9E%E3%83%83%E3%83%97%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B");this.guidebutton.onclick=_func(this,"changeGuide");this.setDivStyle(this.guidebutton,64,24);this.guidebutton.style.margin="0px 1px";this.guidebutton_img=this.getSliderImg(0,-48);this.guidebutton.appendChild(this.guidebutton_img);_c.appendChild(this.guidebutton);this.zoomer=document.createElement("div");this.zoomer.id="zoomer";_c.appendChild(this.zoomer);var _e=document.createElement("div");_initButton(_e);_e.className="sliderbar";_e.title=decodeURIComponent("%E6%8B%A1%E5%A4%A7");_e.onclick=_func(this,"zoomIn");this.setDivStyle(_e,22,22,true);_e.style.margin="0px 1px";_e.appendChild(this.getSliderImg(0,-96));this.zoomer.appendChild(_e);var _f=document.createElement("div");_initButton(_f);_f.className="sliderbar";_f.title=decodeURIComponent("%E7%B8%AE%E5%B0%8F");_f.onclick=_func(this,"zoomOut");this.setDivStyle(_f,22,22,true);_f.style.margin="0px 1px";_f.appendChild(this.getSliderImg(-22,-96));this.zoomer.appendChild(_f);if(_jsapiVersion=="V2"||_jsapiVersion=="multi"){this.slider=new Slider(this.map,_newImageServer,1);this.slider.setControlNoMap(false);if(this.map.getCurrentPackageId()==YMapMode.GUIDEMAP||this.map.getCurrentPackageId()==YMapMode.B1MAP){this.slider.setEnableBlow(false);}}else{this.slider=new Slider(this.map,_imageServer+"slider");this.slider.setControlNoMap(false);if(this.map.getCurrentPackageId()==YMapMode.GUIDEMAP||this.map.getCurrentPackageId()==YMapMode.B1MAP){this.slider.setEnableBlow(false);}}this.setSliderStyle(this.slider);if(_jsapiVersion=="V2"||_jsapiVersion=="multi"){this.cr=new YahooCopyright(this.map,true);}else{this.cr=document.createElement("div");this.cr.style.zIndex=1;this.cr.style.left="3px";this.cr.style.bottom="3px";this.cr.style.position="absolute";this.cr.style.fontSize="12px";this.cr.style.fontFamily="Arial, Helvetica, sans-serif";this.cr.style.fontWeight="bold";if(_bi.type==1){this.cr.unselectable="on";this.cr.onselectstart=Nothing;}else{this.cr.style.MozUserSelect="none";}this.cr.oncontextmenu=Nothing;setMouseCursor(this.cr,"default");e.appendChild(this.cr);AlpsEvent.addEvent(this.map,"layerChanged",_func(this,"showCopyright"));AlpsEvent.addEvent(this.map,"packageChanged",_func(this,"showCopyright"));this.showCopyright();}var _10=document.createElement("div");_10.style.zIndex=1;_10.style.right="0px";_10.style.bottom="0px";_10.style.position="absolute";_10.oncontextmenu=Nothing;e.appendChild(_10);this.logo=ImageMaker.createImg("http://i.yimg.jp/images/maps/logo/yahoologo.gif");_initButton(this.logo);this.logo.className="yahoologo";this.logo.style.position="static";this.logo.style.cssFloat="right";this.logo.style.styleFloat="right";this.logo.style.margin="1px";this.logo.onclick=function(){window.open("http://rd.yahoo.co.jp/maps/map_api/*http://map.yahoo.co.jp/","YahooMap");};_10.appendChild(this.logo);if(_jsapiVersion=="V2"||_jsapiVersion=="multi"){this.scalebar=new YahooScalebar(this.map);this.scalebar.dom.align="right";this.scalebar.dom.style.bottom="5px";var _11=this.logo.currentStyle||document.defaultView.getComputedStyle(this.logo,"");if(_11){if(_11.display!="none"){this.scalebar.dom.style.right="80px";}}}else{_scalebar=["1500","3000","8000","21000","75000","150000","300000","900000","japanwide","japan"];this.scalebar=ImageMaker.createImg();this.scalebar.style.position="static";this.scalebar.style.cssFloat="right";this.scalebar.style.styleFloat="right";this.scalebar.style.margin="1px";_10.appendChild(this.scalebar);AlpsEvent.addEvent(this.map,"layerChanged",_func(this,"showScalebar"));this.showScalebar();}this.vec=new VectorDrawing(this.map,this.ms);this.vectorContainer=this.vec.vectorContainer;this.vectorData=this.vec.vectorData;this.vectorGraphics=this.vec.vectorGraphics;this.setEnableVectorClickPopup(false);AlpsEvent.addEvent(this.map,"mapMoved",_func(this,"vectorMoved","mapMoved"));AlpsEvent.addEvent(this.map,"mapMoving",_func(this,"vectorMoving","mapMoving"));AlpsEvent.addEvent(this.map,"layerChanged",_func(this,"vectorRefresh","layerChanged"));AlpsEvent.addEvent(this.map,"smoothLayerChanging",_func(this,"vectorClear","smoothLayerChanging"));AlpsEvent.addEvent(this.map,"layerChanged",_func(this,"vectorLayerChanged","layerChanged"));AlpsEvent.addEvent(this.map,"resize",_func(this,"vectorResize","resize"));this.appId=this.getUrlOption("appid");this.jsapiAccessLog("load");AlpsEvent.addEvent(this.map,"mapMoved",_func(this,"jsapiAccessLog","mapMoved"));AlpsEvent.addEvent(this.map,"layerChanged",_func(this,"jsapiAccessLog","layerChanged"));if(_a){this.prevLayerCount=null;AlpsEvent.bindEvent(this.map,"layerListChanged",this,this.iLayerListChanged);this.enableGuidemapAutoPackageChange=true;}AlpsEvent.bindEvent(this.map,"layerListChanged",this,this.ugLayerListChanged);this.prevB1LayerCount=null;this.enableUgAutoPackageChange=false;this.enableUgButton=false;this.prevLayerId="map";_address_yahoomap=this;this.rss=null;this.packageChanged();this.setVisibleSliderbar(true);this.setVisibleCentermark(true);this.visibleUIController=true;this.visibleSlider=true;this.visibleUgButton=false;this.visibleGuideButton=false;}YahooMapsCtrl.prototype.getSliderImg=function(l,t){var _14=document.createElement("img");_14.style.border="0px none";_14.style.margin="0px";_14.style.padding="0px";_14.style.position="relative";_14.style.left=l+"px";_14.style.top=t+"px";_14.style.width=this.ui_w+"px";_14.style.height=this.ui_h+"px";_14.style.filter="";_14.src=this.ui_src;if(_bi.type==1){_14.unselectable="on";_14.onselectstart=Nothing;_14.galleryImg="no";}else{_14.style.MozUserSelect="none";}_14.oncontextmenu=Nothing;_AlphaImageLoader(_14,this.ui_w,this.ui_h);return _14;};YahooMapsCtrl.prototype.setDivStyle=function(div,w,h,_18){div.style.overflow="hidden";div.style.width=w+"px";div.style.height=h+"px";div.style.position="relative";if(_18){div.style.cssFloat="left";div.style.styleFloat="left";}else{div.style.cssFloat="right";div.style.styleFloat="right";}};YahooMapsCtrl.prototype.homeTo=function(e){this.map.packageTo(this.defaultMode);this.map.moveAndLayerTo(this.defaultPos,this.defaultLayer-1);if(e){CancelBubble(e);}};YahooMapsCtrl.prototype.zoomIn=function(e){var l=this.map.getCurrentLayerId()-1;this.map.smoothLayerTo(l,true);if(e){CancelBubble(e);}};YahooMapsCtrl.prototype.zoomOut=function(e){var l=this.map.getCurrentLayerId()+1;this.map.smoothLayerTo(l,true);if(e){CancelBubble(e);}};YahooMapsCtrl.prototype.changeMode=function(_1e){if(_jsapiVersion=="V2"&&_1e=="map"){_1e="worldmap";}this.map.smoothPackageTo(_1e);};YahooMapsCtrl.prototype.moveTo=function(pos){this.map.moveTo(new YLLPoint(pos).toLLPoint());};YahooMapsCtrl.prototype.smoothMoveTo=function(pos){this.map.smoothMoveTo(new YLLPoint(pos).toLLPoint());};YahooMapsCtrl.prototype.moveAndLayerTo=function(pos,_22){this.map.moveAndLayerTo(new YLLPoint(pos).toLLPoint(),_22-1);};YahooMapsCtrl.prototype.layerTo=function(_23){this.map.smoothLayerTo(_23-1);};YahooMapsCtrl.prototype.setLayer=function(_24){this.map.layerTo(_24-1);};YahooMapsCtrl.prototype.magnifyTo=function(_25){this.map.magnifyTo(_25);};YahooMapsCtrl.prototype.getCurrentMagnify=function(){return this.map.getCurrentMagnify();};YahooMapsCtrl.prototype.addCategory=function(id,img,_28,_29){var c=new MapsvrCategory(id,id,img);if(_28){if(_28.name){c.name=_28.name;}c.iconSize[0]={width:_28.width,height:_28.height};c.iconDiff[0]=new Point(0,0);if(_28.dx){c.iconDiff[0].x=_28.dx;}if(_28.dy){c.iconDiff[0].y=_28.dy;}}if(_29){c.expandImage[0]=img;c.expandSize[0]={width:_29.width,height:_29.height};c.expandDiff[0]=new Point(0,0);if(_29.dx){c.expandDiff[0].x=_29.dx;}if(_29.dy){c.expandDiff[0].y=_29.dy;}}else{}this.ms.addCategory(c);this.ms.showAllCategories();this.vectorRefresh();};YahooMapsCtrl.prototype.removeCategory=function(id){this.ms.removeCategory(id);this.ms.showAllCategories();this.vectorRefresh();};YahooMapsCtrl.prototype.addIcon=function(id,pos,_2e,cat,_30){this.ms.addContents(new MapsvrPOI(id,_30,new YLLPoint(pos).toLLPoint(),cat||_defaultCategory,_2e));};YahooMapsCtrl.prototype.addIcons=function(ary){var _32=ary.length;for(var i=0;i<_32;i++){var p=ary[i];this.ms.addContents(new MapsvrPOI(p.id,p.label,new YLLPoint(p.pos).toLLPoint(),p.type||_defaultCategory,p.popup),true);}if(_32>0){this.ms.showAllCategories(true);this.vectorRefresh();}};YahooMapsCtrl.prototype.getIcon=function(id){var c=this.ms.getContents(id);if(!c){return;}return {id:c.id,pos:new YLLPoint(c.pos),popup:c.popup,type:c.cat,label:c.name};};YahooMapsCtrl.prototype.getIcons=function(){var cl=this.ms.getContentsList();if(!cl){return;}var ary=new Array();for(var i=0;i<cl.length;i++){var c=cl[i];ary.push({id:c.id,pos:new YLLPoint(c.pos),popup:c.popup,type:c.cat,label:c.name});}return ary;};YahooMapsCtrl.prototype.removeIcon=function(id){this.ms.removeContents(id);};YahooMapsCtrl.prototype.clearIcon=function(){this.ms.clearContents();this.vec.setScrollOffset();this.vectorRefresh();};YahooMapsCtrl.prototype.moveToIcon=function(id){var _3d=this.ms.getContents(id);if(_3d){this.map.moveTo(_3d.pos);}};YahooMapsCtrl.prototype.openPopup=function(id){this.ms.openPopup(id);};YahooMapsCtrl.prototype.closePopup=function(){this.ms.closePopup();};YahooMapsCtrl.prototype.getCenter=function(){return new YLLPoint(this.map.getCenterLatLon());};YahooMapsCtrl.prototype.getBottomLeft=function(){var p=new Point(0,this.map.getContainer().offsetHeight);return new YLLPoint(this.map.log2LatLon(p));};YahooMapsCtrl.prototype.getTopRight=function(){var p=new Point(this.map.getContainer().offsetWidth,0);return new YLLPoint(this.map.log2LatLon(p));};YahooMapsCtrl.prototype.getCurrentLayer=function(){return this.map.getCurrentLayerId()+1;};YahooMapsCtrl.prototype.getCurrentMode=function(){var _41=this.map.getCurrentPackageId();if(_jsapiVersion=="V2"&&_41=="worldmap"){_41="map";}return _41;};YahooMapsCtrl.prototype.addEvent=function(_42,_43){switch(_42){case YEventType.ICON_CLICK:return AlpsEvent.addEvent(this.ms,"click",function(id){_43(id);});case YEventType.ICON_DBLCLICK:return AlpsEvent.addEvent(this.ms,"dblclick",function(id){_43(id);});case YEventType.ICON_MOUSEDOWN:return AlpsEvent.addEvent(this.ms,"mouseDown",function(id){_43(id);});case YEventType.ICON_MOUSEUP:return AlpsEvent.addEvent(this.ms,"mouseUp",function(id){_43(id);});case YEventType.ICON_MOUSEOVER:return AlpsEvent.addEvent(this.ms,"mouseOver",function(id){_43(id);});case YEventType.ICON_MOUSEOUT:return AlpsEvent.addEvent(this.ms,"mouseOut",function(id){_43(id);});case YEventType.POPUP_OPEN:return AlpsEvent.addEvent(this.ms,"openPopup",function(id){_43(id);});case YEventType.POPUP_CLOSE:return AlpsEvent.addEvent(this.ms,"closePopup",function(){_43();});case YEventType.MAP_CLICK:return AlpsEvent.addEvent(this.map,_42,function(p,b){_43(new YLLPoint(p),b);});case YEventType.MOUSE_MOVE:return AlpsEvent.addEvent(this.map,_42,function(p){_43(new YLLPoint(p));});default:return AlpsEvent.addEvent(this.map,_42,function(){_43();});}};YahooMapsCtrl.prototype.removeEvent=function(obj){AlpsEvent.removeEvent(obj);};YahooMapsCtrl.prototype.setVisibleSliderbar=function(_4f){this.visibleSlider=_4f;var _50=this.slider.getContainer();if(_4f){this.zoomer.style.display="none";_50.style.display="block";}else{this.zoomer.style.display="block";_50.style.display="none";}};YahooMapsCtrl.prototype.getVisibleSliderbar=function(){return this.visibleSlider;};YahooMapsCtrl.prototype.setVisibleCentermark=function(_51){this.map.setVisibleCenterMark(_51);this.centerbutton_img.style.left=(_51==true?0:-25)+"px";var _52=_51==true?"%E4%B8%AD%E5%BF%83%E7%82%B9%E3%82%92%E9%9D%9E%E8%A1%A8%E7%A4%BA%E3%81%AB%E3%81%99%E3%82%8B":"%E4%B8%AD%E5%BF%83%E7%82%B9%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B";this.centerbutton.title=decodeURIComponent(_52);};YahooMapsCtrl.prototype.getVisibleCentermark=function(){if(!this.map.mapView.centerImg){return false;}return this.map.mapView.centerImg.style.visibility=="visible"?true:false;};YahooMapsCtrl.prototype.setVisibleCentermarkButton=function(_53){this.centerbutton.style.display=(_53==true?"block":"none");};YahooMapsCtrl.prototype.getVisibleCentermarkButton=function(){return this.centerbutton.style.display=="block"?true:false;};YahooMapsCtrl.prototype.setVisibleGuideButton=function(_54){this.visibleGuideButton=_54;this.guidebutton.style.display=(_54==true?"block":"none");};YahooMapsCtrl.prototype.getVisibleGuideButton=function(){return this.visibleGuideButton;};YahooMapsCtrl.prototype.setVisibleUgButton=function(_55){this.visibleUgButton=_55;this.b1button.style.display=(_55==true?"block":"none");};YahooMapsCtrl.prototype.getVisibleUgButton=function(){return this.visibleUgButton;};YahooMapsCtrl.prototype.getEnableUgButton=function(){return this.enableUgButton;};YahooMapsCtrl.prototype.setEnableUgButton=function(_56){this.enableUgButton=_56;};YahooMapsCtrl.prototype.setEnableClickPopup=function(_57){this.ms.setEnableClickPopup(_57);};YahooMapsCtrl.prototype.getEnableClickPopup=function(){return this.ms.getEnableClickPopup();};YahooMapsCtrl.prototype.setEnableDraggableMode=function(_58){this.ms.setEnableDraggableMode(_58);};YahooMapsCtrl.prototype.getEnableDraggableMode=function(){return this.ms.getEnableDraggableMode();};YahooMapsCtrl.prototype.setEnableWheelOperation=function(_59){this.map.setEnableWheelOperation(_59);};YahooMapsCtrl.prototype.getEnableWheelOperation=function(){return this.map.getEnableWheelOperation();};YahooMapsCtrl.prototype.getSuitableLayer=function(){if(!arguments.length){return 3;}var _5a=90;var _5b=180;var _5c=-90;var _5d=-180;var _5e=function(pos){var p=new YLLPoint(pos);_5a=Math.min(_5a,p.lat);_5b=Math.min(_5b,p.lon);_5c=Math.max(_5c,p.lat);_5d=Math.max(_5d,p.lon);};for(var i=0;i<arguments.length;i++){if(!arguments[i].length){_5e(arguments[i]);}else{for(var j=0;j<arguments[i].length;j++){_5e(arguments[i][j]);}}}var bl=new LLPoint(_5a,_5b);var tr=new LLPoint(_5c,_5d);return this.map.getSuitableLayerId(bl,tr)+1;};YahooMapsCtrl.prototype.resetCenter=function(){this.map.resetCenter();};YahooMapsCtrl.prototype.sliderChangeMode=function(_65){var s=this.slider.getContainer();var _67=s.style.display;this.slider.changeMode(_65);this.setSliderStyle(this.slider);s=this.slider.getContainer();s.style.display=_67;};YahooMapsCtrl.prototype.setEnableGuidemapAutoPackageChange=function(_68){if(YMapMode.GUIDEMAP){this.enableGuidemapAutoPackageChange=_68;}};YahooMapsCtrl.prototype.getEnableGuidemapAutoPackageChange=function(){if(YMapMode.GUIDEMAP){return this.enableGuidemapAutoPackageChange;}return false;};YahooMapsCtrl.prototype.setEnableUgAutoPackageChange=function(_69){this.enableUgAutoPackageChange=_69;};YahooMapsCtrl.prototype.getEnableUgAutoPackageChange=function(){return this.enableUgAutoPackageChange;};YahooMapsCtrl.prototype.setEnableLabel=function(_6a){this.ms.setEnableLabel(_6a);};YahooMapsCtrl.prototype.getEnableLabel=function(){return this.ms.getEnableLabel();};YahooMapsCtrl.prototype.yGeoRSS=function(_6b){this.rss=new YGeoRSS(this.map,this.ms,_6b);};YahooMapsCtrl.prototype.yGeoRSSsetWaiwaiCategories=function(cid){this.rss.setWaiwaiCategories(cid);};YahooMapsCtrl.prototype.yGeoRSSsetWaiwaiMid=function(mid){this.rss.setWaiwaiMid(mid);};YahooMapsCtrl.prototype.yGeoRSSsetWaiwaiLimit=function(c){this.rss.setWaiwaiLimit(c);};YahooMapsCtrl.prototype.yGeoRSSsetWaiwaiSort=function(s){this.rss.setWaiwaiSort(s);};YahooMapsCtrl.prototype.yGeoRSSsetWaiwaiOption=function(s){this.rss.setWaiwaiOption(s);};YahooMapsCtrl.prototype.yGeoRSSgetWaiwaiOption=function(){return this.rss.getWaiwaiOption();};YahooMapsCtrl.prototype.yGeoRSSloadWaiwai=function(){this.rss.loadWaiwai();};YahooMapsCtrl.prototype.yGeoRSSshowWaiwaiIcon=function(){this.rss.showWaiwaiIcon();};YahooMapsCtrl.prototype.yGeoRSShideWaiwaiIcon=function(){this.rss.hideWaiwaiIcon();};YahooMapsCtrl.prototype.yGeoRSSgetWaiwaiData=function(){return this.rss.getWaiwaiData();};YahooMapsCtrl.prototype.yGeoRSSsetCategory=function(cid){this.rss.setCategory(cid);};YahooMapsCtrl.prototype.yGeoRSSloadXML=function(url){this.rss.loadXML(url);};YahooMapsCtrl.prototype.yGeoRSSshowIcon=function(){this.rss.showIcon();};YahooMapsCtrl.prototype.yGeoRSShideIcon=function(){this.rss.hideIcon();};YahooMapsCtrl.prototype.yGeoRSSgetData=function(){return this.rss.getData();};YahooMapsCtrl.prototype.addPolyline=function(id,pos,_75,_76,flg){if(typeof (flg)=="undefined"){flg=true;}if(!_isYLLPointArray(pos)){return false;}id=String(id);var len=this.vectorData.length;for(var i=0;i<len;i++){if(this.vectorData[i]["id"]==id){len=i;break;}}this.vectorData[len]=new Array();this.vectorData[len]["id"]=id;this.vectorData[len]["kind"]="polyline";this.vectorData[len]["latlon"]=pos;this.vectorData[len]["popup"]=_75;this.vectorData[len]["strokeWidth"]=_76.strokeWidth;this.vectorData[len]["strokeColor"]=_76.strokeColor;this.vectorData[len]["strokeOpacity"]=_76.strokeOpacity;if(flg){_vectorPopupClose();this.vectorRefresh();}return this.vectorData[len]["id"];};YahooMapsCtrl.prototype.addPolylines=function(ary){var len=ary.length;for(var i=0;i<len;i++){var pos=new Array();var _7e=ary[i].pos.length;for(var j=0;j<_7e;j++){pos.push(ary[i].pos[j]);}var _80={strokeWidth:ary[i].style.strokeWidth,strokeColor:ary[i].style.strokeColor,strokeOpacity:ary[i].style.strokeOpacity};if(!this.addPolyline(ary[i].id,pos,ary[i].popup,_80,false)){return false;}}this.vectorRefresh();};YahooMapsCtrl.prototype.addPolygon=function(id,pos,_83,_84,flg){if(typeof (flg)=="undefined"){flg=true;}if(!_isYLLPointArray(pos)){return false;}id=String(id);var len=this.vectorData.length;for(var i=0;i<len;i++){if(this.vectorData[i]["id"]==id){len=i;break;}}this.vectorData[len]=new Array();this.vectorData[len]["id"]=id;this.vectorData[len]["kind"]="polygon";this.vectorData[len]["latlon"]=pos;this.vectorData[len]["popup"]=_83;this.vectorData[len]["strokeWidth"]=_84.strokeWidth;this.vectorData[len]["strokeColor"]=_84.strokeColor;this.vectorData[len]["strokeOpacity"]=_84.strokeOpacity;this.vectorData[len]["fillColor"]=_84.fillColor;this.vectorData[len]["fillOpacity"]=_84.fillOpacity;if(flg){_vectorPopupClose();this.vectorRefresh();}return this.vectorData[len]["id"];};YahooMapsCtrl.prototype.addPolygons=function(ary){var len=ary.length;for(var i=0;i<len;i++){var pos=new Array();var _8c=ary[i].pos.length;for(var j=0;j<_8c;j++){pos.push(ary[i].pos[j]);}var _8e={strokeWidth:ary[i].style.strokeWidth,strokeColor:ary[i].style.strokeColor,strokeOpacity:ary[i].style.strokeOpacity,fillColor:ary[i].style.fillColor,fillOpacity:ary[i].style.fillOpacity};if(!this.addPolygon(ary[i].id,pos,ary[i].popup,_8e,false)){return false;}}this.vectorRefresh();};YahooMapsCtrl.prototype.getVectorObject=function(id){var _90;if(id){id=String(id);var len=this.vectorData.length;for(var i=0;i<len;i++){if(this.vectorData[i]["id"]==id){if(this.vectorData[i]["kind"]=="polyline"){_90={id:this.vectorData[i]["id"],kind:this.vectorData[i]["kind"],pos:new Array(),popup:this.vectorData[i]["popup"],style:{strokeWidth:this.vectorData[i]["strokeWidth"],strokeColor:this.vectorData[i]["strokeColor"],strokeOpacity:this.vectorData[i]["strokeOpacity"]}};}else{if(this.vectorData[i]["kind"]=="polygon"){_90={id:this.vectorData[i]["id"],kind:this.vectorData[i]["kind"],pos:new Array(),popup:this.vectorData[i]["popup"],style:{strokeWidth:this.vectorData[i]["strokeWidth"],strokeColor:this.vectorData[i]["strokeColor"],strokeOpacity:this.vectorData[i]["strokeOpacity"],fillColor:this.vectorData[i]["fillColor"],fillOpacity:this.vectorData[i]["fillOpacity"]}};}}var _93=this.vectorData[i]["latlon"].length;for(var j=0;j<_93;j++){_90.pos.push(new YLLPoint(this.vectorData[i]["latlon"][j]));}break;}}}return _90;};YahooMapsCtrl.prototype.removeVectorObject=function(id){if(id){id=String(id);var len=this.vectorData.length;for(var i=0;i<len;i++){if(this.vectorData[i]["id"]==id){this.vectorData.splice(i,1);this.vectorRefresh();break;}}_vectorPopupClose();}};YahooMapsCtrl.prototype.clearVectorObject=function(){this.vec.vectorData=new Array();this.vectorData=this.vec.vectorData;_vectorPopupClose();this.vectorGraphics.clear();};YahooMapsCtrl.prototype.setVectorStrokeColor=function(_98){if(arguments.length==3){this.vectorGraphics.setStrokeColor(arguments[0],arguments[1],arguments[2]);}else{if(typeof (_98)=="string"){this.vectorGraphics.setStrokeColor(_98);}}};YahooMapsCtrl.prototype.setVectorStrokeOpacity=function(_99){this.vectorGraphics.setStrokeOpacity(_99);};YahooMapsCtrl.prototype.setVectorFillColor=function(_9a){if(arguments.length==3){this.vectorGraphics.setFillColor(arguments[0],arguments[1],arguments[2]);}else{if(typeof (_9a)=="string"){this.vectorGraphics.setFillColor(_9a);}}};YahooMapsCtrl.prototype.setVectorFillOpacity=function(_9b){this.vectorGraphics.setFillOpacity(_9b);};YahooMapsCtrl.prototype.setEnableVectorClickPopup=function(flg){var _9d=this.vectorGraphics.type;if(flg==true){if(this.vec.bVectorClickPopup){return;}this.vec.bVectorClickPopup=true;}else{if(!this.vec.bVectorClickPopup){return;}this.vec.bVectorClickPopup=false;}if(_9d==1){if(this.vec.bVectorClickPopup){AlpsEvent.removeBuiltInEvent(this.map.getContainer(),"mouseover",_vectorPopupCloseEvent);}else{AlpsEvent.addBuiltInEvent(this.map.getContainer(),"mouseover",_vectorPopupCloseEvent);}var pl=this.vectorGraphics.container.getElementsByTagName("polyline");var len=pl.length;for(var i=0;i<len;i++){if(flg){if(!pl[i].onmouseover){return;}pl[i].onclick=pl[i].onmouseover;pl[i].onmouseout=null;}else{if(!pl[i].onclick){return;}pl[i].onmouseover=pl[i].onclick;pl[i].onclick=null;}}}else{if(_9d==2){if(this.vec.bVectorClickPopup){this.vectorContainer.onclick=this.vectorPopupEvent_Canvas();this.vectorContainer.onmousemove="";}else{this.vectorContainer.onclick="";this.vectorContainer.onmousemove=this.vectorPopupEvent_Canvas();}}else{if(_9d==3){if(this.vec.bVectorClickPopup){AlpsEvent.removeBuiltInEvent(this.map.getContainer(),"mouseover",_vectorPopupCloseEvent);}else{AlpsEvent.addBuiltInEvent(this.map.getContainer(),"mouseover",_vectorPopupCloseEvent);}var _a1=this.vectorGraphics.container.getElementsByTagName("path");var len=_a1.length;for(var i=0;i<len;i++){if(flg){if(_a1[i].onmouseover){_a1[i].onclick=_a1[i].onmouseover;_a1[i].onmouseover=null;}}else{if(_a1[i].onclick){_a1[i].onmouseover=_a1[i].onclick;_a1[i].onclick=null;}}}}}}this.vectorRefresh();};YahooMapsCtrl.prototype.openVectorPopup=function(id){if(id){var len=this.vectorData.length;for(var i=0;i<len;i++){if(this.vectorData[i]["id"]==id){var _a5=false;if(this.vectorData[i]["kind"]=="polyline"){var _a6=this.vectorData[i]["latlon"].length;var pos=0;if(_a6%2==1){_a5=this.vectorData[i]["latlon"][(Math.floor(_a6/2))];}else{var p=this.map.latLon2Log(this.vectorData[i]["latlon"][(Math.floor(_a6/2-1))]);var _a9=p.x,_aa=p.y,_ab=p.x,_ac=p.y;p=this.map.latLon2Log(this.vectorData[i]["latlon"][(Math.floor(_a6/2))]);if(_a9<p.x){_a9=p.x;}else{if(_ab>p.x){_ab=p.x;}}if(_aa<p.y){_aa=p.y;}else{if(_ac>p.y){_ac=p.y;}}_a5=this.map.log2LatLon(new Point(_ab+(_a9-_ab)/2,_ac+(_aa-_ac)/2));}}else{if(this.vectorData[i]["kind"]=="polygon"){var _a9,_aa,_ab,_ac;var _a6=this.vectorData[i]["latlon"].length;if(!_a6){return false;}for(var j=0;j<_a6;j++){var p=this.map.latLon2Log(this.vectorData[i]["latlon"][j]);if(j!=0){if(_a9<p.x){_a9=p.x;}else{if(_ab>p.x){_ab=p.x;}}if(_aa<p.y){_aa=p.y;}else{if(_ac>p.y){_ac=p.y;}}}else{_a9=p.x;_aa=p.y;_ab=p.x;_ac=p.y;}}_a5=this.map.log2LatLon(new Point(_ab+(_a9-_ab)/2,_ac+(_aa-_ac)/2));}}if(!_a5){return;}_vectorPopupClose();this.vec.bVectorPopupOpen=id;this.vec.vectorPopupOrigin=new Array();this.vec.vectorPopupOrigin[0]=_a5;this.map.moveTo(_a5);this.setVectorPopup(this.vectorData[i]["popup"]);break;}}}};YahooMapsCtrl.prototype.closeVectorPopup=function(){_vectorPopupClose();};if(_jsapiVersion=="V2"||_jsapiVersion=="multi"){YahooMapsCtrl.prototype.getDatum=function(){return this.map.getDatum();};}YahooMapsCtrl.prototype.changeMap=function(e){var _af=YMapMode.MAP;if(_jsapiVersion=="V2"){_af="worldmap";}this.changeMode(_af);if(e){CancelBubble(e);}};YahooMapsCtrl.prototype.changeAero=function(e){this.changeMode(YMapMode.AERO);if(e){CancelBubble(e);}};YahooMapsCtrl.prototype.changeB1=function(e){this.changeMode(YMapMode.B1MAP);if(e){CancelBubble(e);}};YahooMapsCtrl.prototype.changeGuide=function(e){this.changeMode(YMapMode.GUIDEMAP);if(e){CancelBubble(e);}};YahooMapsCtrl.prototype.centerMark=function(e){var i=this.getVisibleCentermark();this.setVisibleCentermark(!i);if(e){CancelBubble(e);}};YahooMapsCtrl.prototype.showCopyright=function(id){if(this.map.getCurrentPackageId()=="aero"){this.cr.style.color="white";var _b6=this.map.getCurrentScale();if(_b6==5000||_b6==10000){this.cr.innerHTML="(C)KOKUSAI KOGYO CO.,LTD,Degital Earth Technology,Pasco";}else{if(_b6==25000||_b6==70000){this.cr.innerHTML="(C) Digital Earth Technology, Geoscience Co., Ltd.&amp;RESTEC";}else{this.cr.innerHTML="(C) Geoscience Co., Ltd";}}}else{this.cr.innerHTML="";}};YahooMapsCtrl.prototype.showScalebar=function(){this.scalebar.src=_imageServer+"scalebars/scale_"+_scalebar[this.map.getCurrentLayerId()]+"_a.gif";};YahooMapsCtrl.prototype.packageChanged=function(){var id=this.map.getCurrentPackageId();var _b8=YMapMode.MAP;if(_jsapiVersion=="V2"){_b8="worldmap";}this.mapbutton_img.style.left=(id==_b8?0:-64)+"px";this.photobutton_img.style.left=(id==YMapMode.AERO?0:-64)+"px";this.b1button_img.style.left=(id==YMapMode.B1MAP?0:-64)+"px";this.guidebutton_img.style.left=(id==YMapMode.GUIDEMAP?0:-64)+"px";if(id==YMapMode.GUIDEMAP||id==YMapMode.B1MAP){this.slider.setEnableBlow(false);}else{this.slider.setEnableBlow(true);}if(id!=YMapMode.GUIDEMAP&&id!=YMapMode.B1MAP){this.prevLayerId=id;}this.checkLogo();};YahooMapsCtrl.prototype.setSliderStyle=function(_b9){var s=_b9.getContainer();var n=s.childNodes;for(var i=0;i<n.length;i++){n[i].className="sliderbar";}s.id="slider";s.style.position="absolute";s.style.margin="4px";s.style.left="0px";s.style.top="0px";s.style.zIndex=1;};YahooMapsCtrl.prototype.checkLogo=function(){var _bd=this.logo.currentStyle||document.defaultView.getComputedStyle(this.logo,"");var _be=this.cr.base.currentStyle||document.defaultView.getComputedStyle(this.cr.base,"");var _bf=this.map.getYahooCopyright();if(_bd&&_be){if(_bd.display!="none"&&_bf=="(C)Yahoo Japan"){this.cr.base.style.display="none";}else{this.cr.base.style.display="block";}}};YahooMapsCtrl.prototype.layerListChanged=function(_c0){var p=this.map.getCurrentPackageId();if(p==_c0){this.checkLogo();}};YahooMapsCtrl.prototype.vendorChanged=function(){this.checkLogo();};YahooMapsCtrl.prototype.mapMoved=function(){if(this.popupID){this.openPopupOnMapContainer(this.popupID);}};YahooMapsCtrl.prototype.layerChanged=function(){if(this.popupID){this.openPopupOnMapContainer(this.popupID);}this.checkLogo();};YahooMapsCtrl.prototype.poiListChanged=function(){if(this.popupID){this.openPopupOnMapContainer(this.popupID);}};YahooMapsCtrl.prototype.openPopupOnMapContainer=function(_c2){var poi=this.ms.getContents(_c2);var nw=new Point(0,0);var ne=new Point(this.ms.width,0);var sw=new Point(0,this.ms.height);var se=new Point(this.ms.width,this.ms.height);var p=this.map.latLon2Log(poi.pos);if((p.x>nw.x&&p.y>nw.y)&&(p.x<ne.x&&p.y>ne.y)&&(p.x>sw.x&&p.y<sw.y)&&(p.x<se.x&&p.y<se.y)){this.ms.openPopup(_c2);}};YahooMapsCtrl.prototype.onOpenPopup=function(id){this.popupID=id;};YahooMapsCtrl.prototype.onClosePopup=function(_ca){if(!_ca){this.popupID=null;}};YahooMapsCtrl.prototype.iLayerListChanged=function(_cb){if(_cb!=YMapMode.GUIDEMAP){return;}var len=this.map.getLayerScaleList(YMapMode.GUIDEMAP).length;var id=this.map.getCurrentPackageId();if(len==0){this.setVisibleGuideButton(false);if(id==YMapMode.GUIDEMAP){if(this.enableGuidemapAutoPackageChange){this.map.smoothPackageTo(this.prevLayerId);}}}else{this.setVisibleGuideButton(true);if(this.enableGuidemapAutoPackageChange){if(id!=YMapMode.GUIDEMAP&&this.prevLayerCount==0){this.map.smoothPackageTo(YMapMode.GUIDEMAP);}}}this.prevLayerCount=len;};YahooMapsCtrl.prototype.ugLayerListChanged=function(_ce){if(_ce!=YMapMode.B1MAP){return;}var len=this.map.getLayerScaleList(YMapMode.B1MAP).length;var id=this.map.getCurrentPackageId();if(len==0){this.setVisibleUgButton(false);if(this.enableUgAutoPackageChange){if(id==YMapMode.B1MAP){this.map.smoothPackageTo(YMapMode.MAP);}}}else{if(this.enableUgButton){this.setVisibleUgButton(true);}}};YahooMapsCtrl.prototype.jsapiAccessLog=function(_d1){var _d2=new Date();var url="";if(_jsapiVersion=="V1"){url="http://map.yahooapis.jp/MapsService/js/V1/";}else{if(_jsapiVersion=="V2"){url="http://map.yahooapis.jp/MapsService/js/V2/";}else{if(_jsapiVersion=="multi"){url="http://map.yahooapis.jp/MapsService/js/V3/";}}}if(url==""){return;}url+="jsaction?action="+_d1+"&mode="+this.getCurrentMode()+"&sc="+this.getCurrentLayer()+"&appid="+this.appId+"&time="+_d2.getTime();var id="_jsapilog";var ref=false;var _d6=this.map.mapView.mapContainer.getElementsByTagName("img");for(var i=0;i<_d6.length;i++){if(_d6[i].id==id){ref=true;break;}}if(ref){_d6[i].src=url;}else{var img=document.createElement("img");img.id=id;img.style.display="none";this.map.mapView.mapContainer.appendChild(img);img.src=url;}};YahooMapsCtrl.prototype.getUrlOption=function(_d9){if(!this.option){this.option=[];var a=_jsapiurl.split(/[\&\?]/);for(var i=0;i<a.length;i++){var b=a[i].split("=");if(b[0]){this.option[b[0]]=b[1];}}}if(this.option[_d9]){return this.option[_d9];}else{return "";}};YahooMapsCtrl.prototype.drawPolyline=function(_dd){this.vec.drawPolyline(_dd);this.vec.addVectorPopupEvent(_dd["id"],_dd["popup"],this.vectorPopupEvent);};YahooMapsCtrl.prototype.drawPolygon=function(_de){this.vec.drawPolygon(_de,this.vectorPopupEvent);this.vec.addVectorPopupEvent(_de["id"],_de["popup"],this.vectorPopupEvent);};YahooMapsCtrl.prototype.vectorClear=function(){_vectorPopupClose(true);this.vectorGraphics.clear();};YahooMapsCtrl.prototype.vectorLayerChanged=function(){if(_delaytime>0){window.setTimeout(_func(this.vec,"setScrollOffset"),_delaytime);window.setTimeout(_func(this,"vectorRefresh"),_delaytime);}else{this.vec.setScrollOffset();this.vectorRefresh();}};YahooMapsCtrl.prototype.vectorRefresh=function(flg){if(flg!=true){if(this.ms.canvas==null){this.ms.initCanvas();}if(this.ms.canvas.firstChild){if(this.ms.canvas.firstChild.id!=this.vectorContainer.id){this.ms.canvas.insertBefore(this.vectorContainer,this.ms.canvas.firstChild);}}else{this.ms.canvas.insertBefore(this.vectorContainer,this.ms.canvas.firstChild);}this.setVectorContainerOrigin();}this.vectorGraphics.clear();var len=this.vectorData.length;for(var i=0;i<len;i++){if(this.vectorData[i]["kind"]=="polyline"){this.drawPolyline(this.vectorData[i]);}else{if(this.vectorData[i]["kind"]=="polygon"){this.drawPolygon(this.vectorData[i]);}}}this.setVectorPopup();};YahooMapsCtrl.prototype.vectorMoved=function(){this.vec.isMouseDragged=false;};YahooMapsCtrl.prototype.vectorMoving=function(){this.vec.isMouseDragged=true;var _e2=new Point(this.ms.canvas.offsetLeft,this.ms.canvas.offsetTop);this.vec.setScrollOffset(_e2);if(this.vectorData.length>0&&this.vec.isNeedToRefresh()){this.ms.smoothLayerChanging();this.ms.layerChanged();this.vectorLayerChanged();}this.setVectorPopup();};YahooMapsCtrl.prototype.vectorResize=function(){if(this.vectorContainer){this.vec.setScrollOffset();this.vectorRefresh();}if(this.popupID){this.ms.closePopup(true);this.openPopupOnMapContainer(this.popupID);}};YahooMapsCtrl.prototype.setVectorContainerOrigin=function(){this.vec.setVectorContainerOrigin();};YahooMapsCtrl.prototype.get2LinePointIntersection=function(p1,p2,p3,p4){return this.vec.get2LinePointIntersection(p1,p2,p3,p4);};YahooMapsCtrl.prototype.isIntersection=function(p1,p2,p3,p4){return this.vec.isIntersection(p1,p2,p3,p4);};YahooMapsCtrl.prototype.isPointInPolygon=function(p,_ec){return this.vec.isPointInPolygon(p,_ec);};YahooMapsCtrl.prototype.getClippingPoint=function(p,_ee){return this.vec.getClippingPoint(p,_ee);};YahooMapsCtrl.prototype.getPointLineDistance=function(p,lp1,lp2){return this.vec.getPointLineDistance(p,lp1,lp2);};YahooMapsCtrl.prototype.vectorPopupEvent=function(id,_f3){var vec=_address_yahoomap;var _f5=vec.map.getContainer();return function(evt){if(!_f3){return;}if(vec.vec.isMouseDragged){return;}CancelBubble(evt);if(!vec.vec.bVectorClickPopup&&vec.vec.bVectorPopupOpen&&(vec.vec.bVectorPopupOpen==id)){return false;}var p=_getMousePosition(evt,_f5);vec.vec.bVectorPopupOpen=id;vec.vec.vectorPopupOrigin=new Array();vec.vec.vectorPopupOrigin[0]=vec.map.log2LatLon(p);vec.setVectorPopup(_f3);};};YahooMapsCtrl.prototype.vectorPopupEvent_Canvas=function(){var map=this;var _f9=this.map.getContainer();return function(e){if(map.vec.isMouseDragged){return;}if(map.vectorData){var len=map.vectorData.length;if(len>=1){var ref=false;var mp=_getMousePosition(e,_f9);for(var i=len-1;i>=0;i--){if(map.vectorData[i]["kind"]=="polyline"){var p=new Array();var _100=map.vectorData[i]["strokeWidth"]/2;var plen=map.vectorData[i]["latlon"].length;for(var j=0;j<plen;j++){if(j!=0){p[1]=map.map.latLon2Log(map.vectorData[i]["latlon"][j]);var dist=map.vec.getPointLineDistance(mp,p[0],p[1]);if(dist>=0&&dist<=_100){ref=true;break;}p[0]=p[1];}else{p[0]=map.map.latLon2Log(map.vectorData[i]["latlon"][j]);}}if(ref){break;}}else{if(map.vectorData[i]["kind"]=="polygon"){var p=new Array();var plen=map.vectorData[i]["latlon"].length;for(var j=0;j<plen;j++){p[j]=map.map.latLon2Log(map.vectorData[i]["latlon"][j]);}if(map.vec.isPointInPolygon(mp,p)){ref=true;break;}}}if(ref){break;}}if(ref){if(!map.vectorData[i]["popup"]){return;}if(!map.vec.bVectorClickPopup&&map.vec.bVectorPopupOpen&&(map.vec.bVectorPopupOpen==map.vectorData[i]["id"])){return false;}CancelBubble(e);map.vec.bVectorPopupOpen=map.vectorData[i]["id"];map.vec.vectorPopupOrigin=new Array();map.vec.vectorPopupOrigin[0]=map.map.log2LatLon(mp);map.setVectorPopup(map.vectorData[i]["popup"]);return;}else{if(!map.vec.bVectorClickPopup){_vectorPopupClose();}}}}};};YahooMapsCtrl.prototype.setVectorPopup=function(_104){if(!this.vec.bVectorPopupOpen){return;}var _105=_getVectorPopupElement();var div1=_105[0];var div2=_105[1];var div3=_105[2];var div4=_105[3];if(div1&&div2&&div3&&div4){var ref=0;var _10b=this.map.getContainer();var _10c=_getElementePosition(_10b);if(_104){_setVectorPopupHtml(div3,_104);_setVectorPopupHtml(div4,_104);_setVectorPopupHtml(div1,_104);_setVectorPopupHtml(div2,_104);this.vecCanvasOffset=this.vec.getScrollOffset();}if(this.vec.vectorPopupOrigin[0]){var _10d=72;var p1=this.map.latLon2Log(this.vec.vectorPopupOrigin[0]);p1.x+=_10c.x;p1.y+=_10c.y;var _10f=_10b.offsetWidth+_10c.x;var _110=_10f/2;var _111=_10b.offsetHeight+_10c.y;var _112=_111/2;if((p1.x>=0+_10c.x&&p1.x<=_110)&&(p1.y>=0+_10c.y&&p1.y<=_112/2)){div4.style.display="none";div1.style.display="none";div2.style.display="none";var s=_getHtmlSize(div3.innerHTML);div3.style.left=p1.x-_10d+"px";div3.style.top=p1.y+"px";div3.style.display="block";}else{if((p1.x>=_110&&p1.x<=_10f)&&(p1.y>=0+_10c.y&&p1.y<=_112/2)){div3.style.display="none";div1.style.display="none";div2.style.display="none";var s=_getHtmlSize(div4.innerHTML);div4.style.left=p1.x-(s.width-_10d)+"px";div4.style.top=p1.y+"px";div4.style.display="block";}else{if((p1.x>=0+_10c.x&&p1.x<=_110)&&(p1.y>=_112/2&&p1.y<=_111)){div3.style.display="none";div4.style.display="none";div2.style.display="none";var s=_getHtmlSize(div1.innerHTML);div1.style.left=p1.x-_10d+"px";div1.style.top=p1.y-s.height+"px";div1.style.display="block";}else{if((p1.x>=_110&&p1.x<=_10f)&&(p1.y>=_112/2&&p1.y<=_111)){div3.style.display="none";div4.style.display="none";div1.style.display="none";var s=_getHtmlSize(div2.innerHTML);div2.style.left=p1.x-(s.width-_10d)+"px";div2.style.top=p1.y-s.height+"px";div2.style.display="block";}else{div3.style.display="none";div4.style.display="none";div1.style.display="none";div2.style.display="none";}}}}p1.x-=_10b.offsetLeft;p1.y-=_10b.offsetTop;}}};YahooMapsCtrl.prototype.resizeMap=function(){var _114;var _115;if(arguments.length===1&&typeof arguments[0]=="object"){var size=arguments[0];_114=size.width;_115=size.height;}else{if(arguments.length===2){_114=arguments[0];_115=arguments[1];}}this.map.setSize(_114,_115);};YahooMapsCtrl.prototype.getIconElement=function(id){return this.ms.getIconElement(id);};YahooMapsCtrl.prototype.latLon2Log=function(pos){var p;if(typeof (pos)=="object"){p=pos.toLLPoint();}else{if(typeof (pos)=="string"){p=new LLPoint(pos.split(",")[0],pos.split(",")[1]);}}return this.map.latLon2Log(p);};YahooMapsCtrl.prototype.setVisibleUIController=function(_11a){this.visibleUIController=_11a;this.map.setVisibleCenterMark(_11a);var _11b=(_11a===true)?"block":"none";this.centerbutton.style.display=_11b;if(this.visibleSlider){this.slider.getContainer().style.display=_11b;}else{this.zoomer.style.display=_11b;}this.scalebar.dom.style.display=_11b;this.home.style.display=_11b;this.mapbutton.style.display=_11b;this.photobutton.style.display=_11b;if(YMapMode.GUIDEMAP&&this.visibleGuideButton){this.guidebutton.style.display=_11b;}if(this.enableUgButton&&this.visibleUgButton){this.b1button.style.display=_11b;}};YahooMapsCtrl.prototype.setVisibleModeButton=function(_11c){var _11d=(_11c===true)?"block":"none";this.mapbutton.style.display=_11d;this.photobutton.style.display=_11d;if(YMapMode.GUIDEMAP&&this.visibleGuideButton){this.guidebutton.style.display=_11d;}if(this.enableUgButton&&this.visibleUgButton){this.b1button.style.display=_11d;}};YahooMapsCtrl.prototype.getVisibleModeButton=function(){return (this.mapbutton.style.display=="block"&&this.photobutton.style.display=="block")?true:false;};YahooMapsCtrl.prototype.setVisibleHomeButton=function(_11e){this.home.style.display=(_11e==true?"block":"none");};YahooMapsCtrl.prototype.getVisibleHomeButton=function(){return document.getElementById("homebutton").style.display=="block"?true:false;};YahooMapsCtrl.prototype.smoothLayerTo=function(_11f){this.map.smoothLayerTo(_11f-1);};function YLLPoint(){this.lat=0;this.lon=0;if(arguments.length==1){this.parse(arguments[0]);}else{if(arguments.length>1){this.lat=this.toDegree(arguments[0]);this.lon=this.toDegree(arguments[1]);}}}YLLPoint.prototype.parse=function(s){if(typeof (s)=="object"){this.lat=s.lat;this.lon=s.lon;}else{if(typeof (s)=="string"){a=s.split(/,/);if(a.length>=2){this.lat=this.toDegree(a[0]);this.lon=this.toDegree(a[1]);}}}};YLLPoint.prototype.toDegree=function(s){if(typeof (s)!="string"){return parseFloat(s);}if(s.indexOf("/")>=0){return new Dms(s).getDegree();}var p=s.split(".");if(p.length==3){return new Dms(p[0]+"/"+p[1]+"/"+p[2]).getDegree();}if(p.length==4){return new Dms(p[0]+"/"+p[1]+"/"+p[2]+"."+p[3]).getDegree();}return parseFloat(s);};YLLPoint.prototype.toLLPoint=function(){return new LLPoint(this.lat,this.lon);};YLLPoint.prototype.toString=function(){return (new Dms(this.lat)).toString().replace(/\//g,".")+","+(new Dms(this.lon)).toString().replace(/\//g,".");};YLLPoint.prototype.distance=function(pos){var p1,p2;p1=this.toLLPoint();if(typeof (pos)=="string"){p2=new LLPoint(pos.split(",")[0],pos.split(",")[1]);}else{if(typeof (pos)=="object"){p2=pos.toLLPoint();}}return p1.distance(p2);};YLLPoint.prototype.getMeshCode=LLPoint.prototype.getMeshCode;function YMapMode(){}YMapMode.MAP="map";YMapMode.AERO="aero";YMapMode.B1MAP="b1";YMapMode.GUIDEMAP="";function YEventType(){}YEventType.MAP_CLICK="click";YEventType.MAP_MOVING="mapMoving";YEventType.MAP_MOVED="mapMoved";YEventType.LAYER_CHANGED="layerChanged";YEventType.MODE_CHANGED="packageChanged";YEventType.MOUSE_OVER="mouseOver";YEventType.MOUSE_OUT="mouseOut";YEventType.MOUSE_MOVE="mouseMove";YEventType.ICON_CLICK="iconClick";YEventType.ICON_DBLCLICK="iconDblClick";YEventType.ICON_MOUSEDOWN="iconMouseDown";YEventType.ICON_MOUSEUP="iconMouseUp";YEventType.ICON_MOUSEOVER="iconMouseOver";YEventType.ICON_MOUSEOUT="iconMouseOut";YEventType.POPUP_OPEN="openPopup";YEventType.POPUP_CLOSE="closePopup";function YDatumType(){}YDatumType.TOKYO97="tokyo97";YDatumType.WGS84="wgs84";var _popupHTML=new Object();_popupHTML["topright"]="<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\"> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_btl.gif\" width=\"5\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bottom_t.gif\" width=\"100%\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_btr.gif\" width=\"8\" height=\"8\" border=\"0\"></td> </tr> <tr> <td background=\"http://i.yimg.jp/images/maps/balloon/popup_l.gif\"></td> <td bgcolor=\"#ffffcc\" nowrap><span id=\"popup_topright_message\"></span></td> <td valign=\"top\" bgcolor=\"#ffffcc\"><img id=\"popup_topright_close\" src=\"http://i.yimg.jp/images/map/flashapi/close.gif\" title=\""+decodeURIComponent("%E9%96%89%E3%81%98%E3%82%8B")+"\" style=\"cursor:pointer;\"></td> <td background=\"http://i.yimg.jp/images/maps/balloon/popup_r.gif\"></td> </tr> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bbl.gif\" width=\"5\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\" background=\"http://i.yimg.jp/images/maps/balloon/popup_bottom_b.gif\" align=\"left\"><img style=\"margin-left:0px; vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bottomleft.gif\" width=\"67\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bbr.gif\" width=\"8\" height=\"37\" border=\"0\"></td> </tr> </table>";_popupHTML["topleft"]="<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\"> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_btl.gif\" width=\"5\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bottom_t.gif\" width=\"100%\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_btr.gif\" width=\"8\" height=\"8\" border=\"0\"></td> </tr> <tr> <td background=\"http://i.yimg.jp/images/maps/balloon/popup_l.gif\"></td> <td bgcolor=\"#ffffcc\" nowrap><span id=\"popup_topleft_message\"></span></td> <td valign=\"top\" bgcolor=\"#ffffcc\"><img id=\"popup_topleft_close\" src=\"http://i.yimg.jp/images/map/flashapi/close.gif\" title=\""+decodeURIComponent("%E9%96%89%E3%81%98%E3%82%8B")+"\" style=\"cursor:pointer;\"></td> <td background=\"http://i.yimg.jp/images/maps/balloon/popup_r.gif\"></td> </tr> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bbl.gif\" width=\"5\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\" background=\"http://i.yimg.jp/images/maps/balloon/popup_bottom_b.gif\" align=\"right\"><img style=\"margin-right:0px; vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bottomright.gif\" width=\"64\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bbr.gif\" width=\"8\" height=\"37\" border=\"0\"></td> </tr> </table>";_popupHTML["bottomright"]="<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\"> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_ttl.gif\" width=\"5\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\" background=\"http://i.yimg.jp/images/maps/balloon/popup_top_t.gif\" align=\"left\"><img style=\"margin-left:0px; vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_topleft.gif\" width=\"67\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_ttr.gif\" width=\"8\" height=\"37\" border=\"0\"></td> </tr> <tr> <td background=\"http://i.yimg.jp/images/maps/balloon/popup_l.gif\"></td> <td bgcolor=\"#ffffcc\" nowrap><span id=\"popup_bottomright_message\"></span></td> <td valign=\"top\" bgcolor=\"#ffffcc\"><img id=\"popup_bottomright_close\" src=\"http://i.yimg.jp/images/map/flashapi/close.gif\" title=\""+decodeURIComponent("%E9%96%89%E3%81%98%E3%82%8B")+"\" style=\"cursor:pointer;\"></td> <td background=\"http://i.yimg.jp/images/maps/balloon/popup_r.gif\"></td> </tr> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: top;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_tbl.gif\" width=\"5\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\"><img style=\"vertical-align: top;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_top_b.gif\" width=\"100%\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: top;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_tbr.gif\" width=\"8\" height=\"8\" border=\"0\"></td> </tr> </table>";_popupHTML["bottomleft"]="<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\"> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_ttl.gif\" width=\"5\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\" background=\"http://i.yimg.jp/images/maps/balloon/popup_top_t.gif\" align=\"right\"><img style=\"margin-right:0px; vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_topright.gif\" width=\"64\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_ttr.gif\" width=\"8\" height=\"37\" border=\"0\"></td> </tr> <tr> <td width=\"5\" background=\"http://i.yimg.jp/images/maps/balloon/popup_l.gif\"></td> <td bgcolor=\"#ffffcc\" nowrap><span id=\"popup_bottomleft_message\"></span></td> <td valign=\"top\" bgcolor=\"#ffffcc\"><img id=\"popup_bottomleft_close\" src=\"http://i.yimg.jp/images/map/flashapi/close.gif\" title=\""+decodeURIComponent("%E9%96%89%E3%81%98%E3%82%8B")+"\" style=\"cursor:pointer;\"></td> <td width=\"8\" background=\"http://i.yimg.jp/images/maps/balloon/popup_r.gif\"></td> </tr> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: top;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_tbl.gif\" width=\"5\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\"><img style=\"vertical-align: top;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_top_b.gif\" width=\"100%\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: top;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_tbr.gif\" width=\"8\" height=\"8\" border=\"0\"></td> </tr> </table>";function _addPopup(){var a=["topright","topleft","bottomright","bottomleft"];for(var i=0;i<a.length;i++){var id="popup_"+a[i];if(document.getElementById(id)){continue;}var pos=(a[i].match(/top/)?"top":"bottom")+":"+(a[i].match(/right/)?"cleft":"cright");var dx=a[i].match(/right/)?-70:70;var _12b=document.createElement("div");_12b.id=id;_12b.setAttribute("pos",pos);_12b.setAttribute("dx",dx);_12b.style.zIndex=100;_12b.style.display="none";_12b.innerHTML=_popupHTML[a[i]];document.body.appendChild(_12b);}}AlpsEvent.addBuiltInEvent(window,"load",_addPopup);var _vecterPopupHTML=new Object();_vecterPopupHTML["topright"]="<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\"> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_btl.gif\" width=\"5\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bottom_t.gif\" width=\"100%\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_btr.gif\" width=\"8\" height=\"8\" border=\"0\"></td> </tr> <tr> <td background=\"http://i.yimg.jp/images/maps/balloon/popup_l.gif\"></td> <td bgcolor=\"#ffffcc\" nowrap><span id=\"_vector_popup_message\"></span></td> <td valign=\"top\" bgcolor=\"#ffffcc\"><img src=\"http://i.yimg.jp/images/map/flashapi/close.gif\" title=\""+decodeURIComponent("%E9%96%89%E3%81%98%E3%82%8B")+"\" style=\"cursor:pointer;\" onclick=\"_vectorPopupClose()\"></td> <td background=\"http://i.yimg.jp/images/maps/balloon/popup_r.gif\"></td> </tr> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bbl.gif\" width=\"5\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\" background=\"http://i.yimg.jp/images/maps/balloon/popup_bottom_b.gif\" align=\"left\"><img style=\"margin-left:0px; vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bottomleft.gif\" width=\"67\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bbr.gif\" width=\"8\" height=\"37\" border=\"0\"></td> </tr> </table>";_vecterPopupHTML["topleft"]="<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\"> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_btl.gif\" width=\"5\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bottom_t.gif\" width=\"100%\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_btr.gif\" width=\"8\" height=\"8\" border=\"0\"></td> </tr> <tr> <td background=\"http://i.yimg.jp/images/maps/balloon/popup_l.gif\"></td> <td bgcolor=\"#ffffcc\" nowrap><span id=\"_vector_popup_message\"></span></td> <td valign=\"top\" bgcolor=\"#ffffcc\"><img src=\"http://i.yimg.jp/images/map/flashapi/close.gif\" title=\""+decodeURIComponent("%E9%96%89%E3%81%98%E3%82%8B")+"\" style=\"cursor:pointer;\" onclick=\"_vectorPopupClose()\"></td> <td background=\"http://i.yimg.jp/images/maps/balloon/popup_r.gif\"></td> </tr> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bbl.gif\" width=\"5\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\" background=\"http://i.yimg.jp/images/maps/balloon/popup_bottom_b.gif\" align=\"right\"><img style=\"margin-right:0px; vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bottomright.gif\" width=\"64\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_bbr.gif\" width=\"8\" height=\"37\" border=\"0\"></td> </tr> </table>";_vecterPopupHTML["bottomright"]="<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\"> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_ttl.gif\" width=\"5\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\" background=\"http://i.yimg.jp/images/maps/balloon/popup_top_t.gif\" align=\"left\"><img style=\"margin-left:0px; vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_topleft.gif\" width=\"67\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_ttr.gif\" width=\"8\" height=\"37\" border=\"0\"></td> </tr> <tr> <td background=\"http://i.yimg.jp/images/maps/balloon/popup_l.gif\"></td><td bgcolor=\"#ffffcc\" nowrap><span id=\"_vector_popup_message\"></span></td><td valign=\"top\" bgcolor=\"#ffffcc\"><img src=\"http://i.yimg.jp/images/map/flashapi/close.gif\" title=\""+decodeURIComponent("%E9%96%89%E3%81%98%E3%82%8B")+"\" style=\"cursor:pointer;\" onclick=\"_vectorPopupClose()\"></td> <td background=\"http://i.yimg.jp/images/maps/balloon/popup_r.gif\"></td> </tr> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: top;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_tbl.gif\" width=\"5\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\"><img style=\"vertical-align: top;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_top_b.gif\" width=\"100%\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: top;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_tbr.gif\" width=\"8\" height=\"8\" border=\"0\"></td> </tr> </table>";_vecterPopupHTML["bottomleft"]="<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\"> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_ttl.gif\" width=\"5\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\" background=\"http://i.yimg.jp/images/maps/balloon/popup_top_t.gif\" align=\"right\"><img style=\"margin-right:0px; vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_topright.gif\" width=\"64\" height=\"37\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: bottom;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_ttr.gif\" width=\"8\" height=\"37\" border=\"0\"></td> </tr> <tr> <td width=\"5\" background=\"http://i.yimg.jp/images/maps/balloon/popup_l.gif\"></td> <td bgcolor=\"#ffffcc\" nowrap><span id=\"_vector_popup_message\"></span></td> <td valign=\"top\" bgcolor=\"#ffffcc\"><img src=\"http://i.yimg.jp/images/map/flashapi/close.gif\" title=\""+decodeURIComponent("%E9%96%89%E3%81%98%E3%82%8B")+"\" style=\"cursor:pointer;\" onclick=\"_vectorPopupClose()\"></td> <td width=\"8\" background=\"http://i.yimg.jp/images/maps/balloon/popup_r.gif\"></td> </tr> <tr> <td style=\"line-height: 0px;\"><img style=\"vertical-align: top;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_tbl.gif\" width=\"5\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\" colspan=\"2\"><img style=\"vertical-align: top;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_top_b.gif\" width=\"100%\" height=\"8\" border=\"0\"></td> <td style=\"line-height: 0px;\"><img style=\"vertical-align: top;\" src=\"http://i.yimg.jp/images/maps/balloon/popup_tbr.gif\" width=\"8\" height=\"8\" border=\"0\"></td> </tr> </table>";function _vectorPopupAddPopup(){var a=["topright","topleft","bottomright","bottomleft"];var id="_vector_popup";for(var i=0;i<a.length;i++){var _12f=id+"_"+a[i];if(!document.getElementById(_12f)){var _130=document.createElement("div");_130.id=_12f;_130.style.zIndex=0;_130.style.display="none";_130.style.position="absolute";_130.innerHTML=_vecterPopupHTML[a[i]];document.body.appendChild(_130);}}}AlpsEvent.addBuiltInEvent(window,"load",_vectorPopupAddPopup);function _vectorPopupClose(flg){if(_address_yahoomap){var _132=_getVectorPopupElement();if(_132[0]){_132[0].style.display="none";}if(_132[1]){_132[1].style.display="none";}if(_132[2]){_132[2].style.display="none";}if(_132[3]){_132[3].style.display="none";}if(!flg==true){_address_yahoomap.vec.vectorPopupOrigin="";}_address_yahoomap.vec.bVectorPopupOpen=false;}}function _vectorPopupCloseEvent(e){CancelBubble(e);if(_address_yahoomap){if(_address_yahoomap.vec.bVectorPopupOpen){_address_yahoomap.vec.bVectorPopupOpen=false;_vectorPopupClose();}}}function _setVectorPopupHtml(div,_135){var span=div.getElementsByTagName("span");var len=span.length;for(var i=0;i<len;i++){if(span[i].id=="_vector_popup_message"){span[i].innerHTML=_135;break;}}}function _getVectorPopupElement(){var a=["topright","topleft","bottomright","bottomleft"];var id="_vector_popup_";var div=new Array();div[0]=document.getElementById(id+a[0]);div[1]=document.getElementById(id+a[1]);div[2]=document.getElementById(id+a[2]);div[3]=document.getElementById(id+a[3]);return div;}function _getHtmlSize(html){var s=new Size(0,0);var div=document.createElement("div");div.style.position="absolute";div.innerHTML=html;document.body.appendChild(div);s.set(div.offsetWidth,div.offsetHeight);document.body.removeChild(document.body.lastChild);return s;}function _getElementePosition(e){var pos=new Point(0,0);while(e){pos.x+=e.offsetLeft;pos.y+=e.offsetTop;e=e.offsetParent;}return pos;}function _getMousePosition(evt,e){var _143=_getElementePosition(e);var x,y;if(window.createPopup){if(document.compatMode=="CSS1Compat"){x=window.document.documentElement.scrollLeft+window.event.clientX-_143.x;y=window.document.documentElement.scrollTop+window.event.clientY-_143.y;}else{x=window.document.body.scrollLeft+window.event.clientX-_143.x;y=window.document.body.scrollTop+window.event.clientY-_143.y;}}else{x=evt.pageX-_143.x;y=evt.pageY-_143.y;}return new Point(x,y);}function _isYLLPointArray(p){if((typeof (p)=="object")&&(p.constructor==Array)){var len=p.length;if(!len){return false;}for(var i=0;i<len;i++){if(!((typeof (p[i])=="object")&&(p[i].constructor==YLLPoint))){return false;}}return true;}else{return false;}}
/* 2010.01.14 */
