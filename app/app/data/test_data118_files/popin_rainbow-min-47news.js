if(!PopIn&&window.parent.location.href!="topsites://"){var PopIn={DummieData:{}}}PopIn.$F={cssExclude:/z-?index|font-?weight|opacity|zoom|line-?height/};PopIn.$F.browser="\v"=="v"?"ie":"firefox";PopIn.$F.isIE="\v"=="v"?true:false;PopIn.$F.isIE6=PopIn.$F.isIE&&typeof document.documentElement.style.maxHeight=="undefined";PopIn.$F.boxModel=false;PopIn.$F.isFirefox=/a/[-1]=="a"?true:false;PopIn.$F.isSafari=/a/.__proto__=="//"?true:false;PopIn.$F.getLang=function(){var a=navigator.userAgent;var b;if(a.indexOf("IE")>-1){b=navigator.userLanguage}else{b=a}if(b.indexOf("ja")>-1){b="ja"}else{b="en"}return b};PopIn.$F.aspectBefore=function(d,c,b){var a=d[c];d[c]=function(){b.apply(this,arguments);return a.apply(this,arguments)}};PopIn.$F.aspectAround=function(d,c,b){var a=d[c];d[c]=function(){var f=[a];for(var e=0;e<arguments.length;e++){f.push(arguments[e])}return b.apply(this,f)}};PopIn.$F.aspectAfter=function(d,c,b){var a=d[c];d[c]=function(){var e=a.apply(this,arguments);b.apply(this,arguments);return e}};PopIn.$=function(){if(arguments.length==1&&typeof arguments[0]=="object"){return PopIn.$F.extendElement(arguments[0])}else{if(arguments.length==1&&typeof arguments[0]=="string"){return PopIn.$F.extendElement(document.getElementById(arguments[0]))}else{if(arguments.length==2){var a=arguments[0];var b=arguments[1];if(b.jqo){b=b.elements[0]}return PopIn.$F.extendElement(PopIn.$F.toArray(b.getElementsByTagName(a)))}}}return};PopIn.$F.extendElement=function(c){if(c&&c.jqo){return c}var d={jqo:true,elements:!c?[]:(PopIn.$F.isArray(c)?c:[c]),get:function(e){return this.elements[e]},slice:function(e){this.elements.splice(e,1);return this},getChildren:function(){var e=[];for(var f=0;f<this.elements[0].childNodes.length;f++){e.push(this.elements[0].childNodes.item(f))}return PopIn.$F.extendElement(e)}};if(typeof c=="undefined"){c={}}var a=["error","html","width","height","text","size","parent","hide","attr","bind","css","bodyOffset","offset","remove","toggle","fadeIn","fadeOut","animate","show","slideDown","slideUp","empty","append","position"];for(var b=0;b<a.length;b++){PopIn.$F.extendElementFunction(d,a[b])}return d};PopIn.$F.extendElementFunction=function(b,a){b[a]=function(){var g=[];for(var e=0;e<this.elements.length;e++){var f=this.elements[e];var c=PopIn.$F.join([f],arguments);var d=PopIn.$F[a].apply(f,c);g.push(d==f?this:d)}return g.length==1?g[0]:this}};PopIn.$F.getElementsByTagAndClassName=function(d,c,f){var e;var a=[];var b;if(d.querySelectorAll){return PopIn.$F.toArray(d.querySelectorAll(c+"."+f))}e=d.getElementsByTagName(c);for(b=0;b<e.length;b++){if((" "+e.item(b).className+" ").indexOf(" "+f+" ")>=0){a.push(e.item(b))}}return a};PopIn.$F.bind=function(){var a=arguments[0];var e=arguments[1];var d=typeof arguments[2]=="object"?arguments[2]:{};var b=typeof arguments[2]=="object"?arguments[3]:arguments[2];var f=function(){return true};if(e=="mouseenter"){e="mouseover";f=function(h){var i=h.relatedTarget||h.fromElement;var g=true;while(g&&i){if(i==a){g=false}i=i.parentNode}return g}}if(e=="mouseleave"){e="mouseout";f=function(h){var i=h.relatedTarget||h.toElement;var g=true;while(g&&i){if(i==a){g=false}i=i.parentNode}return g}}var c=function(h){h=h||window.event;if(f.apply(this,[h])){var g=b.apply(a,[h,d]);if(!PopIn.$F.isIE&&g===false){h.preventDefault();h.stopPropagation()}else{if(PopIn.$F.isIE&&g===false){h.returnValue=false;h.cancelBubble=true}}}};if(!PopIn.$F.isIE){a.addEventListener(e,c,false)}else{a.attachEvent("on"+e,c)}return a};PopIn.$F.css=function(){var c=arguments[0];if(typeof arguments[1]=="string"&&arguments.length==2){return PopIn.$F.cssGet(c,arguments[1])}else{if(typeof arguments[1]=="string"&&arguments.length==3){PopIn.$F.cssSet(c,arguments[1],arguments[2]);return c}else{if(typeof arguments[1]=="object"){var b=arguments[1];for(var a in b){PopIn.$F.cssSet(c,a,b[a])}return c}}}};PopIn.$F.cssSet=function(b,a,c){if(PopIn.$F.isIE&&a=="background"||a=="background-image"){var d=c.match(/url\("(.*?\.png)"?\)/);if(d){b.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+d[1]+'",sizingMethod="scale")'}}if(a=="opacity"){PopIn.$F.cssSet(b,"zoom",c<1?1:0);PopIn.$F.cssSet(b,"filter",c<1?"alpha(opacity="+Number(c*100)+")":"")}if(typeof c=="number"&&!PopIn.$F.cssExclude.test(a)){c+="px"}if(!PopIn.$F.isIE){b.style.setProperty(a,c,null)}else{if(a.indexOf("-")>0){a=a.replace(/\-(\w)/g,function(e,f){return f.toUpperCase()})}b.style[a]=c}};PopIn.$F.cssGet=function(c,b){var d=(b=="opacity")?1:null;if(PopIn.$F.isIE){return c.style[b]}else{if(b=="position"){var e=PopIn.Utils?PopIn.Utils.getDocument():document;var a=e.defaultView.getComputedStyle(c,null).getPropertyValue(b)}else{var a=c.style.getPropertyValue(b)}}return typeof a==="undefined"?d:a};PopIn.$F.toggle=function(a){var b=PopIn.$F.cssGet(a,"display");if(b!="none"){PopIn.$F.hide(a)}else{PopIn.$F.cssSet(a,"display",a.lastToggle||"block")}return a};PopIn.$F.hide=function(a){a.lastToggle=PopIn.$F.cssGet(a,"display");PopIn.$F.cssSet(a,"display","none");return a};PopIn.$F.remove=function(a){if(a.parentNode){a.parentNode.removeChild(a)}return a};PopIn.$F.parent=function(a){return PopIn.$(a.parentNode)};PopIn.$F.show=function(a){PopIn.$F.css(a,{display:"block"});return a};PopIn.$F.empty=function(a){while(a.hasChildNodes()){a.removeChild(a.firstChild)}return a};PopIn.$F.append=function(a,b){if(b.jqo){b=b.elements[0]}a.appendChild(b);return a};PopIn.$F.attr=function(){var c=arguments[0];if(arguments.length==2&&typeof arguments[1]=="object"){var a=arguments[1];for(var b in a){PopIn.$F.attr(c,b,a[b])}return c}else{if(arguments.length==2&&typeof arguments[1]=="string"){return c[arguments[1]]}else{if(arguments.length==3){c[arguments[1]]=arguments[2];return c}}}};PopIn.$F.width=function(a){return PopIn.$F.size(a).width};PopIn.$F.height=function(a){return PopIn.$F.size(a).height};PopIn.$F.error=function(a,b){return a};PopIn.$F.html=function(b,a){b.innerHTML=a;return b};PopIn.$F.resizable=function(a){if(!a.elements){return}if(!a.handler){return}if(!a.minWidth){a.minWidth=0}if(!a.minHeight){a.minHeight=0}var b={options:a,status:0};PopIn.$(a.handler).bind("mousedown",function(c){b.ready(c);return false});PopIn.$(document.documentElement).bind("mousemove",function(c){b.move(c);return b.status==0});PopIn.$(document.documentElement).bind("mouseup",function(c){b.end(c);return b.status==0});b.ready=function(c){this.status=1};b.start=function(f){this.status=2;this.objectStart=[];for(var d=0;d<this.options.elements.length;d++){var e=this.options.elements[d];var c=PopIn.$F.size(e);this.objectStart.push({width:c.width,height:c.height,mouseX:f.screenX,mouseY:f.screenY});if(e.tagName=="TABLE"&&PopIn.$F.isIE&&PopIn.$F.boxModel){this.objectStart[d].height=new Number(PopIn.$(e).css("height").replace("px",""))}}if(this.options.start){this.options.start.apply(this,[f])}};b.move=function(j){if(this.status==1){this.start(j)}if(this.status<2){return}var e={width:true,height:true};if(this.options.restrictedMin){for(var g=0;g<this.options.elements.length;g++){var h=this.options.elements[g];var f=this.objectStart[g];if(f.height-f.mouseY+j.screenY<this.options.minHeight){e.height=false}}}for(var g=0;g<this.options.elements.length;g++){var h=this.options.elements[g];var f=this.objectStart[g];var d=j.screenX-f.mouseX;var c=j.screenY-f.mouseY;if(d>0||e.width){PopIn.$(h).css({width:Math.max(f.width+d,this.options.minWidth)})}if(c>0||e.height){PopIn.$(h).css({height:Math.max(f.height+c,this.options.minHeight)})}}if(this.options.move){this.options.move.apply(this,[j])}};b.end=function(c){if(this.status==2){if(this.options.end){this.options.end.apply(this,[c])}}this.status=0;return false};return b};PopIn.$F.draggable=function(a){if(!a.elements){return}if(!a.handler){return}if(!a.minWidth){a.minWidth=0}if(!a.minHeight){a.minHeight=0}var b={options:a,status:0};PopIn.$(a.handler).bind("mousedown",function(c){b.ready(c);return false});PopIn.$(document.documentElement).bind("mousemove",function(c){b.move(c);return b.status==0});PopIn.$(document.documentElement).bind("mouseup",function(c){b.end(c);return b.status==0});b.ready=function(c){this.status=1};b.start=function(f){this.status=2;this.objectStart=[];for(var d=0;d<this.options.elements.length;d++){var e=this.options.elements[d];var c=PopIn.$F.position(e);this.objectStart.push({startX:c.left,startY:c.top,mouseX:f.screenX,mouseY:f.screenY})}if(this.options.start){this.options.start.apply(this,[f])}};b.move=function(f){if(this.status==1){this.start(f)}if(this.status<2){return}for(var d=0;d<this.options.elements.length;d++){var e=this.options.elements[d];var c=this.objectStart[d];PopIn.$(e).css({left:Math.max(c.startX-c.mouseX+f.screenX,0),top:Math.max(c.startY-c.mouseY+f.screenY,0)})}if(this.options.move){this.options.move.apply(this,[f])}};b.end=function(c){if(this.status==2&&this.options.end){this.options.end.apply(this,[c])}this.status=0;return false};return b};PopIn.$F.animate=function(b,d,c){if(typeof c=="undefined"){c={}}if(typeof c!="object"){c={speed:c}}if(typeof c.speed=="string"&&c.speed=="slow"){c.speed=500}if(typeof c.speed=="string"&&c.speed=="fast"){c.speed=100}if(typeof c.speed=="string"&&c.speed=="medium"){c.speed=300}var a=PopIn.$F.join({element:b,style:d,speed:500,steps:PopIn.$F.isIE?10:100,exp:3},c);a.start=function(){a.initialStyle={};for(var e in this.style){a.initialStyle[e]=PopIn.$F.cssGet(this.element,e)}for(var e=0;e<this.steps;e++){var f=(e+1)/this.steps;setTimeout(PopIn.$F.pass(a.move,a,[Math.pow(f,this.exp)]),f*this.speed)}};a.move=function(g){for(var f in this.style){var h=this.initialStyle[f];var e=this.style[f];if(typeof h=="string"){h=Number(h.replace("px","").replace("%",""))}if(typeof e=="string"){e=Number(e.replace("px","").replace("%",""))}PopIn.$(this.element).css(f,(e-h)*g+h)}if(g==1&&this.end){this.end.apply(this)}};a.start()};PopIn.$F.slideDown=function(e,f,c){var b={};if(typeof f!="undefined"){b.speed=f}if(typeof c!="undefined"){b.end=c}var d=b.end;var a=PopIn.$(e).css("height");PopIn.$(e).css({height:"0px",display:"block",overflow:"hidden"});PopIn.$F.animate(e,{height:a},PopIn.$F.join(b,{end:function(){PopIn.$(e).css({overflow:"visible"});if(d){d.apply(this)}}}))};PopIn.$F.slideUp=function(d,e,b){var a={};if(typeof e!="undefined"){a.speed=e}if(typeof b!="undefined"){a.end=b}var c=a.end;PopIn.$(d).css({overflow:"hidden"});PopIn.$F.animate(d,{height:0},PopIn.$F.join(a,{end:function(){PopIn.$(d).css({overflow:"visible",display:"none"});if(c){c.apply(this)}}}))};PopIn.$F.fadeIn=function(b){var a;if(arguments.length==3){a={speed:arguments[1],end:arguments[2]}}else{if(arguments.length==2&&typeof arguments[1]=="object"){a=arguments[1]}else{if(arguments.length==2){a={speed:arguments[1]}}}}PopIn.$(b).css({opacity:0,display:""});PopIn.$F.animate(b,{opacity:1},a)};PopIn.$F.fadeOut=function(b){var a;if(arguments.length==3){a={speed:arguments[1],end:arguments[2]}}else{if(arguments.length==2&&typeof arguments[1]=="object"){a=arguments[1]}else{if(arguments.length==2){a={speed:arguments[1]}}}}PopIn.$F.animate(b,{opacity:0},a)};PopIn.$F.size=function(a){return{width:a.offsetWidth,height:a.offsetHeight}};PopIn.$F.bodyOffset=function(b){var d=PopIn.Utils?PopIn.Utils.getDocument():document;var a=PopIn.$F.position(b);var c=PopIn.$F.position(d.body);if(PopIn.$(d.body).css("position")=="relative"){a.left-=(d.body.offsetLeft||c.left);a.top-=(d.body.offsetTop||c.top)}return a};PopIn.$F.position=function(c){if(c.getBoundingClientRect){var g=c.getBoundingClientRect();var f=PopIn.Utils?PopIn.Utils.getDocument():document;var b=f.documentElement;var a=f.body;return{left:Math.round(g.left+(a.scrollLeft||b.scrollLeft)-b.clientLeft),top:Math.round(g.top+(a.scrollTop||b.scrollTop)-b.clientTop)}}else{var e=0,d=0;for(;c!=undefined;c=c.offsetParent){d+=c.offsetLeft;e+=c.offsetTop}return{top:e,left:d}}};PopIn.$F.text=function(b,a){if(typeof b.textContent=="undefined"){b.innerText=a}else{b.textContent=a}return b};PopIn.$F.trim=function(a){return(a||"").replace(/^\s+|\s+$/g,"")};PopIn.$F.clone=function(e,a){if(typeof a=="undefined"){a=true}if(e==null||typeof(e)!="object"){return e}if(typeof e.length=="number"){var b=[];for(var d=0;d<e.length;d++){b.push(a?PopIn.$F.clone(e[d]):e[d])}return b}else{var b={};for(var c in e){b[c]=a?PopIn.$F.clone(e[c]):e[c]}return b}};PopIn.$F.join=function(d,c){if(typeof d=="undefined"){d={}}if(typeof c=="undefined"){c={}}if(typeof d!="object"||typeof c!="object"){return}if(typeof d.length=="number"&&typeof c.length=="number"){var a=PopIn.$F.clone(d,false);for(var b=0;b<c.length;b++){a.push(c[b])}return a}else{var a=PopIn.$F.clone(d,false);for(var b in c){a[b]=c[b]}return a}};PopIn.$F.isArray=function(a){var b=Object.prototype.toString;return b.call(a)=="[object Array]"};PopIn.$F.toArray=function(b){var a=[];for(var c=0;c<b.length;c++){a.push(b[c])}return a};PopIn.$F.createHttpRequest=function(){if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){return}}}else{if(window.XMLHttpRequest){return new XMLHttpRequest()}else{return}}};PopIn.$F.ajax=function(){var b;if(arguments.length==2){b={url:arguments[0],success:arguments[1]}}else{if(arguments.length==1&&typeof arguments[0]=="object"){b=arguments[0]}else{throw"Invalid Arguments"}}var c=document.getElementsByTagName("head")[0];window.pi_ajax=function(f){window.pi_ajax=undefined;try{delete window.pi_ajax}catch(e){}b.success(f);try{setTimeout(function(){c.removeChild(d)},0)}catch(e){}};var d=document.createElement("script");var a=b.url;a+=((a.indexOf("?")>=0)?"&":"?")+"callback=pi_ajax";d.src=a;if(b.charset){d.charset=b.charset}c.appendChild(d)};PopIn.$F.getJSON=function(){var options;if(arguments.length==2){options={url:arguments[0],success:arguments[1]}}else{if(arguments.length==1&&typeof arguments[0]=="object"){options=arguments[0]}else{throw"Invalid Arguments"}}var url=options.url;var http=PopIn.$F.createHttpRequest();http.onreadystatechange=function(){if(http.readyState==4){eval("var data = "+http.responseText);options.success(data)}};try{http.open("GET",url,true);http.send("")}catch(e){options.error(e)}};PopIn.$F.pass=function(c,d,a){var b=c;return function(){b.apply(d,a)}};PopIn.$F.scrollY=function(){return(document.body.scrollTop||document.documentElement.scrollTop)-document.documentElement.clientTop};PopIn.$F.scrollX=function(){return(document.body.scrollLeft||document.documentElement.scrollLeft)-document.documentElement.clientLeft};(function(){var a=function(){if(document.body){var b=document.createElement("div");b.style.width=b.style.paddingLeft="1px";document.body.appendChild(b);PopIn.$F.boxModel=b.offsetWidth===2;document.body.removeChild(b)}};if(document.body){a()}else{PopIn.$(window).bind("load",a)}})();PopIn.BaseObject=function(){};PopIn.BaseObject.prototype.createObject=function(){var b=[].slice.call(arguments);var c=b.shift();PopIn.Log.debug("createObject["+c+"]");var d=new PopIn[c]();d.window=this.window;d.document=this.document;if(d.initialize){d.initialize.apply(d,b)}return d};PopIn.BaseObject.prototype.getPopIn=function(){if(typeof popIn=="object"){return popIn}else{return this.document.popIn}};PopIn.Core=function(){this.initialize()};PopIn.Core.prototype=new PopIn.BaseObject();PopIn.Core.prototype.initialize=function(){this.state=new PopIn.Utils.State(true);this.window=PopIn.Utils.getWindow();this.document=this.window.document;this.eventManager=this.createObject("EventManager");this.windowManager=this.createObject("WindowManager");this.text="";this.connectionID=new Date().getTime();this.eventManager.addEventListener("closeActiveWindow",PopIn.Utils.bind(this.closeActiveWindow,this));this.eventManager.addEventListener("textSelected",PopIn.Utils.bind(this.launchSelectLogo,this));this.eventManager.addEventListener("hideLogo",PopIn.Utils.bind(this.destroyMenu,this));this.eventManager.addEventListener("hideLogo",PopIn.Utils.bind(this.hideUserInput,this));this.eventManager.addEventListener("userInput",PopIn.Utils.bind(this.userInput,this));this.eventManager.addEventListener("hideUserInput",PopIn.Utils.bind(this.hideUserInput,this));this.eventManager.addEventListener("showUserInput",PopIn.Utils.bind(this.showUserInput,this));if(PopIn.Config.getNotices().length>0){this.showInformation(PopIn.Config.getNotices()[0]);PopIn.Config.clearNotices()}};PopIn.Core.prototype.handleQueryString=function(){var a=PopIn.Utils.getParameter("node");if(a){var c=PopIn.Utils.getParameter("serviceId");var d=PopIn.Utils.getParameter("text");var b=PopIn.Utils.searchNode(a);if(b){this.text=d;this.mode="popinMode";this.popinParent=b;new PopIn.Service(PopIn.Config.getServiceById(c)).onClick()}else{}}else{}};PopIn.Core.prototype.showInformation=function(e,c){var b=PopIn.Utils.createElement("div");b.id="popIn_inf"+Math.random();var f=PopIn.$(b);f.css(PopIn.Resource.getStyle("notice-back")).css({position:"absolute","z-index":999999,top:5+"px",right:"5px",display:"none",cursor:"pointer"});var d=PopIn.Utils.createElement("div");PopIn.$(d).css({margin:"8px 8px 0px 70px","font-size":"14px",color:"white","text-align":"left","line-height":"100%"});d.innerHTML=e;if(c){PopIn.$(b).bind("click",c)}b.appendChild(d);var a=this;setTimeout(function(){f.fadeOut("slow",function(){f.remove()})},20000);setTimeout(function(){f.fadeIn("slow");a.document.body.appendChild(b)},2000)};PopIn.Core.prototype.closeActiveWindow=function(b){if(typeof b=="undefined"||(b.type.indexOf("click")>=0||PopIn.Utils.isEscape(b))){var a=this.windowManager.getWindowByStatus(PopIn.Window.prototype.STATUS_PREVIEW);var c=this.windowManager.getWindowByStatus(PopIn.Window.prototype.STATUS_NORMAL);if(a){a.close()}else{if(c){c.close()}}}};PopIn.Core.prototype.launchSelectLogo=function(a){this.hideUserInput();this.mode="selectMode";this.range=PopIn.Utils.getSelectionRange();var b=PopIn.Utils.findSelectionPosition();if(b.top==0&&b.left==0){return}b.top-=3;this.showMenu({center:b})};PopIn.Core.prototype.showUserInput=function(a){if(PopIn.Utils.isEscape(a)){this.hideUserInput()}if(PopIn.Utils.isShortcutKey(a)){if(!this.currentInput){this.mode="shortcutMode";this.currentInput=this.createObject("UserInput")}}};PopIn.Core.prototype.FirefoxshowUserInput=function(a){if(PopIn.Utils.isEscape(a)){this.hideUserInput()}if(!this.currentInput){this.mode="shortcutMode";this.currentInput=this.createObject("UserInput")}};PopIn.Core.prototype.gotoCustomizePage=function(a){this.hideUserInput();this.destroyMenu();this.mode="pushMode";this.showService(new PopIn.Service(PopIn.Config.buildSettingService(a)))};PopIn.Core.prototype.hideUserInput=function(){if(this.currentInput){this.currentInput.destroy();this.currentInput=null}};PopIn.Core.prototype.userInput=function(a){if(PopIn.Utils.isEscape(a)){this.hideUserInput()}};PopIn.Core.prototype.showService=function(a){var c=new Number(a.data.serviceId);if(c>20000&&c<20009){this.mode="pushMode"}this.url=PopIn.Utils.getDocument().location;this.title=PopIn.Utils.getDocument().title;this.destroyMenu();this.hideUserInput();var b=this.windowManager.getWindowByStatus(PopIn.Window.prototype.STATUS_LOCKED);if(this.mode!="pushMode"&&typeof b!="undefined"&&b.options.type=="popUp"){b.changeService(a);this.windowManager.resetPosition(b)}else{if(this.mode=="selectMode"){if(a.data.inputModes.selectMode.type=="popInInlineText"){this.createObject("InlineText",a)}else{if(!a.data.inputModes.selectMode.isPopin){this.windowManager.createWindow(a,{type:"popUp",parent:"auto"})}else{this.windowManager.createWindow(a,{type:"popIn",parent:"auto"})}}}else{if(this.mode=="pushMode"){this.windowManager.createWindow(a,{type:"popUp"})}else{if(this.mode=="shortcutMode"&&a.data.inputModes.shortcutMode){this.windowManager.createWindow(a,{type:"popUp",fixed:false});this.hideUserInput()}else{if(this.mode=="popinMode"){this.mode="selectMode";this.windowManager.createWindow(a,{type:"popIn",parentNode:this.popinParent})}}}}}};PopIn.Core.prototype.createPushService=function(f){if(f.getAttribute("type")=="image"){var a=PopIn.Config.buildPreviewService(PopIn.Resource.getMessage("preview"));this.mode="pushMode";if(a==null){return}a.serviceUrl=f.getAttribute("originalcontexturl");a.inputModes.selectMode.isResizable="false";var b=PopIn.Utils.createElement("center");var g=PopIn.Utils.createElement("img");b.appendChild(g);g.src=f.getAttribute("src");a.serviceElement=b;var j={imgW:Number(f.getAttribute("width")),imgH:Number(f.getAttribute("height")),windowW:PopIn.Utils.getViewportWidth(),windowH:PopIn.Utils.getViewportHeight()};if(f.getAttribute("title")!=""){a.serviceName=f.getAttribute("title")}var i=22;var h=56;if(j.imgW>j.windowW-i||j.imgH>j.windowH-h){if(j.imgW/j.windowW>j.imgH/j.windowH){j.imgH*=(j.windowW-i)/j.imgW;j.imgW=j.windowW-i}else{j.imgW*=(j.windowH-h)/j.imgH;j.imgH=j.windowH-h}}g.width=Number(j.imgW);g.height=Number(j.imgH);a.inputModes.selectMode.width=j.imgW+i;a.inputModes.selectMode.height=j.imgH+h;a.inputModes.pushMode.width=j.imgW+i;a.inputModes.pushMode.height=j.imgH+h;var e=this.windowManager.getWindowByStatus(PopIn.Window.prototype.STATUS_LOCKED);if(e){var c=e.getWindowWidth();var d=PopIn.Utils.getViewportWidth()-c-10;a.inputModes.selectMode.width=Math.max(800,d);a.inputModes.pushMode.width=Math.max(800,d)}a.optionsType=f.getAttribute("type");a.optionsData=f.getAttribute("optionsData");a.optionsName=f.getAttribute("optionsName")}else{if(f.getAttribute("type")=="video"){var a=PopIn.Config.buildPreviewService(PopIn.Resource.getMessage("preview"));this.mode="pushMode";var e=this.windowManager.getWindowByStatus(PopIn.Window.prototype.STATUS_LOCKED);if(e){var c=e.getWindowWidth();var d=PopIn.Utils.getViewportWidth()-c-10;a.inputModes.selectMode.width=Math.max(480,d);a.inputModes.pushMode.width=Math.max(480,d)}if(f.getAttribute("title")!=""){a.serviceName=f.getAttribute("title")}a.optionsType=f.getAttribute("type");a.optionsData=f.getAttribute("optionsData");a.optionsName=f.getAttribute("optionsName");a.serviceUrl=f.getAttribute("src")}else{if(f.getAttribute("type")=="iframe"){var a=PopIn.Config.buildPreviewService(PopIn.Resource.getMessage("preview"));this.mode="pushMode";var e=this.windowManager.getWindowByStatus(PopIn.Window.prototype.STATUS_LOCKED);if(e){var c=e.getWindowWidth();var d=PopIn.Utils.getViewportWidth()-c-10;a.inputModes.selectMode.width=Math.max(800,d);a.inputModes.pushMode.width=Math.max(800,d)}if(f.getAttribute("title")!=""){a.serviceName=f.getAttribute("title")}a.serviceUrl=f.getAttribute("src");a.optionsType=f.getAttribute("type");a.optionsData=f.getAttribute("optionsData");a.optionsName=f.getAttribute("optionsName")}}}return new PopIn.Service(a)};PopIn.Core.prototype.displayObject=function(b){var a=this.createPushService(b);setTimeout(function(){a.onClick()},1)};PopIn.Core.prototype.diyObject=function(a){this.createObject("DIY",a)};PopIn.Core.prototype.showMenu=function(a){this.destroyMenu();this._menu=this.createObject(PopIn.logoClass,a);return this._menu};PopIn.Core.prototype.destroyMenu=function(){if(this._menu){this._menu.destroy();this._menu=undefined}};PopIn.Resource={language:PopIn.$F.getLang(),base:"http://static.popin.cc/images/132/",files:["color_black/images.png","color_black/images-x.png","color_black/images-y.png"]};(function(){var c=[["openTab","Open in new tab","新規タブで開く"],["translationError","Translation Failed","翻訳できませんでした。"],["newService","New Service","新サービス"],["displayMethod","Display: ","表示方法："],["size","Size: ","サイズ："],["cancel","Cancel: ","[キャンセル]"],["addService","Click to add this service.","クリックして、この新サービスを追加します。"],["close","Close (Tip: Press Esc or click outside window to close.)","閉じる(Tips:Escキーを押すかウィンドーの外側をクリックすると消えます)"],["setting","Settings","設 定"],["settingFeedback","popIn Settings","popIn 設 定..."],["max","Maximize","最大化"],["tb_maxtb","Open toolbar","ツールバーを開きます"],["tb_mintb","Close toolbar","ツールバーを閉じます"],["notice_update","<b>New service has been added</b><br />","<b>新しいサービスが追加されました</b><br />"],["loading","Loading..","読み込み中..."],["nopreview","No preview available.","取得できませんでした、クリックしてプレビューしてください。"],["preview","Preview","プレビュー"],["preview_setting","Preview Settings","プレビュー設定"],["diycancel","Cancel","キャンセル"],["diymake","Create popDIY","作成する"],["diyok","popDIY successfully created.","サービス作成しました"],["howtodiy","popDIY Help","設定してください"],["diydesc","Drag the box to select the desired size","これをドラッグ＆ドロップ、リサイズして、表示する部分の位置・大きさを調整してください。"],["unlockMes","Click to set position in window","ロックするとpopInウィンドウの画面上の位置が固定されます"],["lockMes","Click to unlock","クリックするとロックが解除されます"],["serviceInformation","service is available","サービスがあります"],["disableButton","Suspend...","popIn ヘルプ"],["closeButton","Close...","閉じる"],["closeWindow","Close window...","ウィンドウを閉じる"]];var f=PopIn.Resource.base;var e=[["arrow","http://static.popin.cc/more.gif"],["configJsIE","http://www.popin.cc/$l/plugin/ie/updateIE.js?"],["configJsFirefox","http://www.popin.cc/$l/plugin/firefox/updateFirefox.js?"],["setting","http://www.popin.cc/$l/services/setting132/index.html"],["excludeListSetting","http://popin.cc/ja/services/rainbow_setting/index.html"],["closeBtn",f+"icon_close110.png"],["smallPreLoader",f+"small-ajax-loader.gif"],["previewUrl","http://nani.popin.cc/rs/popin.cgi?p="],["preload",f+"ajax-loader.gif"],["loadImg",f+"text-loader.gif"],["blank","http://popin.cc/$l/log/blank.gif"],["serviceList","http://www.popin.cc/$l/services/setting/services_list.js"],["diyHelper","http://www.popin.cc/$l/plugin/modules/diyhelper.html"],["serviceJsonpUrl","http://popin.cc/$l/services/jsonp/"],["serviceAjaxUrl","http://popin.cc/$l/services/ajax/"],["madeDiyUrl","http://popin.cc/$l/plugin.html?iframe=madeDiy"]];var d={"input-back":{background:"transparent url($f3) repeat-y scroll 0px 0",height:"100%",width:"196px"},"input-footer":{background:"transparent url($f1) no-repeat scroll 0 0px",width:"196px",height:"19px"},"input-hr":{background:"transparent url($f2) repeat-x scroll 0 0px",width:"100%",height:"2px"},"input-search":{background:"transparent url($f1) no-repeat scroll 0 -19px",width:"178px",height:"25px"},"input-top":{background:"transparent url($f1) no-repeat scroll 0 -44px",width:"196px",height:"5px"},"menu-middle":{background:"transparent url($f3) repeat-y scroll -196px 0",height:"100%",width:"143px"},"menu-top":{background:"transparent url($f1) no-repeat scroll 0 -49px",width:"143px",height:"10px"},tb_close:{background:"transparent url($f1) no-repeat scroll 0 -59px",width:"25px",height:"24px"},tb_maxtb:{background:"transparent url($f1) no-repeat scroll 0 -83px",width:"25px",height:"24px"},tb_mintb:{background:"transparent url($f1) no-repeat scroll 0 -107px",width:"25px",height:"24px"},tb_newtab:{background:"transparent url($f1) no-repeat scroll 0 -131px",width:"24px",height:"24px"},tb_search:{background:"transparent url($f1) no-repeat scroll 0 -155px",width:"192px",height:"24px"},tb_search_logo:{background:"transparent url($f1) no-repeat scroll 0 -179px",width:"22px",height:"24px"},tb_settings:{background:"transparent url($f1) no-repeat scroll 0 -203px",width:"24px",height:"24px"},tb_un:{background:"transparent url($f1) no-repeat scroll 0 -227px",width:"24px",height:"24px"},"big-icon":{background:"transparent url($f1) no-repeat scroll 0 -251px",width:"20px",height:"21px"},big_logo:{background:"transparent url($f1) no-repeat scroll 0 -272px",width:"301px",height:"111px"},disable:{background:"transparent url($f1) no-repeat scroll 0 -383px",width:"95px",height:"17px"},lock:{background:"transparent url($f1) no-repeat scroll 0 -400px",width:"16px",height:"16px"},"menu-bottom":{background:"transparent url($f1) no-repeat scroll 0 -416px",width:"143px",height:"22px"},"notice-back":{background:"transparent url($f1) no-repeat scroll 0 -438px",width:"277px",height:"78px"},pi_bottom:{background:"transparent url($f2) repeat-x scroll 0 -2px",width:"100%",height:"53px"},pi_bottom_left:{background:"transparent url($f1) no-repeat scroll 0 -516px",width:"34px",height:"53px"},pi_bottom_right:{background:"transparent url($f1) no-repeat scroll 0 -569px",width:"33px",height:"53px"},pi_center_left:{background:"transparent url($f3) repeat-y scroll -339px 0",height:"100%",width:"34px"},pi_center_right:{background:"transparent url($f3) repeat-y scroll -373px 0",height:"100%",width:"33px"},pi_top:{background:"transparent url($f2) repeat-x scroll 0 -55px",width:"100%",height:"49px"},pi_top_left:{background:"transparent url($f1) no-repeat scroll 0 -622px",width:"34px",height:"49px"},pi_top_right:{background:"transparent url($f1) no-repeat scroll 0 -671px",width:"33px",height:"49px"},pu_bottom:{background:"transparent url($f2) repeat-x scroll 0 -104px",width:"100%",height:"53px"},pu_bottom_left:{background:"transparent url($f1) no-repeat scroll 0 -720px",width:"34px",height:"53px"},pu_bottom_right:{background:"transparent url($f1) no-repeat scroll 0 -773px",width:"33px",height:"53px"},pu_center_left:{background:"transparent url($f3) repeat-y scroll -406px 0",height:"100%",width:"34px"},pu_center_right:{background:"transparent url($f3) repeat-y scroll -440px 0",height:"100%",width:"33px"},pu_top:{background:"transparent url($f2) repeat-x scroll 0 -157px",width:"100%",height:"49px"},pu_top_left:{background:"transparent url($f1) no-repeat scroll 0 -826px",width:"34px",height:"49px"},pu_top_right:{background:"transparent url($f1) no-repeat scroll 0 -875px",width:"33px",height:"49px"},"small-icon":{background:"transparent url($f1) no-repeat scroll 0 -924px",width:"18px",height:"12px"},unlock:{background:"transparent url($f1) no-repeat scroll 0 -936px",width:"16px",height:"16px"},"up-narrow":{background:"transparent url($f1) no-repeat scroll 0 -952px",width:"13px",height:"15px"},win_resize:{background:"transparent url($f1) no-repeat scroll 0 -967px",width:"16px",height:"16px"}};var a={color_black:{skin:"#4c4c4c",link:"#1259c7"},color_blue:{skin:"#4c68bb",link:"#4c68bb"},color_graphite:{skin:"#4c5f6f",link:"#4c5f6f"},color_green:{skin:"#54894c",link:"#54894c"},color_brown:{skin:"#614d4c",link:"#614d4c"},color_emeraldgreen:{skin:"#4ca1ae",link:"#4ca1ae"},color_purple:{skin:"#ae4c95",link:"#ae4c95"},color_purple2:{skin:"#766495",link:"#766495"}};PopIn.Resource.getSkin=function(g){try{return a[g].skin}catch(h){}};PopIn.Resource.data={};for(var b=0;b<c.length;b++){PopIn.Resource.data[c[b][0]]={en:c[b][1],ja:c[b][2]}}PopIn.Resource.resources={};for(var b=0;b<e.length;b++){PopIn.Resource.resources[e[b][0]]={en:e[b][1].replace("$l","en"),ja:e[b][1].replace("$l","ja")}}PopIn.Resource.css=PopIn.$F.clone(d)})();if(typeof document.documentElement.style.maxHeight!="undefined"){}else{PopIn.Resource.files=["imagesIE6.gif","images-xIE6.gif","images-yIE6.gif"]}PopIn.Resource.getMessage=function(b){try{return PopIn.Resource.data[b][PopIn.Resource.language]}catch(a){PopIn.Log.error("Message Not Found ["+b+"]["+PopIn.Resource.language+"]")}};PopIn.Resource.getResource=function(b){try{return PopIn.Resource.resources[b][PopIn.Resource.language]}catch(a){PopIn.Log.error("Resource Not Found ["+b+"]["+PopIn.Resource.language+"]")}};PopIn.Resource.getStyle=function(k){try{var b=PopIn.Resource.files;var f=PopIn.Config.getParameter("skinColor");if(typeof f!="undefined"){b=[f+"/images.png",f+"/images-x.png",f+"/images-y.png"]}var j=PopIn.Resource.css[k];var d={};for(var g=0;g<b.length;g++){d["$f"+(g+1)]=PopIn.Resource.base.replace("$l",PopIn.Resource.language)+b[g]}var l=PopIn.$F.clone(j);for(var c in l){for(var a in d){l[c]=l[c].replace(a,d[a])}}return l}catch(h){PopIn.Log.error("Style Not Found ["+k+"]["+PopIn.Resource.language+"]");return{}}};PopIn.RainbowResource={language:PopIn.$F.getLang()};(function(){var b=[["rainbowHelp","popIn Help","popIn ヘルプ"],["numberOfSearches","Number of searches:","注目回数:"],["siteSearch","Site Search","サイト内検索"],["previewShortcut","Press A for preview","Aキーを押して、プレビュー"]];PopIn.RainbowResource.data={};for(var a=0;a<b.length;a++){PopIn.RainbowResource.data[b[a][0]]={en:b[a][1],ja:b[a][2]}}})();PopIn.RainbowResource.getMessage=function(b){try{return PopIn.RainbowResource.data[b][PopIn.RainbowResource.language]}catch(a){PopIn.Log.error("Message Not Found ["+b+"]["+PopIn.RainbowResource.language+"]")}};PopIn.EventManager=function(){};PopIn.EventManager.prototype=new PopIn.BaseObject();PopIn.EventManager.prototype.initialize=function(){this.listeners=new Object();this.mouse=new Object();this.keyword=new Object();PopIn.$(this.document.documentElement).bind("mousedown",this.buildListener(this.onMouseUpDown));PopIn.$(this.document.documentElement).bind("mouseup",this.buildListener(this.onMouseUpDown));PopIn.$(this.document.documentElement).bind("keypress",this.buildListener(this.onKeyPress));PopIn.$(this.window).bind("scroll",this.buildListener(this.onScroll));PopIn.$(this.document.documentElement).bind("click",this.buildListener(this.onClick));PopIn.$(this.document.documentElement).bind("keyup",this.buildListener(this.onKeyUp))};PopIn.EventManager.prototype.buildListener=function(a){return PopIn.Utils.bind(function(){if(this.getPopIn().state.isActive()){a.apply(this,arguments)}},this)};PopIn.EventManager.prototype.acceptEvent=function(b){b=b||window.event;var c=b.target||b.srcElement;var a;if(b.type=="keypress"){return true}else{if(b.type.indexOf("mouse")>=0){if(c.tagName=="INPUT"||c.tagName=="SELECT"||c.tagName=="TEXTAREA"){return false}if(c.ownerDocument.designMode=="on"){return false}a=c;while(a!=null){if(a.id!=undefined&&a.id.indexOf("popIn")>=0){return false}a=a.parentNode}return true}else{if(b.type.indexOf("click")>=0){a=c;while(a!=null){if(a.id!=undefined&&a.id.indexOf("popIn")>=0){return false}a=a.parentNode}return true}else{if(b.type=="keyup"){return true}else{if(b.type=="scroll"){return this.getPopIn().currentInput&&!this.getPopIn().currentInput.isReferrerInput;return true}}}}}return false};PopIn.EventManager.prototype.addEventListener=function(a,b){if(!this.listeners[a]){this.listeners[a]=new Array()}this.listeners[a].push(b)};PopIn.EventManager.prototype.onKeyPress=function(a){a=a||window.event;if(this.acceptEvent(a)){this.keyword.key=PopIn.Utils.getKey(a);this.fireEvent("showUserInput",a);this.fireEvent("closeActiveWindow",a)}};PopIn.EventManager.prototype.onScroll=function(a){a=a||window.event;if(this.acceptEvent(a)){this.fireEvent("hideUserInput",a)}};PopIn.EventManager.prototype.onClick=function(a){a=a||window.event;if(this.acceptEvent(a)){this.fireEvent("closeActiveWindow",a)}};PopIn.EventManager.prototype.onKeyUp=function(a){a=a||window.event;if(this.acceptEvent(a)){this.fireEvent("showUserInput",a);this.fireEvent("closeActiveWindow",a)}};PopIn.EventManager.prototype.onMouseUpDown=function(c){this.mouse=PopIn.Utils.getMousePosition(c);this[c.type]=this.mouse;c=c||window.event;if(this.acceptEvent(c)){var a=this;var b=a.hasSelection();if(c.type=="mousedown"){setTimeout(function(){a.fireEvent("hideLogo",c)},1)}else{if(b){setTimeout(function(){a.fireEvent("textSelected",c)},1)}}}};PopIn.EventManager.prototype.hasSelection=function(){return(PopIn.$F.trim(PopIn.Utils.getSelectionText())!="")};PopIn.EventManager.prototype.fireEvent=function(a,d,b){if(b){b.unshift(d)}else{b=[d]}if(this.listeners[a]){for(var c=0;c<this.listeners[a].length;c++){this.listeners[a][c].apply(this.listeners[a][c],b)}}};PopIn.Menu=function(){};PopIn.Menu.prototype=new PopIn.BaseObject();PopIn.Menu.prototype.initialize=function(a){this.options=a||this.getDefaults();this.services=this.options.services||this.getDefaultServices();this.div=this.createContainer();this.menu=this.createMenu();this.fillContainer()};PopIn.Menu.prototype.getDefaults=function(){return{}};PopIn.Menu.prototype.getDefaultServices=function(){var d=PopIn.Config.getEnabledServices();var a=PopIn.Config.getServiceGroups();var i=[];var h=[];for(var e=0;e<a.length;e++){var f=a[e];if(f.services&&f.services.length>0){for(var b=0;b<f.services.length;b++){i[f.services[b]]=true}h.push(new PopIn.ServiceGroup(f))}}for(var c=0;c<d.length;c++){if(!i[d[c].serviceId]){h.push(new PopIn.Service(d[c]))}}if(PopIn.Config.isPopinEnabler()==false){h.push(new PopIn.Service(PopIn.Config.buildSettingService()))}h.sort(function(j,l){var k=j.data.displayOrder;var g=l.data.displayOrder;return(k>g)?1:-1});return h};PopIn.Menu.prototype.fillContainer=function(){};PopIn.Menu.prototype.createContainer=function(){var a=this.document.body.appendChild(PopIn.Utils.createElement("div"));a.id="popInMenu"+Math.random();PopIn.$(a).css({position:"absolute","background-color":"transparent",background:"none",top:this.options.center.top+(typeof this.options.center.height!="undefined"?this.options.center.height+3:0)+"px",left:this.options.center.left-12+"px","z-index":PopIn.Utils.zIndexLogo});return a};PopIn.Menu.prototype.createMenu=function(){var d=PopIn.Utils.createElement("div");var a=d.appendChild(PopIn.Utils.createElement("table")).appendChild(PopIn.Utils.createElement("tbody"));PopIn.$(a.parentNode).css({background:"transparent",width:PopIn.Resource.getStyle("menu-top").width});var c=new Array();this.tds=c;c.push(a.appendChild(PopIn.Utils.createElement("tr")).appendChild(PopIn.Utils.createElement("td")));c.push(a.appendChild(PopIn.Utils.createElement("tr")).appendChild(PopIn.Utils.createElement("td")));c.push(a.appendChild(PopIn.Utils.createElement("tr")).appendChild(PopIn.Utils.createElement("td")));PopIn.$(c[0]).css(PopIn.Resource.getStyle("menu-top")).css({"line-height":"1px"}).html("");PopIn.$(c[1]).css(PopIn.Resource.getStyle("menu-middle"));PopIn.$(c[2]).css(PopIn.Resource.getStyle("menu-bottom"));this.innerDiv=c[1].appendChild(PopIn.Utils.createElement("div"));PopIn.$(this.innerDiv).css({position:"relative",width:PopIn.$F.isIE?"":"inherit"});for(var b=0;b<this.services.length;b++){this.innerDiv.appendChild(this.createMenuElementFor(this.services[b],b));if(b<this.services.length-1){this.innerDiv.appendChild(this.createMenuSeparator())}}this.highlight(-1);this.addDisableButton();return d};PopIn.Menu.prototype.addDisableButton=function(){var c=PopIn.Utils.createElement("div");var a=this;PopIn.$(c).css({"text-align":"center","margin-left":"14px","margin-right":"14px",height:"19px","line-height":"19px",color:"black",position:"relative","font-family":"Arial",cursor:"pointer","background-color":"#e4e4e4"}).bind("click",function(){var d=new PopIn.Service(PopIn.Config.buildExcludeListSettingService());d.onClick();a.destroy()});var b=c.appendChild(PopIn.Utils.createElement("div"));PopIn.$(b).text(PopIn.Resource.getMessage("disableButton")).css(PopIn.Resource.getStyle("disable")).css({position:"relative",top:"3px",left:PopIn.$F.isIE?0:"10px","text-align":"center","line-height":"16px","font-size":"11px","vertical-align":"middle"});this.innerDiv.appendChild(c)};PopIn.Menu.prototype.createMenuSeparator=function(){var a=PopIn.Utils.createElement("div");a.innerHTML="&nbsp;";PopIn.$(a).css(PopIn.Resource.getStyle("input-hr")).css({"font-size":"1px",width:"",margin:"0px 15px 0px 14px"});return a};PopIn.Menu.prototype.createMenuElementFor=function(b,c){var e=b.createDiv();var d=c;var a=this;PopIn.$(e).bind("mouseenter",function(){a.highlight(d)});PopIn.$(e).bind("mouseleave",function(){a.highlight(-1)});return e};PopIn.Menu.prototype.highlight=function(a){this.highlightIndex=a;for(var b=0;b<this.services.length;b++){if(b==a){this.services[b].highlight()}else{this.services[b].mask()}}};PopIn.Menu.prototype.destroy=function(){PopIn.$(this.div).remove()};PopIn.Menu.prototype.showFirstService=function(){if(this.services.length>0){this.services[0].onClick()}};PopIn.LightMenu=function(){};PopIn.LightMenu.prototype=new PopIn.Menu();PopIn.LightMenu.prototype.fillContainer=function(){this.div.appendChild(this.menu);PopIn.$(this.innerDiv).getChildren().slice(0).hide();PopIn.$(this.innerDiv).css({overflow:"hidden"});var a=this;PopIn.$(this.div).bind("mouseenter",function(){PopIn.$(a.innerDiv).css({overflow:"hidden"});PopIn.$(a.innerDiv).css({height:"19px"});PopIn.$(a.innerDiv).getChildren().show();PopIn.$(a.innerDiv).animate({height:(21*a.services.length+17)+"px"},"fast")});PopIn.$(this.div).bind("mouseleave",function(){PopIn.$(a.innerDiv).animate({height:"19px"},"fast")});PopIn.$F.isIE?PopIn.$(this.div).show():PopIn.$(this.div).fadeIn()};PopIn.logoClass="LightMenu";PopIn.Service=function(a){this.initialize(a)};PopIn.Service.prototype.initialize=function(a){this.id=Number(a.serviceId);if(this.id==NaN){alert("[PopIn.Service] loading INVALID service(id:"+a.serviceId+").")}this.data=a;this.data.inputModes.pushMode=this.data.inputModes.selectMode};PopIn.Service.prototype.isCustomizable=function(){return PopIn.Utils.getPopIn().mode=="shortcutMode"&&this.data.optionName||PopIn.Utils.getPopIn().mode=="selectMode"};PopIn.Service.prototype.hasRelatedServices=function(){return this.group?this.group.hasRelatedServices():false};PopIn.Service.prototype.getRelatedServices=function(){if(this.group){var b=this.group.getRelatedServices();for(var a=0;a<b.length;a++){if(b[a].data.serviceId==this.data.serviceId){}}return b}else{return false}};PopIn.Service.prototype.createDiv=function(){var a=PopIn.Utils.createElement("div");a.id="popInService"+this.data.serviceId;a.style.cursor="pointer";a.innerHTML=this.data.serviceName;this.div=a;PopIn.$(a).css({"text-align":"left","margin-left":"14px","padding-left":"15px","margin-right":"15px",height:"19px","line-height":"19px",color:"#FFFFFF","font-size":"13px","font-family":"Arial","vertical-align":"middle"});PopIn.$(a).bind("click",PopIn.Utils.bind(this.onClick,this));this.div=a;return a};PopIn.Service.prototype.highlight=function(){PopIn.$(this.div).css({color:"black","background-color":"#BABABA"})};PopIn.Service.prototype.mask=function(){PopIn.$(this.div).css({background:"","background-color":"",color:"white"})};PopIn.Service.prototype.onClick=function(){PopIn.Utils.getPopIn().showService(this)};PopIn.Service.prototype.getWidth=function(){if(typeof this.data.inputModes[PopIn.Utils.getPopIn().mode]=="undefined"){this.data.inputModes[PopIn.Utils.getPopIn().mode].width=this.data.inputModes.selectMode.width}return this.data.inputModes[PopIn.Utils.getPopIn().mode].width};PopIn.Service.prototype.getHeight=function(){if(this.data.inputModes[PopIn.Utils.getPopIn().mode]==undefined){this.data.inputModes[PopIn.Utils.getPopIn().mode].height=this.data.inputModes.selectMode.height}var a=this.data.inputModes[PopIn.Utils.getPopIn().mode].height;return a};PopIn.Service.prototype.isPopin=function(){return this.data.inputModes.selectMode.isPopin};PopIn.Service.prototype.getOffsetY=function(){if(this.data.inputModes[PopIn.Utils.getPopIn().mode].offsetY){return this.data.inputModes[PopIn.Utils.getPopIn().mode].offsetY}else{return 0}};PopIn.Service.prototype.createElement=function(){if(this.data.serviceElement){return this.data.serviceElement}var c=PopIn.Utils.createElement("iframe");c.frameBorder=0;c.className="popInScroll";if(this.hasStartingPosition()){var d=this.getStartingPosition();PopIn.$(c).bind("load",function(){c.contentWindow.scrollTo(d.x,d.y)})}PopIn.$(c).css({background:"#f6f6f6",width:"100%",height:"100%","float":"left"}).attr({id:"popInFrame"+(new Date().getTime()),width:"100%",height:"100%"});var b="";if(false){var b="http://popin.cc/common/preview_frames.html?url="}var a=b+this.data.serviceUrl;if(String(this.data.hasPara)=="false"){c.src=a}else{if(this.data.optionData!=""&&this.data.optionData!=undefined){c.src=a+encodeURI(PopIn.Utils.getPopIn().text)+"&optionData="+encodeURI(this.data.optionData)}else{a=PopIn.Utils.diyURL(a);c.src=a}}return c};PopIn.Service.prototype.isNewService=function(){return(this.data.isNew==true||this.data.isNew=="true")};PopIn.Service.prototype.isDIY=function(){return(this.data.isDIY==true||this.data.isDIY=="true")};PopIn.Service.prototype.add=function(){this.data.isNew=false;this.data.enabled=true;PopIn.Config.save()};PopIn.Service.prototype.hasStartingPosition=function(){return(this.data.startX&&this.data.startY)};PopIn.Service.prototype.getStartingPosition=function(){return{x:this.data.startX,y:this.data.startY}};PopIn.ServiceGroup=function(a){this.initialize(a)};PopIn.ServiceGroup.prototype.initialize=function(b){this.data=b;if(!b.displayOrder){b.displayOrder=0}var a=this.data.services[0];this.mainService=new PopIn.Service(PopIn.Config.getServiceById(a));this.mainService.group=this};PopIn.ServiceGroup.prototype.getName=function(){return this.data.name};PopIn.ServiceGroup.prototype.createDiv=function(){var a=this.mainService.createDiv();a.innerHTML=this.data.name;return a};PopIn.ServiceGroup.prototype.onClick=function(){this.mainService.onClick()};PopIn.ServiceGroup.prototype.mask=function(){return this.mainService.mask()};PopIn.ServiceGroup.prototype.highlight=function(){return this.mainService.highlight()};PopIn.ServiceGroup.prototype.hasRelatedServices=function(){return true};PopIn.ServiceGroup.prototype.getRelatedServices=function(){var d=[];for(var c=0;c<this.data.services.length;c++){var a=PopIn.Config.getServiceById(this.data.services[c]);var b=new PopIn.Service(a);b.group=this;d.push(b)}return d};PopIn.ServiceGroup.prototype.isNewService=function(){return false};PopIn.ServiceGroup.prototype.isCustomizable=function(){return false};PopIn.Window=function(){};PopIn.Window.prototype=new PopIn.BaseObject();PopIn.Window.prototype.STATUS_NORMAL=0;PopIn.Window.prototype.STATUS_CLOSED=1;PopIn.Window.prototype.STATUS_LOCKED=2;PopIn.Window.prototype.STATUS_PREVIEW=3;PopIn.Window.prototype.initialize=function(){PopIn.Log.debug(this);this.status=this.STATUS_NORMAL;this.div=this.createContainer();this._settingWindow=null};PopIn.Window.prototype.show=function(){this.text=this.getPopIn().text;this.fillContainer()};PopIn.Window.prototype.glayOut=function(){if(PopIn.Utils.getDocument().getElementById("__grayLayer")){return}var a=PopIn.Utils.createElement("div");a.id="__grayLayer";a.title=PopIn.Resource.getMessage("closeWindow");PopIn.$(a).css({"z-index":PopIn.Utils.zIndexWindow-10,"background-color":"black",opacity:"0.5",position:"fixed",width:"100%",height:"100%",top:"0px",left:"0px"});PopIn.Utils.getDocument().body.appendChild(a)};PopIn.Window.prototype.setService=function(a){this.service=a;this.randomID=this.service.getRelatedServices().length>0?Math.random():0;if(this.service.data.serviceId>=20000&&this.service.data.serviceId<30000){if(this.getPopIn().previewWindow&&this.getPopIn().previewWindow!=this){this.getPopIn().previewWindow.close();this.getPopIn().previewWindow=null}this.getPopIn().previewWindow=this;this.status=this.STATUS_PREVIEW;var b=this.getPopIn().windowManager.getWindowByStatus(this.STATUS_NORMAL);if(b){PopIn.$(b.div).css({"z-index":PopIn.Utils.zIndexWindow-11})}this.glayOut()}PopIn.$(this.div.firstChild).css({width:this.service.getWidth(),height:this.service.getHeight()});if(PopIn.$F.isIE&&PopIn.$F.boxModel){PopIn.$(this.div.firstChild).css({height:this.service.getHeight()-56+"px"})}};PopIn.Window.prototype.getWindowWidth=function(){return this.div.firstChild.offsetWidth};PopIn.Window.prototype.getWindowHeight=function(){return this.div.firstChild.offsetHeight};PopIn.Window.prototype.createContainer=function(){var b=PopIn.Utils.createElement("div");var g=b.appendChild(PopIn.Utils.createElement("table"));var d=g.appendChild(PopIn.Utils.createElement("tbody"));this.parts=[];for(var e=0;e<4;e++){var h=d.appendChild(PopIn.Utils.createElement("tr"));if(e==1){PopIn.$(h).css({display:"none"})}this.parts.push([]);for(var c=0;c<3;c++){this.parts[e].push(h.appendChild(PopIn.Utils.createElement("td")))}}for(var e=0;e<4;e++){for(var c=0;c<3;c++){if(c!=1||e<1||e>2){this.parts[e][c].appendChild(PopIn.Utils.createElement("div"));this.parts[e][c].firstChild.appendChild(PopIn.Utils.createElement("div"))}}}this.resizeHandler=PopIn.Utils.createElement("div");var f=PopIn.Utils.createElement("div");PopIn.$(this.resizeHandler).css(PopIn.Resource.getStyle("win_resize")).css({position:"absolute",top:"5px",right:"0px",cursor:"se-resize",margin:"0px","z-index":10}).bind("mousedown",{window:this},function(i,j){j.window.resize(i);return false});this.parts[3][1].firstChild.firstChild.appendChild(this.resizeHandler);this.parts[3][1].firstChild.firstChild.appendChild(f);var a=PopIn.Utils.createElement("div");this.parts[2][1].appendChild(a);this.containers=[this.parts[0][1].firstChild.firstChild,this.parts[1][1],a,f];PopIn.$(b).css({"z-index":PopIn.Utils.zIndexWindow,margin:"0px",padding:"0px"});PopIn.$(g).css({background:"transparent","border-collapse":"collapse",padding:"0px",margin:"0px",cellpadding:0,"border-spacing":0,position:"absolute"});PopIn.$(d).css({background:"transparent"});b.id="popIn"+Math.random();this.table=g;this.dragElement=this.containers[0];PopIn.$(this.dragElement).css({cursor:"move"});return b};PopIn.Window.prototype.createOptionHandler=function(){if(this.service.getWidth()<400){return}var type=this.service.data.optionsType;var data=this.service.data.optionsData;var name=this.service.data.optionsName;var _self=this;this.optionHandler=PopIn.Utils.createElement("div");var container=PopIn.Utils.createElement("div");var optionsTextDiv=PopIn.Utils.createElement("div");var header=PopIn.Utils.createElement("div");PopIn.$(header).css({height:"59px",width:"255px",background:"transparent url(http://static.popin.cc/common_images/popin_here_images.png) no-repeat scroll 0 -174px"});this.optionHandler.appendChild(header);this.optionHandler.appendChild(container);optionsTextDiv.innerHTML=name;PopIn.$(optionsTextDiv).css({"margin-left":"14px","font-size":"14px","font-family":"Arial,sans-serif","font-weight":"bold",color:"#0088cc"});PopIn.$(this.optionHandler).css({position:"fixed",top:"-100px",right:"-100px",width:"255px",margin:"80px",color:"#444444","font-weight":"bold","font-family":"Arial,sans-serif",color:"#0088cc","font-size":"14px","z-index":PopIn.Utils.zIndexWindow-1});PopIn.$(container).css({padding:"0 40px",background:"transparent url(http://static.popin.cc/common_images/popin_here_images-y.png) repeat-y scroll 0px 0"});container.appendChild(optionsTextDiv);eval("var optionsData ="+unescape(data)+";");if(type=="image"){}if(optionsData.length>1){for(var i=0;i<optionsData.length;i++){var tempDiv=PopIn.Utils.createElement("div");if(type=="iframe"){tempDiv.innerHTML=optionsData[i].title.replace(/<[^>]+>/g,"")}else{if(type=="image"){tempDiv.innerHTML="<img src='"+optionsData[i].tbUrl+"' width='80px' height='80px' />";PopIn.$(tempDiv).css({width:"80px",height:"80px"})}}PopIn.$(tempDiv).css({color:"#0088cc","font-size":"12px"});tempDiv.id="popIn_"+Math.random();PopIn.$(tempDiv).bind("click",{elementData:optionsData[i],name:name,type:type,data:data},function(event,data){function replaceContents(previewWindow,pushService){previewWindow.service=pushService;PopIn.$(previewWindow.containers[2]).empty().append(previewWindow._build_service());setTimeout(function(){PopIn.$(previewWindow.div.firstChild).css({width:previewWindow.service.getWidth(),height:previewWindow.service.getHeight()})},0)}var elementData=data.elementData;elementData.type=data.type;elementData.optionsName=data.name;elementData.optionsData=data.data;var pushService=_self.getPopIn().createPushService({data:elementData,getAttribute:function(name){if(name=="src"){name="url"}return this.data[name]||this.data[name]}});replaceContents(_self,pushService)}).css({cursor:"pointer",padding:"3px","text-align":"left",border:"1px solid #d9d9d9","margin-top":"-1px"}).bind("mouseover",function(){PopIn.$(this).css({color:"gray"})}).bind("mouseout",function(){PopIn.$(this).css({color:"#0088cc"})});container.appendChild(tempDiv)}}var footer=document.createElement("div");PopIn.$(footer).css({width:"255px",height:"50px",background:"transparent url(http://static.popin.cc/common_images/popin_here_images.png) no-repeat scroll 0 -124px"});this.optionHandler.appendChild(footer);var _self=this;var windowWrapper={status:_self.STATUS_NORMAL,div:_self.optionHandler,close:function(){this.status=_self.STATUS_CLOSED},status:_self.STATUS_PREVIEW};this.getPopIn().windowManager.windows.push(windowWrapper);this.getPopIn().windowManager._addAppear(windowWrapper);document.body.appendChild(this.optionHandler)};PopIn.Window.prototype.fixWindow=function(){if(this.options.type=="popUp"){var b=PopIn.$(this.div);var a=b.position();a.top-=PopIn.Utils.pageScrollTop();b.css({position:"fixed",top:a.top+"px"})}this.status=this.STATUS_LOCKED};PopIn.Window.prototype.floatWindow=function(){if(this.options.type=="popUp"){var b=PopIn.$(this.div);var a=b.position();a.top+=PopIn.Utils.pageScrollTop();b.css({position:"absolute",top:a.top+"px"})}this.status=this.STATUS_NORMAL};PopIn.Window.prototype.scroll=function(c,b){var a=PopIn.$("iframe",this.div).get(0).contentWindow;a.scroll(c,b)};PopIn.Window.prototype.close=function(){var b=this;if(b.status==b.STATUS_CLOSED){return}var c=PopIn.Utils.getDocument().getElementById("__grayLayer");if(c){c.parentNode.removeChild(c)}if(this.optionHandler&&this.optionHandler.parentNode){this.optionHandler.parentNode.removeChild(this.optionHandler)}if(PopIn.$F.isIE){var a=PopIn.Utils.getDocument().body.createTextRange();a.moveToElementText(b.serviceNameDiv);a.select()}var d=b.div;while(d&&d.parentNode&&d.parentNode.id.indexOf("popIn")>=0){d=d.parentNode}if(b.options.type=="popIn"){PopIn.$("iframe",b.div).remove();PopIn.$(b.div.parentNode).slideUp("medium",function(){PopIn.$(d).remove()})}else{var d=b.div;PopIn.$(d).remove()}b.status=b.STATUS_CLOSED};PopIn.Window.prototype._build_header=function(){var j=this;var g=PopIn.Utils.createElement("div");var k=PopIn.$(this.div);var d=PopIn.Utils.createElement("div"),p=PopIn.Utils.createElement("div");PopIn.$(d).css({position:"absolute",left:PopIn.$F.isIE?"0px":"-5px",bottom:"2px",width:"350px",height:PopIn.Resource.getStyle("tb_close")["height"],padding:"2px 0 0 0",margin:"0px",border:"0","float":"left","text-align":"left"});PopIn.$(g).append(d);PopIn.$(p).css({display:"inline",margin:"0px",padding:"0px",border:"0","float":"left"});function e(t,s,r){PopIn.$(t).css({margin:"0px",padding:0,border:"none","float":"left","vertical-align":"top",cursor:(r!=false)?"pointer":"auto"}).css(PopIn.Resource.getStyle(s));var u=(s!="tb_close"&&s!="tb_mintb")?p:d;PopIn.$(u).append(t).css({"float":"none"});PopIn.$(t).bind("mousedown",function(v){if(!PopIn.$F.isIE){v.stopPropagation()}else{v.cancelBubble=true}})}var q=PopIn.Utils.createElement("input");q.type="button";q.setAttribute("title",PopIn.Resource.getMessage("close"));PopIn.$(q).bind("click",function(){j.close()});e(q,"tb_close");PopIn.$(d).append(p);this.MinFlag=false;if(this.service.data.isSearch!="false"&&this.service.data.isSearch!=false){this.MinFlag=true;var i=PopIn.Utils.createElement("input");i.type="button";e(i,"tb_search_logo",false);var a=PopIn.$F.trim(this.getPopIn().text);var o=PopIn.Utils.createElement("textarea");this.searchBox=o;o.value=a;o.wrap="off";o.name=o.id="searchBox";e(o,"tb_search",false);var m=PopIn.$(o);m.css({color:"#bebebe","font-size":"14px",border:"none",padding:"0px","line-height":"24px","font-family":"Arial,'ＭＳ Ｐゴシック',sans-serif",overflow:"hidden"});m.bind("keydown",function(t){if(t.keyCode==13){j.text=j.getPopIn().text=m.attr("value");var s=PopIn.$("iframe",k).get(0);var r=PopIn.Utils.diyURL(j.service.data.serviceUrl);PopIn.$(s).attr("src",r);if(!PopIn.$F.isIE){t.preventDefault()}else{t.returnValue=false}}})}if(this.service.data.inputModes.selectMode.isResizable=="true"&&this.getPopIn().mode!="pushMode"){this.MinFlag=true;var f=PopIn.Utils.createElement("input");f.type="button";f.setAttribute("title",PopIn.Resource.getMessage("max"));PopIn.$(f).bind("click",function(){j.maximize()});e(f,"tb_un")}if(this.service.data.serviceOriUrl!=""&&this.service.data.serviceOriUrl!=undefined&&this.service.data.serviceOriUrl!="undefined"){this.MinFlag=true;var c=PopIn.Utils.createElement("input");c.type="button";c.setAttribute("title",PopIn.Resource.getMessage("openTab"));e(c,"tb_newtab");var j=this;if(this.getPopIn().mode!="pushMode"&&this.service.data.hasPara){PopIn.$(c).bind("click",{window:j},function(t){var s=j.service.data.serviceOriUrl;if(String(j.service.data.isDIY)=="true"&&j.service.data.serviceUrl.indexOf("diy_charset")>-1){var r=j.service.data.serviceUrl.substring(s.lastIndexOf("=")+1,j.service.data.serviceUrl.length).toLowerCase();s=PopIn.Resource.getResource("diyHelper")+"?url="+j.service.data.serviceOriUrl+"&diy_charset="+r}if(String(j.service.data.hasPara)=="true"){s=PopIn.Utils.diyURL(s)}else{s=decodeURIComponent(s)}j.close();PopIn.Utils.openNewTab(s)})}else{var n;setTimeout(function(){var r=PopIn.$("iframe",k);n=r.attr("src")},1000);PopIn.$(c).bind("click",{oriUrl:n},function(r){j.close();PopIn.Utils.openNewTab(n)})}}else{if(this.getPopIn().mode=="pushMode"&&this.service.data.serviceId=="20001"){this.MinFlag=true;var c=PopIn.Utils.createElement("input");c.type="button";c.setAttribute("title",PopIn.Resource.getMessage("openTab"));e(c,"tb_newtab");var j=this;PopIn.$(c).bind("click",function(r){j.close();PopIn.Utils.openNewTab(j.service.data.serviceUrl)})}}if(PopIn.SettingWindow&&this.service.isCustomizable()){this.MinFlag=true;var b=PopIn.Utils.createElement("input");b.type="button";b.setAttribute("title",PopIn.Resource.getMessage("setting"));e(b,"tb_settings");PopIn.$(b).bind("click",PopIn.Utils.bind(this.onClickSettingWindowBtn,this))}if(this.MinFlag){var l=PopIn.Utils.createElement("input");l.type="button";e(l,"tb_mintb")}if(PopIn.Config.getParameter("toolbar")=="min"){var h=true;PopIn.$(p).hide()}else{var h=false}if(l){PopIn.$(l).css(PopIn.Resource.getStyle(h?"tb_maxtb":"tb_mintb"));l.setAttribute("title",h?PopIn.Resource.getMessage("tb_maxtb"):PopIn.Resource.getMessage("tb_mintb"));PopIn.$(l).bind("click",function(){h=!h;PopIn.$(p).toggle();PopIn.Config.setParameter("toolbar",h?"min":"max");PopIn.$(this).css(PopIn.Resource.getStyle(h?"tb_maxtb":"tb_mintb"));l.setAttribute("title",h?PopIn.Resource.getMessage("tb_maxtb"):PopIn.Resource.getMessage("tb_mintb"))})}this.headerDiv=g;return g};PopIn.Window.prototype._refreshLock=function(){var a=this.status==this.STATUS_LOCKED?"lock":"unlock";PopIn.$(this.lockButton).css(PopIn.Resource.getStyle(a)).attr({alt:PopIn.Resource.getMessage(a+"Mes"),title:PopIn.Resource.getMessage(a+"Mes")})};PopIn.Window.prototype._build_service=function(){var a=this.service.createElement();return a};PopIn.Window.prototype._build_notice=function(){var a=PopIn.Utils.createElement("div");PopIn.$(a).css({border:"0px none",background:"#f6f6f6",margin:"0",padding:"0","min-height":"0"});this.noticesDiv=a;return a};PopIn.Window.prototype._build_footer=function(){this.footer=PopIn.Utils.createElement("div");PopIn.$(this.footer).css({position:"absolute",top:"0px","text-align":"center",left:"0px",width:"100%"});var a=PopIn.Utils.createElement("div");this.serviceNameDiv=a;PopIn.$(a).css({"text-align":"center",color:"#444444","font-size":"14px","line-height":"20px",width:"100%"});this.footer.appendChild(a);var b=PopIn.Utils.createElement("div");this.relatedServicesContainer=b;PopIn.$(this.relatedServicesContainer).css({background:"transparent",position:"absolute",right:"30px",top:"4px","text-align":"right",height:"16px"});this.footer.appendChild(b);this._fillRelatedServices();return this.footer};PopIn.Window.prototype._fillRelatedServices=function(){PopIn.$(this.relatedServicesContainer).empty();this.serviceNameDiv.innerHTML=this.service.data.serviceName;var f=this.service.getRelatedServices();if(!f&&this.status!=this.STATUS_PREVIEW&&this.service.data.serviceId!=2&&String(this.service.data.isDIY)!="true"){f=[];var e=PopIn.Config.getServices();for(var d=0;d<e.length;d++){if(e[d].serviceId!=20005&&e[d].serviceId!=2&&String(e[d].isDIY)!="true"){f.push(new PopIn.Service(e[d]))}if(f.length==5){break}}}for(var d=0;d<f.length;d++){var c=f[d];var b=this.service.data.serviceId==f[d].data.serviceId?1:0.5;var g=PopIn.Utils.createElement("img");PopIn.$(g).attr({src:c.data.serviceIcon,title:c.data.serviceName,width:"16",height:"16"}).css({"margin-left":"5px",opacity:b,cursor:"pointer",border:"0 none"});var a=this;PopIn.$(g).error(function(h){h.target.src="http://www.popin.cc/favicon.ico"});this.relatedServicesContainer.appendChild(g);a=this;PopIn.$(g).bind("click",{serviceUrl:c.serviceUrl,relatedService:c},function(h,i){PopIn.$(a.serviceNameDiv).html(i.relatedService.data.serviceName);a.getPopIn().text=a.text;a.changeService(i.relatedService);return false})}};PopIn.Window.prototype.changeService=function(a){a.data.inputModes.selectMode.width=this.service.getWidth();a.data.inputModes.selectMode.height=this.service.getHeight();this.text=this.getPopIn().text;this.setService(a);_self=this;setTimeout(function(){_self.fillContainer()},10);PopIn.$(this.div).append(PopIn.Log.requestToImage({serviceid:this.service.data.serviceId,input:decodeURIComponent(this.text),url:this.document.location,title:this.document.title,group:this.randomID}))};PopIn.Window.prototype.fillContainer=function(){var b=["_build_header","_build_notice","_build_service","_build_footer"];for(var a=0;a<this.containers.length;a++){PopIn.$(this.containers[a]).empty().append(this[b[a]].apply(this))}if(this.status==3&&typeof this.service.data.optionsData!="undefined"&&this.service.data.optionsData!=null){}};PopIn.Window.prototype._frameStyles=function(f){var b=["11px","100%","11px"];var e=["33px","20px","100%","23px"];for(var d=0;d<4;d++){for(var c=0;c<3;c++){PopIn.$(this.parts[d][c]).css({width:b[c],height:e[d]})}}b=["11px","100%","11px"];for(var d=0;d<4;d++){for(var c=0;c<3;c++){if(this.parts[d][c].firstChild){PopIn.$(this.parts[d][c].firstChild).css({position:"relative",width:b[c],height:e[d]})}}}var a=["-23px","0px","0px"];var h=["-16px","0px","0px","0px"];for(var d=0;d<4;d++){for(var c=0;c<3;c++){if(c!=1||d<1||d>2){var k=(c==0?"_left":c==1?"":"_right");var g=(d==0?"top":d==3?"bottom":"center");PopIn.$(this.parts[d][c].firstChild.firstChild).css(PopIn.Resource.getStyle(f+"_"+g+k));PopIn.$(this.parts[d][c].firstChild.firstChild).css({position:"absolute",top:h[d],left:a[c]})}}}PopIn.$(this.parts[2][1]).attr({height:"100%"}).css({"background-color":"#f6f6f6"})};PopIn.Window.prototype.log=function(){PopIn.$(this.div).append(PopIn.Log.requestToImage({serviceid:this.service.data.serviceId,input:this.getPopIn().text,url:this.document.location,title:this.document.title,parentnode:this.options.serializedParent,group:this.randomID}))};PopIn.Window.prototype.getService=function(){return this.service};PopIn.Window.prototype.onClickSettingWindowBtn=function(){if(this._settingWindow!=null){this._settingWindow.destroy()}this._settingWindow=new PopIn.SettingWindow(this)};PopIn.Window.prototype.maximize=function(){throw"Not implemented"};PopIn.Window.prototype.minimize=function(){throw"Not Implemented"};PopIn.Window.prototype.resize=function(a){throw"Not Implemented"};PopIn.WindowManager=function(){};PopIn.WindowManager.prototype=new PopIn.BaseObject();PopIn.WindowManager.prototype.initialize=function(){this.windows=[]};PopIn.WindowManager.prototype.injectWindow=function(b,a){b.options=a;var c=this._findContainer(b);this._insertWindowInto(c,b);b.show();this._addDrag(b);this._addResize(b);this._addMaximize(b);this._addMouseOut(b);this._addAppear(b);this._addSkin(b,a.type=="popUp"?"pu":"pi");b.log();this.windows.push(b)};PopIn.WindowManager.prototype.createWindow=function(b,d){var c=this.createObject("Window");c.setService(b);d.mode=this.getPopIn().mode;this.injectWindow(c,d);var a=this;PopIn.$F.aspectAfter(c,"close",function(){if(c.status!=c.STATUS_CLOSED){return}var f=-1;for(var e=0;e<a.windows.length;e++){if(a.windows[e]==c){f=e;break}}if(f<0){return}a.windows.splice(f,1)})};PopIn.WindowManager.prototype.getWindowByStatus=function(a){for(var b=this.windows.length-1;b>=0;b--){if(this.windows[b].status==a){return this.windows[b]}}};PopIn.WindowManager.prototype._addResize=function(a){var c=a.options.type=="popIn"?[a.div.parentNode,a.table]:[a.table];var b=PopIn.$F.resizable({elements:c,handler:a.resizeHandler,minWidth:400,minHeight:250,restrictedMin:PopIn.$F.isIE&&PopIn.$.boxModel?true:false,start:function(d){PopIn.$("iframe",a.div).css("visibility","hidden")},end:function(d){PopIn.$("iframe",a.div).css("visibility","visible");PopIn.Config.resetServiceSize(a.service,a.getWindowWidth(),a.getWindowHeight(),a.options.mode)}});a.resize=function(d){b.ready(d)}};PopIn.WindowManager.prototype._findContainer=function(c){var a;var b=c.options;if(b.type=="popIn"){if(b.parent=="auto"){a=this._getParentNodeFromSelection(c)}else{if(b.parentNode){a=b.parentNode;c.options.serializedParent=PopIn.Utils.serialize(a)}else{if(b.pushNode){a=this._getParentNodeFromPushNode(c,b.pushNode)}}}if(a.offsetWidth<c.service.getWidth()){PopIn.$(a).remove();c.options.type="popUp"}else{PopIn.$(a).css({width:"1px"})}}if(b.type=="popUp"){a=PopIn.Utils.getDocument().body;c.options.serializedParent=PopIn.Utils.serialize(a);if(b.parent=="auto"){c.posHelper=this._getParentNodeFromSelection(c)}}return a};PopIn.WindowManager.prototype._wrapDummie=function(a,c){var b=PopIn.Utils.createElement("div");b.id="popInD"+Math.random();PopIn.$(b).css({"font-size":"12px",display:"none",width:a.service.getWidth()+"px",height:a.service.getHeight()+"px"});if(PopIn.$F.isIE){PopIn.$(b).css({width:"1px"})}b.innerHTML="";if(this.getPopIn().mode=="selectMode"&&a.service.isPopin()||this.getPopIn().mode=="pushMode"){PopIn.$(b).css({position:"relative"}).slideDown("slow")}else{PopIn.$(b).css({position:"absolute",display:"block"})}b.appendChild(c);return b};PopIn.WindowManager.prototype._getParentNodeFromPushNode=function(b,c){var a=PopIn.Utils.getDocument().createDocumentFragment();var d=PopIn.Utils.createElement("div");d.id="popIn"+Math.random();a.appendChild(d);c.parentNode.appendChild(a);return d};PopIn.WindowManager.prototype._getParentNodeFromSelection=function(c){var b=PopIn.Utils.getDocument().createDocumentFragment();var e=PopIn.Utils.createElement("div");e.id="popIn"+Math.random();PopIn.$(e).css({});b.appendChild(e);if(window.getSelection){var a=this.getPopIn().range.endContainer;var f=this.getPopIn().range.endOffset;switch(a.nodeType){case 1:a.insertBefore(b,a.childNodes[f]);break;case 3:var d=a.splitText(f);if(a.parentNode.tagName=="A"){c.options.serializedParent=PopIn.Utils.serialize(d.parentNode.parentNode);d.parentNode.parentNode.appendChild(b)}else{c.options.serializedParent=PopIn.Utils.serialize(d.parentNode);if(d.parentNode.offsetHeight>450){d.parentNode.insertBefore(b,d)}else{d.parentNode.appendChild(b)}}break}}else{if(PopIn.Utils.selectionType!="Control"){if(this.getPopIn().range.parentElement().offsetHeight>450){this.getPopIn().range.pasteHTML(this.getPopIn().range.htmlText+'<span id="IE'+c.div.id+'"></span>');document.getElementById("IE"+c.div.id).appendChild(e);c.options.serializedParent=PopIn.Utils.serialize(this.getPopIn().range.parentElement())}else{if(this.getPopIn().range.parentElement().tagName=="A"){this.getPopIn().range.parentElement().parentNode.appendChild(e);c.options.serializedParent=PopIn.Utils.serialize(this.getPopIn().range.parentElement().parentNode)}else{this.getPopIn().range.parentElement().appendChild(e);c.options.serializedParent=PopIn.Utils.serialize(this.getPopIn().range.parentElement())}}}}return e};PopIn.WindowManager.prototype.resetPosition=function(a){if(a.status==a.STATUS_LOCKED){PopIn.$(a.div).animate({top:PopIn.$F.isIE?(PopIn.Utils.pageScrollTop()+10)+"px":"10px",left:(PopIn.Utils.getViewportWidth()-a.getWindowWidth()-0)+"px"})}};PopIn.WindowManager.prototype._insertWindowInto=function(a,d){var h=d.div;var c=d.options;if(c.type=="popUp"){if(c.fixed){PopIn.$(h).css({position:PopIn.$F.isIE?"absolute":"fixed",top:PopIn.$F.isIE?(PopIn.Utils.pageScrollTop()+10)+"px":"10px",left:PopIn.Utils.getViewportWidth()-d.service.getWidth()-0});d.status=d.STATUS_LOCKED}else{if(c.parent=="auto"){var g=PopIn.Utils.findSelectionPosition();PopIn.$(h).css({position:"absolute",top:g.top+"px",left:g.left+"px"});PopIn.$(d.posHelper).remove();PopIn.$(h).css("display","block")}else{var b=this.getWindowByStatus(PopIn.Window.prototype.STATUS_LOCKED);if(typeof b!="undefined"&&b.options.type=="popUp"){this.resetPosition(b);var f=PopIn.Utils.getViewportWidth(this.window)-b.getWindowWidth()-10;var e=Math.max(0,f-d.service.getWidth());PopIn.$(h).css({position:"absolute",top:(PopIn.Utils.pageScrollTop()+10)+"px",left:e});PopIn.$(b.div).css({"z-index":PopIn.Utils.zIndexWindow-1})}else{if((PopIn.Utils.getViewportWidth()-d.service.getWidth())>=0&&PopIn.Utils.getViewportHeight()-d.service.getHeight()>=0){PopIn.$(h).css({position:"absolute",top:PopIn.Utils.pageScrollTop()+(PopIn.Utils.getViewportHeight()-d.service.getHeight())/2+"px",left:(PopIn.Utils.getViewportWidth()-d.service.getWidth())/2-20+"px"})}else{PopIn.$(h).css({position:"absolute",top:(PopIn.Utils.pageScrollTop()+10)+"px",left:"0px"})}}PopIn.$(h).css("display","block")}}}else{if(c.type=="popIn"){h=this._wrapDummie(d,h);setTimeout(function(){var k=PopIn.$F.position(h).top;var i=d.getService().getHeight();var l=PopIn.Utils.getWindowHeight();var j=PopIn.Utils.pageScrollTop();if(k+i>l+j){PopIn.Utils.getWindow().scrollTo(0,k+i-l)}},500)}}a.appendChild(h)};PopIn.WindowManager.prototype._addSkin=function(a,b){a._frameStyles(b)};PopIn.WindowManager.prototype._addMaximize=function(a){a.maximize=function(){if(PopIn.$("textarea",a.div).get(0)){PopIn.$("textarea",a.div).get(0).focus()}a.close();var d=PopIn.Config.buildPreviewService(a.service.data.serviceName);this.getPopIn().mode="pushMode";var c="";if(String(a.service.data.isDIY)=="true"&&a.service.data.serviceUrl.indexOf("diy_charset")>-1){var b=a.service.data.serviceUrl.substring(c.lastIndexOf("=")+1,a.service.data.serviceUrl.length).toLowerCase();c=PopIn.Resource.getResource("diyHelper")+"?url="+a.service.data.serviceOriUrl+"&diy_charset="+b}if(String(a.service.data.hasPara)=="true"){c=PopIn.Utils.diyURL(a.service.data.serviceOriUrl)}else{c=decodeURIComponent(a.service.data.serviceOriUrl)}d.serviceUrl=c;new PopIn.Service(d).onClick()}};PopIn.WindowManager.prototype._addDrag=function(b){var a=this;var c=b.div.parentNode.parentNode;var d=PopIn.$F.draggable({elements:[b.div],handler:b.dragElement,start:function(e){PopIn.$("iframe",b.div).css("visibility","hidden");if(!PopIn.$F.isIE){PopIn.$(b.table).css({opacity:0.35})}if(b.options.type=="popIn"){PopIn.$(a.document.body).append(b.div);PopIn.$(b.div).css("position","absolute")}},end:function(e){PopIn.$("iframe",b.div).css("visibility","visible");if(!PopIn.$F.isIE){PopIn.$(b.table).css("opacity",1)}if(b.options.type=="popIn"){PopIn.$(c).slideUp(150);b.options.type="popUp";a._addSkin(b,"pu");if(b.status==b.STATUS_LOCKED){b.fixWindow()}}}})};PopIn.WindowManager.prototype._addMouseOut=function(b){var a=PopIn.$(b.div);a.bind("mouseleave",function(c){if(b.status==b.STATUS_LOCKED){a.css({"z-index":PopIn.Utils.zIndexWindow-1})}});a.bind("mouseenter",function(c){if(b.status==b.STATUS_LOCKED){a.css({"z-index":PopIn.Utils.zIndexWindow+1})}})};PopIn.WindowManager.prototype._addAppear=function(c){var b=PopIn.$(c.div);var a=this;b.bind("mouseover",function(){var d;for(d=0;d<a.windows.length;d++){if(a.windows[d].status!=3){continue}PopIn.$(a.windows[d].div).css({"z-index":PopIn.Utils.zIndexWindow-1})}b.css({"z-index":PopIn.Utils.zIndexWindow})})};PopIn.Config=function(){};PopIn.Config.notices=[];PopIn.Config.reset=function(){var a=navigator.userAgent;var b;if(a.indexOf("IE")>-1){b=navigator.userLanguage}else{b=a}if(b.indexOf("ja")>-1){b="ja"}else{b="en"}PopIn.Config.config=PopIn.$F.clone(PopIn.DummieData[b]["popInConfig"]);PopIn.Config.setLanguage(b);PopIn.Config.save()};PopIn.Config.load=function(){var a=PopIn.Config._load();if(a&&a!=""){PopIn.Config.config=a.popInConfig;PopIn.Resource.language=PopIn.Config.config.lang;if(!PopIn.Config.getParameter("skinColor")){PopIn.Config.setParameter("skinColor","color_black")}}else{PopIn.Config.reset()}};PopIn.Config._load=function(){throw"Config._load not implemented"};PopIn.Config.addService=function(a){var b=PopIn.Config.getServiceById(a.serviceId);if(a.serviceIcon==""||!a.serviceIcon){this.setServiceIcon(a)}if(!b){PopIn.Config.getServices().push(a)}else{if(b.enabled==false||b.enabled=="false"){b.enabled=true}}};PopIn.Config.setLanguage=function(a){PopIn.Config.config.lang=a;PopIn.Resource.language=a;PopIn.Config.save()};PopIn.Config.setServiceIcon=function(a){var b=decodeURIComponent(a.serviceOriUrl);var c=b.substring(0,b.indexOf("/",8));a.serviceIcon=c+"/favicon.ico"};PopIn.Config.editServiceGroup=function(d){if(d.services){for(var b=0;b<d.services.length;b++){var c=d.services[b];if(!PopIn.Config.getServiceById(c)){d.services.splice(b,1)}}}var a=PopIn.Config.getServiceGroups();for(var b=0;b<a.length;b++){if(a[b].id==d.id){if(d.name){a[b].name=d.name}if(d.services){a[b].services=d.services}}}PopIn.Config.save()};PopIn.Config.getServiceGroups=function(){if(!PopIn.Config.config.groups){PopIn.Config.config.groups=[]}else{}return PopIn.Config.config.groups};PopIn.Config.addServiceGroup=function(c){if(!c.id){c.id=new Date().getTime()}if(c.services){for(var a=0;a<c.services.length;a++){var b=c.services[a];if(!PopIn.Config.getServiceById(b)){c.services.splice(a,1)}}}PopIn.Config.getServiceGroups().push(c);PopIn.Config.save()};PopIn.Config.removeServiceGroup=function(c){var a=PopIn.Config.getServiceGroups();for(var b=0;b<a.length;b++){if(""+a[b].id==""+c){a.splice(b,1);PopIn.Config.save();return}}};PopIn.Config.getNotices=function(){return PopIn.Config.notices};PopIn.Config.addNotice=function(a){PopIn.Config.notices.push(a)};PopIn.Config.clearNotices=function(){PopIn.Config.notices=[]};PopIn.Config.getEnabledServices=function(){var b=PopIn.Config.getServices();var c=[];for(var a=0;a<b.length;a++){if(b[a].enabled){c.push(b[a])}}return c};PopIn.Config.disableService=function(a){PopIn.Config.getService(a).enabled=false};PopIn.Config.removeService=function(e){var d=PopIn.Config.getServices();for(var c=0;c<d.length;c++){if(d[c].serviceId==e){d.splice(c,1);break}}var a=PopIn.Config.getServiceGroups();for(var c=0;c<a.length;c++){if(a[c].services){for(var b=0;b<a[c].services.length;b++){if(a[c].services[b]==e){a[c].services.splice(b,1)}}}}};PopIn.Config.getServiceById=function(d){var c=this.getServices();for(var b in c){var a=c[b];if(a.serviceId==d){return a}}return false};PopIn.Config.getServiceGroupById=function(d){var c=this.getServiceGroups();for(var b in c){var a=c[b];if(a.id==d){return a}}return false};PopIn.Config.getRelatedService=function(a){var c=new Array();var d=a.split(",");for(var b=0;b<d.length;b++){c.push(PopIn.Config.getServiceById(d[b]))}return c};PopIn.Config.buildPreviewService=function(d,c){c=c||{};var a="";if(this.config.previewMode>3){a="logoOnmouseover"}else{a="logoClick"}var b=this.getParameter("previewDelay");var e={serviceId:20001,serviceName:d,hasPara:"false",isSearch:"false",resizable:"true",displayOrder:99999,launchConfig:{type:a,delay:b},inputModes:{selectMode:{type:"popInWin",width:c.width||PopIn.Utils.getWindowWidth()*0.85,height:c.height||PopIn.Utils.getWindowHeight()*0.85,isDraggable:false,isResizable:"true",isPopin:true},pushMode:{type:"popUp",width:c.width||PopIn.Utils.getWindowWidth()*0.85,height:c.height||PopIn.Utils.getWindowHeight()*0.85}}};return e};PopIn.Config.buildSettingService=function(a){var b={serviceId:20002,serviceName:PopIn.Resource.getMessage("settingFeedback"),hasPara:"false",isSearch:"false",resizable:"true",displayOrder:999999,inputModes:{selectMode:{type:"popInWin",width:PopIn.Utils.getWindowWidth()*0.85,height:PopIn.Utils.getWindowHeight()*0.85,isDraggable:false,isResizable:"false",isPopin:true},pushMode:{type:"popUp",width:PopIn.Utils.getWindowWidth()*0.85,height:PopIn.Utils.getWindowHeight()*0.85}}};a=a?"&op_name="+a:"";b.serviceUrl=PopIn.Resource.getResource("setting")+"?popid="+PopIn.Config.getGuid()+"&url="+encodeURIComponent(PopIn.Utils.getWindow().location.href)+a;return b};PopIn.Config.buildExcludeListSettingService=function(a){var b={serviceId:20007,serviceName:PopIn.Resource.getMessage("settingFeedback"),hasPara:"false",isSearch:"false",resizable:"true",displayOrder:999999,inputModes:{selectMode:{type:"popInWin",width:600,height:430,isDraggable:false,isResizable:"false",isPopin:true},pushMode:{type:"popUp",width:600,height:430}}};a=a?"&op_name="+a:"";b.serviceUrl=PopIn.Resource.getResource("excludeListSetting")+"?popid="+PopIn.Config.getGuid()+"&url="+encodeURIComponent(PopIn.Utils.getWindow().location.href)+a+"&connectionID="+PopIn.Utils.getPopIn().connectionID;return b};PopIn.Config.getNoPopinPages=function(){if(!PopIn.Config.config.excludeList){PopIn.Config.config.excludeList=[]}return PopIn.Config.config.excludeList};PopIn.Config.isPopinEnabler=function(){return PopIn.Config.config.isPopinEnabler==true};PopIn.Config.getServiceByUrl=function(b){b=b.substring(0,b.indexOf("?q=")+3);var d=this.getServices();for(var c in d){var a=d[c];if(a.serviceUrl==b){return a}}};PopIn.Config.update=function(){if(!PopIn.Config.config.version){if(!PopIn.Config.config.version){PopIn.Config.config.version=0}}};PopIn.Config.getNewDiyServiceID=function(){var c=10000;var b=this.getServices();for(var a=0;a<b.length;a++){if(String(b[a].isDIY)=="true"&&String(b[a].serviceId).indexOf("4")!=0){c=c>Number(b[a].serviceId)?c:Number(b[a].serviceId)}}c++;return c};PopIn.Config.getServices=function(){return PopIn.Config.config.service};PopIn.Config.useHotKey=function(){return PopIn.Config.config.hotKey};PopIn.Config.usePreviewMode=function(){return PopIn.Config.config.previewMode};PopIn.Config.getCustomizePageUrl=function(){return PopIn.Config.config.customizePage};PopIn.Config.getHelpPageUrl=function(){return PopIn.Config.config.helpPage};PopIn.Config.resetServiceSize=function(a,d,e,g){PopIn.Log.debug(g);if(typeof g=="undefined"){return}if(a.data.inputModes[g]){a.data.inputModes[g].width=d;a.data.inputModes[g].height=e}else{a.data.inputModes[g].width=a.data.inputModes.selectMode.width;a.data.inputModes[g].height=a.data.inputModes.selectMode.height}var f=a.getRelatedServices();if(f.length>0){for(var c=0;c<f.length;c++){var b=f[c];b.data.inputModes[PopIn.Utils.getPopIn().mode].width=d;b.data.inputModes[PopIn.Utils.getPopIn().mode].height=e}}PopIn.Config.save()};PopIn.Config.getExcludeList=function(){if(!PopIn.Config.config.excludeList){PopIn.Config.config.excludeList=[]}return PopIn.Config.config.excludeList};PopIn.Config.editExcludeList=function(a){PopIn.Config.config.excludeList=a;PopIn.Config.save()};PopIn.Config.save=function(){throw"Method not implemented(PopIn.Config.save)"};PopIn.Config.getParameter=function(a){return PopIn.Config.config[a]};PopIn.Config.setParameter=function(b,a){PopIn.Config.config[b]=a};PopIn.Config._load=function(){return popInConfigData};PopIn.Config.save=function(){};PopIn.Config.getGuid=function(){return PopIn.Config.config.userID};PopIn.InlineText=function(){};PopIn.InlineText.prototype=new PopIn.BaseObject();PopIn.InlineText.prototype.initialize=function(b){this.prepareTimeOut();this.load=this.createLoadImage();this.log=this.createLog(b);PopIn.Utils.insertToSelectNode([this.load,this.log]);var a=this;this.getTranslationLanguage(function(c){a.translateFrom(c)})};PopIn.InlineText.prototype.getTranslationLanguage=function(a){PopIn.Utils.ajax({dataType:"jsonp",url:"http://ajax.googleapis.com/ajax/services/language/detect?v=1.0&q="+encodeURI(this.getPopIn().text),success:function(b){a(b.responseData.language)}})};PopIn.InlineText.prototype.translateFrom=function(b){if(b=="ja"){this.url="http://ajax.googleapis.com/ajax/services/language/translate?v=1.0&q="+encodeURI(this.getPopIn().text)+"&langpair=ja%7Cen"}else{this.url="http://ajax.googleapis.com/ajax/services/language/translate?v=1.0&q="+encodeURI(this.getPopIn().text)+"&langpair=en%7Cja"}var a=this;PopIn.Utils.ajax({dataType:"jsonp",url:this.url,error:function(){PopIn.Utils.insertTextToSelectNode(PopIn.Resource.getMessage("translationError"))},success:function(c){PopIn.$(a.load).remove();PopIn.$(a.log).remove();clearTimeout(a.timeID);var d=(c.responseData.translatedText).replace(/&#39;/g,"'");d=(c.responseData.translatedText).replace(/&quot;/g,'"');PopIn.Utils.insertTextToSelectNode(d)}})};PopIn.InlineText.prototype.prepareTimeOut=function(){var a=this;this.timeID=setTimeout(function(){PopIn.$(a.load).remove();PopIn.$(a.log).remove();PopIn.Utils.insertTextToSelectNode(PopIn.Resource.getMessage("translationError"))},10000)};PopIn.InlineText.prototype.createLoadImage=function(){var a=PopIn.Utils.createElement("img");a.src=PopIn.Resource.getResource("loadImg");PopIn.$(a).css({width:"18px",height:"18px",border:"0px",margin:"0px",padding:"0px"});return a};PopIn.InlineText.prototype.createLog=function(a){return PopIn.Log.requestToImage({serviceid:a.data.serviceId,input:this.getPopIn().text,url:this.document.location,title:this.document.title,parentnode:null})};PopIn.Utils={};PopIn.Utils.zIndexLogo=1002;PopIn.Utils.zIndexServiceList=1001;PopIn.Utils.zIndexWindow=1000;PopIn.Utils.getPopIn=function(){return popIn};PopIn.Utils.bind=function(c,b){var a=c,b=arguments[arguments.length-1];return function(){return a.apply(b,arguments)}};PopIn.Utils.serialize=function(c){if(c.tagName&&c.tagName=="BODY"){return 0}try{var g=c.innerHTML;g=g?g:c.tagName+c.parentNode.tagName}catch(f){return 0}var a=g.length;var d=0;for(var b=0;b<a;b+=a/10){d+=(g.charCodeAt(b)*b+a)*(g.charCodeAt(b)+b)}return a+"-"+parseInt(d).toString(16)};PopIn.Utils.searchNode=function(a){var b=PopIn.Utils._rsearchNode(a,PopIn.Utils.getDocument().body);return b};PopIn.Utils._rsearchNode=function(c,d){if(PopIn.Utils.serialize(d)==c){return d}else{for(var b=0;b<d.childNodes.length;b++){var e=d.childNodes[b];var a=PopIn.Utils._rsearchNode(c,e);if(a!=false){return a}}}return false};PopIn.Utils.openNewTab=function(a){window.open(a,"_blank")};PopIn.Utils.State=function(a){this.state=a};PopIn.Utils.State.prototype.isActive=function(){return this.state};PopIn.Utils.State.prototype.set=function(a){this.state=a};PopIn.Utils.getWindow=function(){return window};PopIn.Utils.getDocument=function(){return document};PopIn.Utils.getWindowWidth=function(b){if(!b){b=PopIn.Utils.getWindow()}var a=b.document;return b.innerWidth||a.documentElement.clientWidth||a.body.clientWidth||a.scrollWidth};PopIn.Utils.getWindowHeight=function(b){if(!b){b=PopIn.Utils.getWindow()}var a=b.document;return b.innerHeight||a.documentElement.clientHeight||a.body.clientHeight||a.body.scrollHeight};PopIn.Utils.getDocumentHeight=function(b){if(!b){b=PopIn.Utils.getWindow()}var a=b.document;return Math.max(a.height,PopIn.Utils.getWindowHeight(b))};PopIn.Utils.getParameter=function(b){var a=PopIn.Utils.getDocument().location.search;var e=new Object();if(a&&a.length>2){a=a.slice(1);qs1=a.split("&");for(var d=0;d<qs1.length;d++){var c=qs1[d].split("=");e[c[0]]=decodeURIComponent(c[1])}}return e[b]};PopIn.Utils.createElement=function(b){var a=PopIn.Utils.getDocument().createElement(b);if(b=="input"){return a}PopIn.$(a).css({margin:"0px",padding:"0px",background:"","line-height":1,"-moz-box-sizing":"content-box",position:"static","float":"none"});if(b=="iframe"||b=="td"||b=="tr"||b=="div"||b=="table"){PopIn.$(a).css({border:"0px"})}if(b=="ul"){PopIn.$(a).css({"list-style-type":"none"})}if(b=="td"){PopIn.$(a).css({"vertical-align":"top","border-spacing":0,padding:"0px",margin:"0px",background:"transparent"})}if(b=="tr"){PopIn.$(a).css({"border-spacing":0})}if(b=="table"){PopIn.$(a).css({"border-collapse":"collapse",cellpadding:0,"border-spacing":0})}return a};PopIn.Utils.findSelectionPosition=function(){var b=PopIn.Utils.getDocument().createDocumentFragment();var e=PopIn.Utils.createElement("span");e.id="selectionDami";e.innerHTML="";b.appendChild(e);if(window.getSelection){var a=PopIn.Utils.getPopIn().range.endContainer;var f=PopIn.Utils.getPopIn().range.endOffset;switch(a.nodeType){case 1:a.insertBefore(b,a.childNodes[f]);break;case 3:var d=a.splitText(f);d.parentNode.insertBefore(b,d);break}}else{if(PopIn.Utils.selectionType!="Control"){if(typeof PopIn.Utils.getPopIn().range!="undefined"){PopIn.Utils.getPopIn().range.collapse(false);PopIn.Utils.getPopIn().range.pasteHTML('<span id="selectionDami">&nbsp;</span>');e=PopIn.Utils.getDocument().getElementById("selectionDami")}}}e.innerHTML="&nbsp;";var g=PopIn.$F.join(PopIn.$(e).bodyOffset(),PopIn.$(e).size());var c=e.parentNode;PopIn.$(e).remove();if(!PopIn.$F.isIE){c.normalize()}return g};PopIn.Utils.getSelection=function(){var a=PopIn.Utils.getWindow().getSelection();if(a&&typeof PopIn.Utils.getPopIn()!="undefined"){PopIn.Utils.getPopIn().text=a.toString();return a}};PopIn.Utils.getSelectionText=function(){var a=PopIn.Utils.getSelection();return !a?"":a.toString()};PopIn.Utils.getSelectionRange=function(){var b=PopIn.Utils.getSelection();if(b.getRangeAt&&b.rangeCount>0){return b.getRangeAt(0)}else{var a=document.createRange();if(b.anchorNode&&b.anchorOffset){a.setStart(b.anchorNode,b.anchorOffset)}if(b.focusNode&&b.focusOffset){a.setEnd(b.focusNode,b.focusOffset)}return a}};PopIn.Utils.contains=function(c,b){for(var a=0;a<c.length;a++){if(c[a]==b){return true}}return false};PopIn.Utils.diyURL=function(a){var b=a;if(b.indexOf("diy_charset")>-1){b+="&qstring="+encodeURI(PopIn.Utils.getPopIn().text)}else{b=decodeURIComponent(a);if(b.indexOf("{qstring}")>-1){b=b.replace("{qstring}",encodeURI(PopIn.Utils.getPopIn().text))}else{b=b+encodeURI(PopIn.Utils.getPopIn().text)}}b+=(b.indexOf("?")>=0?"&":"?")+"skinColor="+PopIn.Config.getParameter("skinColor")+"&connectionID="+PopIn.Utils.getPopIn().connectionID;return b};PopIn.Utils.pageScrollTop=function(){return PopIn.Utils.getWindow().pageYOffset};PopIn.Utils.checkExcludeList=function(){var b=PopIn.Utils.getWindow().location.href;var a=PopIn.Config.getNoPopinPages();for(var c=0;c<a.length;c++){var d="^(http://)?"+a[c].replace(/\./g,"\\.").replace(/\*/g,"\\w+");if(b.match(d)||b==a[c]){PopIn.Utils.getPopIn().state.set(false);break}}};PopIn.Utils.showInformation=function(){function b(d){var c=PopIn.Utils.getDocument().createElement("span");c.setAttribute("settings","");c.setAttribute("text",d+" "+PopIn.Resource.getMessage("serviceInformation"));PopIn.ServicesHelper.launchMessage(c)}function a(f){var d=PopIn.Config.getServices();var c=PopIn.Utils.getWindow().location;for(var e=0;e<d.length;e++){if(new PopIn.Utils.URI(d[e].serviceOriUrl).host==c.host){return}}for(var e=0;e<f.length;e++){if(new PopIn.Utils.URI(f[e].serviceOriUrl).host==c.host){b(c.host);return}}}if(PopIn.Utils.showInformation._serviceList){a(PopIn.Utils.showInformation._serviceList)}else{PopIn.$F.getJSON({url:PopIn.Resource.getResource("serviceList"),success:function(c){PopIn.Utils.showInformation._serviceList=c.service;a(PopIn.Utils.showInformation._serviceList)}})}};PopIn.Utils.isShortcutKey=function(a){if(PopIn.Config.useHotKey()==1){return false}else{if(PopIn.Config.useHotKey()==2){}else{return false}}};PopIn.Utils.isArrowUp=function(a){return a.keyCode==38};PopIn.Utils.isArrowDown=function(a){return a.keyCode==40};PopIn.Utils.isEnter=function(a){return a.keyCode==13};PopIn.Utils.isCharacter=function(a){if(a.ctrlKey==true||a.altKey==true||a.metaKey){return false}return a.keyCode==0};PopIn.Utils.isEscape=function(a){return a.keyCode==27};PopIn.Utils.isPreviewKey=function(a){return a.charCode==97};PopIn.Utils.getKey=function(a){return a.charCode};PopIn.Utils.getMousePosition=function(a){return{x:a.pageX,y:a.pageY}};PopIn.Utils.getDocumentWidth=function(){return PopIn.Utils.getDocument().documentElement.clientWidth+PopIn.Utils.getWindow().scrollMaxX||PopIn.Utils.getDocument().body.clientWidth+PopIn.Utils.getWindow().scrollMaxX};PopIn.Utils.getDocumentHeight=function(){return PopIn.Utils.getDocument().body.clientHeight+PopIn.Utils.getWindow().scrollMaxY||PopIn.Utils.getWindow().innerHeight+PopIn.Utils.getWindow().pageYOffset};PopIn.Utils.getViewportWidth=function(a){if(!a){a=PopIn.Utils.getWindow()}return a.document.body.clientWidth};PopIn.Utils.getViewportHeight=function(){return PopIn.Utils.getWindow().innerHeight};PopIn.Utils.insertToSelectNode=function(e){var c=PopIn.Utils.getDocument().createDocumentFragment();var b=(e instanceof Array)?e:[e];for(var d=0;d<b.length;d++){c.appendChild(b[d])}var a=PopIn.Utils.getPopIn().range.endContainer;var g=PopIn.Utils.getPopIn().range.endOffset;switch(a.nodeType){case 1:a.insertBefore(c,a.childNodes[g]);break;case 3:var f=a.splitText(g);f.parentNode.insertBefore(c,f);break}};PopIn.Utils.insertTextToSelectNode=function(c){var e=PopIn.Utils.getDocument().createElement("span");var d=c;var a=PopIn.Utils.getDocument().createTextNode("("+d+")");var b=PopIn.Utils.createElement("img");b.src=PopIn.Resource.getResource("closeBtn");PopIn.$(b).css({width:"14px",height:"14px",border:"0px",margin:"0px",padding:"0px"});PopIn.$(b).css({cursor:"pointer"});PopIn.$(e).append(a).css({color:"#FF0000"});PopIn.$(e).fadeIn("slow");PopIn.$(e).append(b);PopIn.$(b).bind("click",function(){PopIn.$(e).fadeOut("slow",function(){PopIn.$(e).remove()})});PopIn.Utils.insertToSelectNode(e)};PopIn.Utils.ajax=PopIn.$F.ajax;PopIn.Utils.URI=function(b){b=String(b);var c=/^([^:/?#]+:)?\/\/(([^/?#:]*):?(\d*))?([^?#]*)(\?[^#]*)?(#.*)?$/;var a=b.match(c);if(!a){a=[]}this.href=a[0];this.protocol=a[1]||"";this.host=a[2]||"";this.hostname=a[3]||"";this.port=a[4]||"";this.pathname=a[5]||"";this.search=a[6]==="?"?"":a[6]||"";this.hash=a[7]||""};if(PopIn.$F.isIE){PopIn.Utils.isArrowUp=function(a){a=a||window.event;return a.keyCode==38};PopIn.Utils.isArrowDown=function(a){a=a||window.event;return a.keyCode==40};PopIn.Utils.isEnter=function(a){a=a||window.event;return a.keyCode==13};PopIn.Utils.isCharacter=function(a){a=a||window.event;if(a.ctrlKey==true||a.altLeft==true){return false}return a.keyCode>=97&&a.keyCode<=122};PopIn.Utils.isPreviewKey=function(a){return a.keyCode==97};PopIn.Utils.isEscape=function(a){return a.keyCode==27};PopIn.Utils.getKey=function(a){return a.which};PopIn.Utils.getMousePosition=function(a){a=a||window.event;var b=(PopIn.Utils.getDocument().body.scrollTop==0)?PopIn.Utils.getDocument().documentElement:PopIn.Utils.getDocument().body;return{x:a.clientX+b.scrollLeft,y:a.clientY+b.scrollTop}};PopIn.Utils.isShortcutKey=function(a){if(PopIn.Config.useHotKey()==1){return false}else{if(PopIn.Config.useHotKey()==2){return a.ctrlKey==true&&a.keyCode==32}else{return false}}};PopIn.Utils.pageScrollTop=function(){return PopIn.Utils.getDocument().body.scrollTop||PopIn.Utils.getDocument().documentElement.scrollTop};PopIn.Utils.getDocument=function(){return document};PopIn.Utils.openNewTab=function(a){var b=new ActiveXObject("PopIn.PopInButton");b.openNewTab(a)};PopIn.Utils.getDocumentWidth=function(){return PopIn.$(PopIn.Utils.getDocument()).width()};PopIn.Utils.getDocumentHeight=function(){return PopIn.$(PopIn.Utils.getDocument()).height()};PopIn.Utils.getViewportWidth=function(){if(document.documentElement&&document.documentElement.clinetWidth){return PopIn.Utils.getDocument().documentElement.clientWidth}else{return PopIn.Utils.getDocument().body.clientWidth}};PopIn.Utils.getViewportHeight=function(){if(PopIn.Utils.getDocument().documentElement&&PopIn.Utils.getDocument().documentElement.clinetWidth){return PopIn.Utils.getDocument().documentElement.clientHeight}else{if(document.compatMode=="BackCompat"){return PopIn.Utils.getDocument().body.clientHeight}else{return PopIn.Utils.getDocument().documentElement.clientHeight}}};PopIn.Utils.insertToSelectNode=function(c){var e=Math.random();PopIn.Utils.getPopIn().range.pasteHTML(PopIn.Utils.getPopIn().range.htmlText+'<span id="IEpopIn'+e+'"></span>');var d=PopIn.Utils.getDocument().getElementById("IEpopIn"+e);var a=(c instanceof Array)?c:[c];for(var b=0;b<a.length;b++){d.appendChild(a[b])}};PopIn.Utils.insertTextToSelectNode=function(c){var e=PopIn.Utils.createElement("span");var d=c;var a=PopIn.Utils.getDocument().createTextNode("("+d+")");var b=PopIn.Utils.createElement("img");b.src=PopIn.Resource.getResource("closeBtn");PopIn.$(b).css({border:"0px",margin:"0px",padding:"0px"});PopIn.$(b).css({cursor:"pointer"});PopIn.$(e).append(a).css({color:"#FF0000",display:"none"});PopIn.$(e).append(b);PopIn.$(b).bind("click",function(){PopIn.$(e).fadeOut("middle",function(){PopIn.$(e).remove()})});PopIn.$(e).fadeIn("middle");PopIn.Utils.insertToSelectNode(e)};PopIn.Utils.getSelection=function(){try{var a=PopIn.Utils.getDocument().selection;PopIn.Utils.getPopIn().text=a.createRange().text;return a.createRange()}catch(b){}};PopIn.Utils.getSelectionText=function(){var a=PopIn.Utils.getSelection();return a?a.text:""};PopIn.Utils.getSelectionRange=function(){var a=PopIn.Utils.getSelection();if(a.htmlText){this.selectionType=PopIn.Utils.getDocument().selection.type;return a}}}PopIn.Utils.diyURL=function(a){var b=a;if(b.indexOf("diy_charset")>-1){b+="&qstring="+encodeURI(PopIn.Utils.getPopIn().text)}else{if(b.indexOf("{qstring}")>-1){b=b.replace("{qstring}",encodeURI(PopIn.Utils.getPopIn().text))}else{b=b+encodeURI(PopIn.Utils.getPopIn().text)}}b+=(b.indexOf("?")>=0?"&":"?")+"connectionID="+PopIn.Utils.getPopIn().connectionID+"&skinColor="+PopIn.Config.getParameter("skinColor")+"&type=enabler&blogUrl="+PopIn.Config.getParameter("blogUrl");if(b.indexOf("services/amazon")>1){b+="&affiliateId="+PopIn.Config.getParameter("amazonId")}if(b.indexOf("services/rakuten")>1){b+="&affiliateId="+PopIn.Config.getParameter("rakutenId")}return b};PopIn.Utils.openNewTab=function(a){window.open(a,"_blank")};PopIn.Utils.checkExcludeList=function(b){var c=PopIn.Utils.getWindow().location.href;var a=b;for(var d=0;d<a.length;d++){if(a[d]!=""){var e="^(http://)?"+a[d].replace(/\./g,"\\.").replace(/\*/g,"\\w+");if(c.match(e)||c==a[d]){PopIn.Utils.getPopIn().state.set(false);break}}}};PopIn.$F.aspectAround(PopIn.Window.prototype,"_build_footer",function(d){var c=d.apply(this);var b=c.appendChild(PopIn.Utils.createElement("div"));PopIn.$(b).css({top:"2px",left:"0px",position:"absolute",margin:0,padding:0,cursor:"pointer"}).bind("click",function(){var e=new PopIn.Service(PopIn.Config.buildExcludeListSettingService());e.onClick()});var a=b.appendChild(PopIn.Utils.createElement("img"));a.setAttribute("src","http://static.popin.cc/about_rainbow.jpg");PopIn.$(a).css({border:"none",padding:0,margin:0}).bind("mouseover",function(){a.setAttribute("src","http://static.popin.cc/about_rainbow_over.jpg")}).bind("mouseout",function(){a.setAttribute("src","http://static.popin.cc/about_rainbow.jpg")});return c});PopIn.Log={logImage:"http://www.popin.cc/log/blank.gif?"};PopIn.Log.level=0;if(typeof Firebug=="undefined"){PopIn.Log.level=0}PopIn.Log.notice=function(a){if(PopIn.Log.level>=1){Firebug.Console.log(a)}};PopIn.Log.error=function(a){if(PopIn.Log.level>=2){Firebug.Console.log(a)}};PopIn.Log.debug=function(a){if(PopIn.Log.level>=3){Firebug.Console.log(a)}};PopIn.Log.requestToImage=function(c){var a=PopIn.Utils.createElement("img");PopIn.$(a).css({width:"1px",height:"1px",border:"none",position:"absolute"});c.popid=PopIn.Config.getGuid();c.mode=encodeURIComponent(PopIn.Utils.getPopIn().mode);c.lang=function(){try{return(navigator.browserLanguage||navigator.language||navigator.userLanguage).substr(0,2)}catch(f){return undefined}}();var d=[PopIn.Log.logImage];for(var b in c){if(c.hasOwnProperty(b)){d.push(b,"=",encodeURIComponent(c[b]),"&")}}d.pop();a.src=d.join("");return a};PopIn.BlogToolServices={service:[{enabled:true,serviceId:1,serviceVer:1,isDIY:false,hasPara:true,serviceName:"Google 検索",serviceIcon:"http://google.co.jp/favicon.ico",serviceUrl:"http://popin.cc/ja/services/search/search.html?qstring=",serviceOriUrl:"http://www.google.co.jp/search?hl=ja&q={qstring}",displayOrder:1,isSearch:true,optionName:"",optionData:"",addedDay:"",inputModes:{selectMode:{type:"popInWin",width:420,height:350,isDraggable:false,isResizable:"true",isPopin:true},shortcutMode:{screenx:10,screeny:10,width:420,height:350}}},{enabled:false,serviceId:2,serviceVer:1,isDIY:false,hasPara:true,serviceName:"Google 地図",serviceIcon:"http://maps.google.co.jp/favicon.ico",optionName:"出発地点の住所",optionData:"",serviceUrl:"http://popin.cc/ja/services/map/map.html?q=",serviceOriUrl:"http://maps.google.co.jp/maps?hl=ja&q={qstring}",displayOrder:2,isSearch:true,addedDay:"",inputModes:{selectMode:{type:"popInWin",width:700,height:450,offsetY:0,isDraggable:false,isResizable:"true",isPopin:true},shortcutMode:{screenx:10,screeny:10,width:700,height:450,offsetY:0}}},{enabled:true,serviceId:3,serviceVer:1,isDIY:false,hasPara:true,serviceName:"Wikipedia",serviceIcon:"http://ja.wikipedia.org/favicon.ico",serviceUrl:"http://popin.cc/ja/services/wikipedia/index.html?q=",serviceOriUrl:"http://ja.wikipedia.org/wiki/{qstring}",displayOrder:3,isSearch:true,optionName:"",optionData:"",addedDay:"",inputModes:{selectMode:{type:"popInWin",width:420,height:350,isDraggable:false,isResizable:"true",isPopin:true},shortcutMode:{screenx:10,screeny:10,width:420,height:350}}},{enabled:false,serviceId:4,serviceVer:1,serviceName:"Google 翻訳",isDIY:false,hasPara:true,serviceIcon:"http://www.google.co.jp/favicon.ico",serviceUrl:"http://popin.cc/popin/popin_services/translation/translation.html?txt=",displayOrder:4,isSearch:true,optionName:"",optionData:"",addedDay:"",inputModes:{selectMode:{type:"popInWin",width:420,height:350,isDraggable:false,isResizable:"true",isPopin:true},shortcutMode:{screenx:10,screeny:10,width:680,height:380}}},{serviceId:"6",enabled:true,isNew:false,serviceVer:1,serviceName:"YouTube",isSearch:true,serviceIcon:"http://jp.youtube.com/favicon.ico",serviceUrl:"http://www.popin.cc/ja/services/youtube/youtube.html?q=",serviceOriUrl:"http://jp.youtube.com/results?search_query=",displayOrder:6,optionName:"",optionData:"",isDIY:"false",hasPara:"true",inputModes:{selectMode:{type:"popInWin",width:450,height:350,isDraggable:"true",isResizable:"true",isPopin:"true"},shortcutMode:{screenx:10,screeny:10,width:450,height:350}}},{serviceId:"7",isNew:false,serviceVer:1,serviceName:"Amazon",serviceIcon:"http://g-ec2.images-amazon.com/favicon.ico",serviceUrl:"http://popin.cc/ja/services/amazon/index.html?q=",serviceOriUrl:"http://www.amazon.co.jp/s/field-keywords=",displayOrder:7,optionName:"",optionData:"",enabled:true,isDIY:"false",hasPara:"true",isSearch:true,inputModes:{selectMode:{type:"popInWin",width:450,height:350,isDraggable:"true",isResizable:"true",isPopin:"true"},shortcutMode:{screenx:10,screeny:10,width:450,height:350}}},{serviceId:"8",serviceVer:1,serviceName:"難易度判定",serviceIcon:"http://nani.popin.cc/favicon.ico",serviceUrl:"http://nani.popin.cc/rs/rs.cgi?outputType=html&p=",serviceOriUrl:"http://nani.popin.cc/rs/rs.cgi?outputType=html&p=",displayOrder:6,optionName:"",optionData:"",enabled:true,isDIY:"false",hasPara:"true",isSearch:"false",inputModes:{selectMode:{type:"popInWin",width:420,height:350,isDraggable:"true",isResizable:"true",isPopin:"true"},shortcutMode:{screenx:10,screeny:10,width:420,height:350}}},{serviceId:"9",isNew:false,serviceVer:1,serviceName:"価格.com",serviceIcon:"http://kakaku.com/favicon.ico",serviceUrl:"http://popin.cc/ja/services/kakaku/index.html?q=",serviceOriUrl:"http://kakaku.com/search_results/",displayOrder:9,optionName:"",optionData:"",enabled:true,isDIY:"false",hasPara:"true",isSearch:true,inputModes:{selectMode:{type:"popInWin",width:450,height:350,isDraggable:"true",isResizable:"true",isPopin:"true"},shortcutMode:{screenx:10,screeny:10,width:450,height:350}}},{serviceId:"10",isNew:false,serviceVer:1,serviceName:"楽 天",serviceIcon:"http://esearch.rakuten.co.jp/favicon.ico",serviceUrl:"http://popin.cc/ja/services/rakuten/index.html?q=",serviceOriUrl:"http://esearch.rakuten.co.jp/rms/sd/esearch/vc?sv=2&sitem=",displayOrder:10,optionName:"",optionData:"",enabled:true,isDIY:"false",hasPara:"true",isSearch:true,inputModes:{selectMode:{type:"popInWin",width:450,height:350,isDraggable:"true",isResizable:"true",isPopin:"true"},shortcutMode:{screenx:10,screeny:10,width:450,height:350}}},{serviceId:"11",isNew:false,serviceVer:1,serviceName:"ヤフオク",serviceIcon:"http://www.yahoo.com/favicon.ico",serviceUrl:"http://popin.cc/ja/services/yahoo_auction/index.html?q=",serviceOriUrl:"http://search.auctions.yahoo.co.jp/jp/search/auc?p=",displayOrder:11,optionName:"",optionData:"",enabled:true,isDIY:"false",hasPara:"true",isSearch:true,inputModes:{selectMode:{type:"popInWin",width:450,height:350,isDraggable:"true",isResizable:"true",isPopin:"true"},shortcutMode:{screenx:10,screeny:10,width:450,height:350}}},{serviceId:"12",isNew:false,serviceVer:1,serviceName:"Delicious",serviceIcon:"http://delicious.com/favicon.ico",serviceUrl:"http://popin.cc/ja/services/delicious/index.html",serviceOriUrl:"http://delicious.com/save?url=&title=&v=5&noui=1",displayOrder:12,optionName:"",optionData:"",enabled:false,isDIY:"false",hasPara:"false",isSearch:"false",inputModes:{selectMode:{type:"popInWin",width:650,height:500,isDraggable:"true",isResizable:"true",isPopin:"true"},shortcutMode:{screenx:10,screeny:10,width:650,height:500}}},{enabled:false,serviceId:13,serviceVer:1,isDIY:false,hasPara:true,serviceName:"Yahoo 検索",serviceIcon:"http://www.yahoo.com/favicon.ico",serviceUrl:"http://popin.cc/ja/services/yahoo/index.html?q=",serviceOriUrl:"http://search.yahoo.co.jp/search?p={qstring}&search.x=1&fr=top_ga1_sa&tid=top_ga1_sa&ei=UTF-8&aq=&oq=",displayOrder:13,isSearch:true,optionName:"",optionData:"",addedDay:"",inputModes:{selectMode:{type:"popInWin",width:420,height:350,isDraggable:false,isResizable:"true",isPopin:true},shortcutMode:{screenx:10,screeny:10,width:420,height:350}}},{enabled:false,serviceId:14,serviceVer:1,isDIY:false,hasPara:true,serviceName:"Flickr",serviceIcon:"http://www.flickr.com/favicon.ico",serviceUrl:"http://popin.cc/ja/services/flickr/index.html?q=",serviceOriUrl:"http://www.flickr.com/search/?q=",displayOrder:14,isSearch:true,optionName:"",optionData:"",addedDay:"",inputModes:{selectMode:{type:"popInWin",width:420,height:350,isDraggable:false,isResizable:"true",isPopin:true},shortcutMode:{screenx:10,screeny:10,width:420,height:350}}},{enabled:false,serviceId:15,serviceVer:1,isDIY:false,hasPara:true,serviceName:"Google 画像",serviceIcon:"http://www.google.co.jp/favicon.ico",serviceUrl:"http://popin.cc/ja/services/google_image/index.html?qstring=",serviceOriUrl:"http://images.google.co.jp/images?hl=ja&q=",displayOrder:15,isSearch:true,optionName:"",optionData:"",addedDay:"",inputModes:{selectMode:{type:"popInWin",width:420,height:350,isDraggable:false,isResizable:"true",isPopin:true},shortcutMode:{screenx:10,screeny:10,width:420,height:350}}},{enabled:true,serviceId:16,serviceVer:1,isDIY:false,hasPara:true,serviceName:"coneco",serviceIcon:"http://www.coneco.net/favicon.ico",serviceUrl:"http://popin.cc/ja/services/coneco/index.html?q=",serviceOriUrl:"http://www.coneco.net/PriceList.asp?FREE_WORD=",displayOrder:16,isSearch:true,optionName:"",optionData:"",addedDay:"",inputModes:{selectMode:{type:"popInWin",width:450,height:350,isDraggable:false,isResizable:"true",isPopin:true},shortcutMode:{screenx:10,screeny:10,width:450,height:350}}},{enabled:true,serviceId:20004,serviceVer:1,isDIY:false,hasPara:true,serviceName:"popIn AR",serviceIcon:"http://www.coneco.net/favicon.ico",serviceUrl:"http://popin.cc/ja/services/ar/ar.html?ar=",serviceOriUrl:"http://popin.cc/ja/services/ar/ar.html?ar=",displayOrder:20004,isSearch:false,optionName:"",optionData:"",addedDay:"",inputModes:{selectMode:{type:"popInWin",width:650,height:570,isDraggable:false,isResizable:"true",isPopin:true},shortcutMode:{screenx:10,screeny:10,width:650,height:570}}},{enabled:true,serviceId:17,serviceVer:1,isDIY:false,hasPara:true,serviceName:"関連記事",serviceIcon:"http://popin.cc/favicon.ico",serviceUrl:"http://popin.cc/ja/services/keyword/index.html?qstring=",serviceOriUrl:"http://popin.cc/ja/word.html?word=",displayOrder:17,isSearch:true,optionName:"",optionData:"",addedDay:"",inputModes:{selectMode:{type:"popInWin",width:420,height:420,isDraggable:false,isResizable:"true",isPopin:true},shortcutMode:{screenx:10,screeny:10,width:420,height:420}}}],groups:[{enabled:true,id:30001,name:"価格比較",services:[7,9,10,11,16],displayOrder:5}],updateDate:"20090416"};PopIn.ServicesHelper={};PopIn.ServicesHelper.executeCommand=function(c,b){var a={"display-object":PopIn.ServicesHelper.displayObject,"get-service-list":PopIn.ServicesHelper.getServiceList,"get-version":PopIn.ServicesHelper.getVersion,"set-service-order":PopIn.ServicesHelper.setServiceOrder,"add-service":PopIn.ServicesHelper.addService,"remove-service":PopIn.ServicesHelper.removeService,"get-option-data":PopIn.ServicesHelper.getOptionData,"set-hotkey-mode":PopIn.ServicesHelper.setHotkeyMode,"get-hotkey-mode":PopIn.ServicesHelper.getHotkeyMode,"get-homepage-utils":PopIn.ServicesHelper.getHomepageUtils,"get-service-groups":PopIn.ServicesHelper.getServiceGroups,"add-service-group":PopIn.ServicesHelper.addServiceGroup,"edit-service-group":PopIn.ServicesHelper.editServiceGroup,"remove-service-group":PopIn.ServicesHelper.removeServiceGroup,"get-exclude-list":PopIn.ServicesHelper.getExcludeList,"set-exclude-list":PopIn.ServicesHelper.setExcludeList,"diy-object":PopIn.ServicesHelper.diyObject,"set-preview-mode":PopIn.ServicesHelper.setPreviewMode,"get-preview-mode":PopIn.ServicesHelper.getPreviewMode,"get-language":PopIn.ServicesHelper.getLanguage,"set-language":PopIn.ServicesHelper.setLanguage,"launch-settings":PopIn.ServicesHelper.launchSettings,"launch-url":PopIn.ServicesHelper.launchURL,"launch-message":PopIn.ServicesHelper.launchMessage,"launch-service":PopIn.ServicesHelper.launchService,"set-ignore-messages":PopIn.ServicesHelper.setIgnoreMessage,"get-ignore-messages":PopIn.ServicesHelper.getIgnoreMessage,"set-skin-color":PopIn.ServicesHelper.setSkinColor,"get-skin-color":PopIn.ServicesHelper.getSkinColor,reset:PopIn.ServicesHelper.reset,"disable-help":PopIn.ServicesHelper.enableHelp,"enable-help":PopIn.ServicesHelper.disableHelp,"set-preview-delay":PopIn.ServicesHelper.setPreviewDelay,"get-preview-delay":PopIn.ServicesHelper.getPreviewDelay,"set-preview-offsetTop":PopIn.ServicesHelper.setPreviewOffsetTop,"get-preview-offsetTop":PopIn.ServicesHelper.getPreviewOffsetTop,"set-preview-offsetLeft":PopIn.ServicesHelper.setPreviewOffsetLeft,"get-preview-offsetLeft":PopIn.ServicesHelper.getPreviewOffsetLeft,"set-icon-mode":PopIn.ServicesHelper.setIconMode,"get-icon-mode":PopIn.ServicesHelper.getIconMode};if(a[c]){PopIn.Log.debug(b.target);a[c](b.target)}else{b.target.setAttribute("error","COMMAND_NOT_FOUND")}};PopIn.ServicesHelper.handleEvent=function(a){var b="";if(a.type=="displayObject"){b="display-object"}else{if(a.type=="PopInServiceCommand"){b=a.target.getAttribute("command")}}PopIn.ServicesHelper.executeCommand(b,a)};PopIn.ServicesHelper.getVersion=function(a){if(a.nodeName=="SPAN"){return"1.3.2"}else{a.setAttribute("result","1.3.2")}};PopIn.ServicesHelper.getLanguage=function(a){if(a.nodeName=="SPAN"){return PopIn.Config.config.lang}else{a.setAttribute("language",PopIn.Config.config.lang)}};PopIn.ServicesHelper.getIgnoreMessages=function(a){if(a.nodeName=="SPAN"){return PopIn.Config.config.ignoreMessages?PopIn.Config.config.ignoreMessages:"false"}else{a.setAttribute("ignore-messages",PopIn.Config.config.ignoreMessages?PopIn.Config.config.ignoreMessages:"false")}};PopIn.ServicesHelper.setIgnoreMessages=function(a){PopIn.Config.config.ignoreMessages=a.getAttribute("ignore-messages");PopIn.Config.save()};PopIn.ServicesHelper.launchSettings=function(a){PopIn.Utils.getPopIn().gotoCustomizePage()};PopIn.ServicesHelper.launchURL=function(a){PopIn.Utils.openNewTab(a.getAttribute("url"))};PopIn.ServicesHelper.reset=function(){PopIn.Config.reset()};PopIn.ServicesHelper.launchMessage=function(a){if(PopIn.Config.config.ignoreMessages&&PopIn.Config.config.ignoreMessages=="true"){}else{var b=function(){};if(a.getAttribute("settings")){b=function(){PopIn.Utils.getPopIn().gotoCustomizePage()}}else{if(a.getAttribute("url")){b=function(){PopIn.Utils.openNewTab(a.getAttribute("url"))}}}setTimeout(function(){PopIn.Utils.getPopIn().showInformation(a.getAttribute("text"),b)},1000)}};PopIn.ServicesHelper.launchService=function(d){var h=Number(d.getAttribute("serviceId"));var a=PopIn.Config.getServiceById(h);PopIn.Utils.getPopIn().text=decodeURIComponent(d.getAttribute("word"));PopIn.Utils.getPopIn().mode="shortcutMode";var f=PopIn.Utils.getPopIn().windowManager.getWindowByStatus(PopIn.Window.prototype.STATUS_PREVIEW);var g=PopIn.Utils.getPopIn().windowManager.getWindowByStatus(PopIn.Window.prototype.STATUS_NORMAL);if(f){f.close()}else{if(g){g.close()}}var e=function(j){if(d.getAttribute("parentId")){PopIn.Utils.getPopIn().mode="selectMode";var i=d.ownerDocument.getElementById(d.getAttribute("parentId"));PopIn.Utils.getPopIn().windowManager.createWindow(new PopIn.Service(j),{type:"popIn",parentNode:i})}else{PopIn.Utils.getPopIn().windowManager.createWindow(new PopIn.Service(j),{type:"popUp"})}};if(!a||a.inputModes.selectMode.type=="popInInlineText"){var c=PopIn.BlogToolServices.service;for(var b=0;b<c.length;b++){if(c[b].serviceId==h){a=c[b];break}}e(a)}else{e(a)}};PopIn.ServicesHelper.setLanguage=function(a){var b=a.getAttribute("language");PopIn.Config.setLanguage(b)};PopIn.ServicesHelper.displayObject=function(b){PopIn.Utils.getWindow().parent.focus();var a=PopIn.Utils.getPopIn();a.displayObject(b)};PopIn.ServicesHelper.getServiceList=function(d){var c=PopIn.Config.getServices();c.sort(function(j,l){var k=j.displayOrder;var i=l.displayOrder;return(k>i)?1:-1});var a="[";for(var b=0;b<c.length;b++){var g=c[b];if(g.serviceIcon==""||!g.serviceIcon){PopIn.Config.setServiceIcon(g)}var f={id:g.serviceId,name:g.serviceName,isDIY:g.isDIY,icon:g.serviceIcon,order:g.displayOrder};if(g.enabled==true||g.enabled=="true"){var e="";for(var h in f){e+=(e==""?"":", ")+"'"+h+"': '"+f[h]+"'"}a+=(a.length>1?",":"")+"{"+e+"}"}}a+="]";if(d.nodeName=="SPAN"){return a}else{d.setAttribute("result",a)}};PopIn.ServicesHelper.setServiceOrder=function(element){eval("var order="+element.getAttribute("data"));for(var i=0;i<order.length;i++){var id=order[i];var service=PopIn.Config.getServiceById(id);var group=PopIn.Config.getServiceGroupById(id);var element=service?service:group;element.displayOrder=i}PopIn.Config.save()};PopIn.ServicesHelper.removeService=function(a){PopIn.Config.removeService(a.getAttribute("serviceid"));PopIn.Config.save()};PopIn.ServicesHelper.addService=function(a){if(a.getAttribute("data")){var b=JSON.parse(a.getAttribute("data"))}else{var b={serviceId:a.getAttribute("service.id"),serviceVer:a.getAttribute("service.ver"),serviceName:a.getAttribute("service.name"),serviceIcon:a.getAttribute("service.icon"),serviceUrl:a.getAttribute("service.url"),serviceOriUrl:a.getAttribute("service.oriurl"),displayOrder:Number(a.getAttribute("display.order")),optionName:a.getAttribute("option.name"),optionData:a.getAttribute("option.data"),enabled:a.getAttribute("service.enabled"),isDIY:a.getAttribute("isDIY"),hasPara:a.getAttribute("hasPara"),isSearch:a.getAttribute("service.isSearch"),isNew:a.getAttribute("service.isNew"),inputModes:{selectMode:{type:a.getAttribute("selectMode.type"),width:Number(a.getAttribute("selectMode.width")),height:Number(a.getAttribute("selectMode.height")),isDraggable:a.getAttribute("selectMode.isDraggable"),isResizable:a.getAttribute("selectMode.isResizable"),isPopin:a.getAttribute("selectMode.isPopin")},shortcutMode:{screenx:Number(a.getAttribute("shortcutMode.screenx")),screeny:Number(a.getAttribute("shortcutMode.screeny")),width:Number(a.getAttribute("shortcutMode.width")),height:Number(a.getAttribute("shortcutMode.height"))}}}}PopIn.Config.addService(b);PopIn.Config.save()};PopIn.ServicesHelper.getOptionData=function(c){var b=c.ownerDocument.location.href;var a=PopIn.Config.getServiceByUrl(b);if(a!=undefined){if(c.nodeName=="SPAN"){return a.optionData}else{c.setAttribute("result",a.optionData)}}};PopIn.ServicesHelper.displayObjectIE=function(b){data=JSON.parse(b);var a=PopIn.Utils.createElement("popInDisplayObject");for(attribute in data){a.setAttribute(attribute,data[attribute])}PopIn.ServicesHelper.displayObject(a)};PopIn.ServicesHelper.setHotkeyMode=function(a){var b=Number(a.getAttribute("mode"));PopIn.Config.config.hotKey=b;PopIn.Config.save()};PopIn.ServicesHelper.getHotkeyMode=function(a){if(a.nodeName=="SPAN"){return String(PopIn.Config.config.hotKey)}else{a.setAttribute("result",PopIn.Config.config.hotKey)}};PopIn.ServicesHelper.setPreviewMode=function(a){var b=Number(a.getAttribute("mode"));PopIn.Config.config.previewMode=b;PopIn.Config.save()};PopIn.ServicesHelper.getPreviewMode=function(a){if(a.nodeName=="SPAN"){return String(PopIn.Config.config.previewMode)}else{a.setAttribute("result",PopIn.Config.config.previewMode)}};PopIn.ServicesHelper.getHomepageUtils=function(b){PopIn.Utils.getWindow().parent.focus();var a=PopIn.Utils.getPopIn();b.setAttribute("url",a.url);b.setAttribute("title",a.title)};PopIn.ServicesHelper.getServiceGroups=function(d){var k="[";var f=PopIn.Config.getServiceGroups();for(var e=0;e<f.length;e++){var g=f[e];var h="";var c={id:g.id,name:g.name.replace("\n",""),order:g.displayOrder};var a=g.services;for(var b=0;b<a.length;b++){h+=(h.length==0?"":",")+"'"+a[b]+"'"}k+=(k.length>1?",":"")+"{id: "+c.id+",order: "+c.order+", name:'"+c.name+"', services:[ "+h+"]}"}k+="]";if(d.nodeName=="SPAN"){return k}else{d.setAttribute("result",k)}};PopIn.ServicesHelper.addServiceGroup=function(element){var gServices=eval(element.getAttribute("groupservices")||element.getAttribute("group.services"));if(element.getAttribute("groupservices")==null||element.getAttribute("group.services")==null){gServices=[]}var group={id:element.getAttribute("groupid")||element.getAttribute("group.id"),name:element.getAttribute("groupname")||element.getAttribute("group.name"),services:gServices};PopIn.Config.addServiceGroup(group)};PopIn.ServicesHelper.editServiceGroup=function(element){var group={id:element.getAttribute("groupid")||element.getAttribute("group.id"),name:element.getAttribute("groupname")||element.getAttribute("group.name"),services:eval(element.getAttribute("groupservices")||element.getAttribute("group.services"))};PopIn.Config.editServiceGroup(group)};PopIn.ServicesHelper.removeServiceGroup=function(a){var b=a.getAttribute("groupid")||a.getAttribute("group.id");PopIn.Config.removeServiceGroup(b)};PopIn.ServicesHelper.setSkinColor=function(b){var a=b.getAttribute("color");PopIn.Config.setParameter("skinColor",a);PopIn.Config.save()};PopIn.ServicesHelper.getSkinColor=function(a){if(a.nodeName=="SPAN"){return PopIn.Config.getParameter("skinColor")}else{a.setAttribute("result",PopIn.Config.getParameter("skinColor"))}};PopIn.ServicesHelper.enableHelp=function(a){PopIn.Config.setParameter("help.disable","false");PopIn.Config.save()};PopIn.ServicesHelper.disableHelp=function(a){PopIn.Config.setParameter("help.disable","true");PopIn.Config.save()};PopIn.ServicesHelper.setPreviewDelay=function(a){var b=Number(a.getAttribute("time"));PopIn.Config.config.previewDelay=b;PopIn.Config.save()};PopIn.ServicesHelper.getPreviewDelay=function(a){if(a.nodeName=="SPAN"){return String(PopIn.Config.config.previewDelay)}else{a.setAttribute("result",PopIn.Config.config.previewDelay)}};PopIn.ServicesHelper.setPreviewOffsetTop=function(a){var b=Number(a.getAttribute("top"));PopIn.Config.config.previewOffsetTop=b;PopIn.Config.save()};PopIn.ServicesHelper.getPreviewOffsetTop=function(a){if(a.nodeName=="SPAN"){return String(PopIn.Config.config.previewOffsetTop)}else{a.setAttribute("result",PopIn.Config.config.previewOffsetTop)}};PopIn.ServicesHelper.setPreviewOffsetLeft=function(a){var b=Number(a.getAttribute("left"));PopIn.Config.config.previewOffsetLeft=b;PopIn.Config.save()};PopIn.ServicesHelper.getPreviewOffsetLeft=function(a){if(a.nodeName=="SPAN"){return String(PopIn.Config.config.previewOffsetLeft)}else{a.setAttribute("result",PopIn.Config.config.previewOffsetLeft)}};PopIn.ServicesHelper.getExcludeList=function(c){var a="[";var d=PopIn.Config.getExcludeList();for(var b=0;b<d.length;b++){b==d.length-1?a+='"'+d[b]+'"':a+='"'+d[b]+'",'}a+="]";if(c.nodeName=="SPAN"){return a}else{c.setAttribute("result",a)}};PopIn.ServicesHelper.setExcludeList=function(element){PopIn.Config.editExcludeList(eval(element.getAttribute("excludelist")))};PopIn.ServicesHelper.safariHelper=function(c,a){return PopInServicesIEHelper(unescape(c))};function PopInServicesIEHelper(commandAndData){var dataArray=commandAndData.split("******");var command=dataArray[0];var params=dataArray[1];var element=document.createElement("span");if(params!="undefined"){eval("var elementData ={"+params+"};");for(var i in elementData){if(String(elementData[i]).lastIndexOf(":")>String(elementData[i]).lastIndexOf(",")&&String(elementData[i]).lastIndexOf(",")>0){element.setAttribute(i,"["+String(elementData[i])+"]")}else{typeof elementData[i]=="object"?element.setAttribute(i,JSON.stringify(elementData[i])):element.setAttribute(i,elementData[i])}}}var commands={"display-object":PopIn.ServicesHelper.displayObject,"get-document-url":PopIn.ServicesIECommandHelper.getDocumentUrl,"get-document-title":PopIn.ServicesIECommandHelper.getDocumentTitle,"get-version":PopIn.ServicesHelper.getVersion,"get-service-list":PopIn.ServicesHelper.getServiceList,"set-service-order":PopIn.ServicesHelper.setServiceOrder,"add-service":PopIn.ServicesHelper.addService,"remove-service":PopIn.ServicesHelper.removeService,"get-option-data":PopIn.ServicesHelper.getOptionData,"set-hotkey-mode":PopIn.ServicesHelper.setHotkeyMode,"get-hotkey-mode":PopIn.ServicesHelper.getHotkeyMode,"get-homepage-utils":PopIn.ServicesHelper.getHomepageUtils,"get-service-groups":PopIn.ServicesHelper.getServiceGroups,"add-service-group":PopIn.ServicesHelper.addServiceGroup,"edit-service-group":PopIn.ServicesHelper.editServiceGroup,"remove-service-group":PopIn.ServicesHelper.removeServiceGroup,"get-exclude-list":PopIn.ServicesHelper.getExcludeList,"set-exclude-list":PopIn.ServicesHelper.setExcludeList,"diy-object":PopIn.ServicesHelper.diyObject,"set-preview-mode":PopIn.ServicesHelper.setPreviewMode,"get-preview-mode":PopIn.ServicesHelper.getPreviewMode,"get-language":PopIn.ServicesHelper.getLanguage,"set-language":PopIn.ServicesHelper.setLanguage,"launch-settings":PopIn.ServicesHelper.launchSettings,"launch-url":PopIn.ServicesHelper.launchURL,"launch-message":PopIn.ServicesHelper.launchMessage,"set-ignore-messages":PopIn.ServicesHelper.setIgnoreMessage,"get-ignore-messages":PopIn.ServicesHelper.getIgnoreMessage,"set-skin-color":PopIn.ServicesHelper.setSkinColor,"get-skin-color":PopIn.ServicesHelper.getSkinColor,reset:PopIn.ServicesHelper.reset,"disable-help":PopIn.ServicesHelper.enableHelp,"enable-help":PopIn.ServicesHelper.disableHelp,"set-preview-delay":PopIn.ServicesHelper.setPreviewDelay,"get-preview-delay":PopIn.ServicesHelper.getPreviewDelay,"set-preview-offsetTop":PopIn.ServicesHelper.setPreviewOffsetTop,"get-preview-offsetTop":PopIn.ServicesHelper.getPreviewOffsetTop,"set-preview-offsetLeft":PopIn.ServicesHelper.setPreviewOffsetLeft,"get-preview-offsetLeft":PopIn.ServicesHelper.getPreviewOffsetLeft,"set-icon-mode":PopIn.ServicesHelper.setIconMode,"get-icon-mode":PopIn.ServicesHelper.getIconMode};if(commands[command]){return commands[command](element)}else{throw"Command not supported ["+command+"]"}}PopIn.ServicesIECommandHelper={};PopIn.ServicesIECommandHelper.getDocumentUrl=function(){return document.location.href};PopIn.ServicesIECommandHelper.getDocumentTitle=function(){return PopIn.Utils.getDocument().title};PopIn.ServicesHelper.diyObject=function(b){try{var a=PopIn.Utils.getPopIn();a.diyObject(b);b.setAttribute("result","OK")}catch(c){b.setAttribute("result","Error")}};PopIn.ServicesHelper.setIconMode=function(a){var b=a.getAttribute("mode");PopIn.Config.setParameter("icon",b);PopIn.Config.save()};PopIn.ServicesHelper.getIconMode=function(a){if(a.nodeName=="SPAN"){return PopIn.Config.getParameter("icon")}else{a.setAttribute("result",PopIn.Config.getParameter("icon"))}};PopIn.BlogTools=function(){};PopIn.BlogTools.prototype.getLinksByPrefix=function(d,f){function c(h,g){return h.length>=g.length&&h.substr(0,g.length)==g}var e;var b;var a;if(d.querySelectorAll){a=PopIn.$F.toArray(d.querySelectorAll('a[href^="'+f+'"]'))}else{e=d.getElementsByTagName("a");a=[];for(b=0;b<e.length;b++){if(c(e.item(b).href,f)){a.push(e.item(b))}}}return a};PopIn.BlogTools.prototype.findPopInLinks=function(){return this.getLinksByPrefix(document.body,"http://popin.cc/")};PopIn.BlogTools.prototype.getService=function(c){var b=PopIn.BlogToolServices.service;for(var a=0;a<b.length;a++){if(b[a].serviceId==c){return b[a]}}return"undefined"};PopIn.BlogTools.prototype.serviceExists=function(a){return(typeof this.getService(a)!=="undefined")};PopIn.BlogTools.prototype.getData=function(b){var d=PopIn.$F.isIE?"/"+b.pathname:b.pathname;var a=d.match(/\/([^/]+)\/(.*)/);if(!a){return null}var e=a[2]||b.textContent||b.innerText||"";var c={word:e,serviceId:Number(a[1])};return c};PopIn.BlogTools.prototype.addIcon=function(c,e){var d=document.createElement("span");var a=this.getService(e.serviceId);var b=a.serviceIcon;PopIn.$(d).css({border:"none","background-image":'url("'+b+'")',"background-repeat":"no-repeat",width:"16px",height:"16px",display:"inline-block"});return c.appendChild(d)};PopIn.BlogTools.prototype.handle=function(d){var c=d;var f=this.getData(d);if(f&&this.serviceExists(f.serviceId)){var a=this.getService(f.serviceId);if(a=="undefined"){return}var g=f.word;this.addIcon(d,f);PopIn.$(d).bind("click",function(){setTimeout(function(){var h=document.createElement("div");c.parentNode.insertBefore(h,c.nextSibling);h.id="popIn"+Math.random();PopInApi.execute("launch-service",{word:g,serviceId:a.serviceId,parentId:h.id})},100);return false});var b=document.createElement("div");var e=b.appendChild(document.createElement("div"));e.innerHTML=a.serviceName;PopIn.$(b).css({"background-color":"white",border:"solid 1px #666666",padding:"3px",position:"absolute"});PopIn.$(e).css({background:"url(http://static.popin.cc/tooltip_popin.png) no-repeat right","padding-right":"20px","font-size":"8pt",color:"#666666"});PopIn.$(d).bind("mouseenter",function(i){var h=PopIn.$(d).position();document.body.appendChild(b);b.style.top=h.top+d.offsetHeight+"px";b.style.left=h.left+"px"});PopIn.$(d).bind("click",function(){try{document.body.removeChild(b)}catch(h){}});PopIn.$(d).bind("mouseleave",function(){try{document.body.removeChild(b)}catch(h){}})}};PopIn.BlogTools.prototype.handleError=function(c){var b=null;var a=document.createElement("strong");a.innerHTML="?";PopIn.$(a).css({opacity:"0.8",color:"red",padding:"0px 1px"});PopIn.$(a).bind("mouseover",function(j){if(b){b.style.visibility="visible"}else{var g=PopIn.Config.getServices();b=document.createElement("dl");for(var f=0;f<g.length;f++){var h=document.createElement("dt");PopIn.$(h).text(g[f].serviceName);var d=document.createElement("dd");PopIn.$(d).text("serviceId: "+g[f].serviceId);PopIn.$(b).append(h);PopIn.$(b).append(d)}b.style.position="absolute";b.style.top=j.clientY+"px";b.style.left=j.clientX+"px";b.style.background="#FFFFFF";document.body.appendChild(b)}});PopIn.$(a).bind("mouseout",function(){if(b){b.style.visibility="hidden"}});c.parentNode.insertBefore(a,c.nextSibling)};PopIn.BlogTools.prototype.run=function(){var a=this.findPopInLinks();for(var b=0;b<a.length;b++){this.handle(a[b])}};PopIn.Keyword=function(){this.initialize.apply(this,arguments)};PopIn.Keyword.prototype.initialize=function(b){this.keywordsCount={};this.blogServiceId=17;var d="";if(!b&&String(popInConfigData.popInConfig.isFlashEnable)=="true"){c()}function c(){var e="http://static.popin.cc/tagcloud_ar.swf";if(PopIn.$F.isIE){function g(h,i){var j=document.createElement("param");j.setAttribute("name",h);j.setAttribute("value",i);return j}var f=document.getElementById("popInBlogSWF").appendChild(document.createElement("object"));f.setAttribute("width","151");f.setAttribute("height","172");f.setAttribute("id","externalInterface2");f.appendChild(g("movie",e));f.appendChild(g("FlashVars","uid="+popInConfigData.popInConfig.userID+"&ar="+popInConfigData.popInConfig.arText+"&keywordsData="+d));f.appendChild(g("allowScriptAccess","always"));f.appendChild(g("wmode","transparent"));f.setAttribute("type","application/x-shockwave-flash")}else{document.getElementById("popInBlogSWF").innerHTML='<object id="externalInterface2" width="151" height="172" align="middle"><param name="allowScriptAccess" value="always" /><param name="movie" value="'+e+"?uid="+popInConfigData.popInConfig.userID+"&ar="+popInConfigData.popInConfig.arText+"&keywordsData="+d+'" /><param name="quality" value="high" /><param name="scale" value="noscale" /><param name="salign" value="lt" /><param name="wmode" value="transparent" /><param name="bgcolor" value="#ffffff" /><embed src="'+e+"?uid="+popInConfigData.popInConfig.userID+"&ar="+popInConfigData.popInConfig.arText+"&keywordsData="+d+'" quality="high" scale="noscale" name="externalInterface2"  wmode="transparent" bgcolor="#ffffff" width="151" height="172" align="middle" allowScriptAccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer"></object>'}}if(PopIn.keywords_ajax&&b && false){var a=this;PopIn.$F.ajax(PopIn.keywords_ajax,function(f){for(var e in f){var g=a.blogServiceId;var h=a.getKeywordServiceData(g);if(typeof h!="undefined"){PopIn.keywords[decodeURI(decodeURI(e))]=h;PopIn.keywordsTimes[decodeURI(decodeURI(e))+g]=f[e];d+='<a+serviceId="'+a.blogServiceId+'"+info="'+escape("("+PopIn.RainbowResource.getMessage("numberOfSearches")+f[e]+")")+'">'+escape(decodeURIComponent(e))+"</a>+(4)<br />"}}if(d!=""){d+='<a+serviceId="20005"+>popIn</a>+(4)<br />'}a.run();if(String(popInConfigData.popInConfig.isFlashEnable)=="true"){d=escape(d);c()}})}else{this.run()}};PopIn.Keyword.prototype.run=function(){this._keywords=PopIn.keywords;this._keywordsTimes=PopIn.keywordsTimes;for(var b in this._keywords){this._process(document.body,b,{})}var a=PopIn.LogReferrer.getReferrerKeyword();if(a){var c=a.split(/\s+/);for(var b=0;b<c.length;b++){this._process(document.body,c[b]||"",{special:true,serviceData:{serviceId:17}})}}};PopIn.Keyword.prototype._process=function(e,a,d){if(e.nodeType==3){this._processTextNode(e,a,d)}else{var c=PopIn.$F.toArray(e.childNodes);for(var b=0;b<c.length;b++){if(a!=""){this._process(c[b],a,d)}}}};PopIn.Keyword.prototype._processTextNode=function(c,e,a){var j=c.nodeValue;var g=c.ownerDocument;function k(m){return m.replace(/\W/g,"\\$&")}var l=new RegExp(k(e),"i");var d=j.search(l);if(d<0){return}if(this._nodeHasIgnoreTags(c)){return}this.keywordsCount[e]=(this.keywordsCount[e]||0)+1;if(this.keywordsCount[e]>3){return}var i=g.createTextNode(j.substr(0,d));var h=g.createElement("a");h.appendChild(g.createTextNode(j.substr(d,e.length)));var b=g.createTextNode(j.substr(d+e.length));var f=g.createDocumentFragment();f.appendChild(i);f.appendChild(h);f.appendChild(b);c.parentNode.replaceChild(f,c);this._processTextNode(b,e,a);this.customizeLink(h,e,a)};PopIn.Keyword.prototype._nodeHasIgnoreTags=function(c){var a=["A","H1","H2","H3","H4","H5","SCRIPT","STYLE"];while(c!=null){for(var b=0;b<a.length;b++){if(c.tagName==a[b]){return true}}c=c.parentNode}return false};PopIn.Keyword.prototype.customizeLink=function(a,b,c){a.href="javascript:void 0";if(c.special){this._addIcon(a,b,c.serviceData);this._addHandler(a,b,c.serviceData||this._keywords[b])}else{this._addMouseOver(a,b,c.serviceData||this._keywords[b]);this._addClickHandler(a,b,c.serviceData||this._keywords[b])}};PopIn.Keyword.prototype.getKeywordServiceData=function(c){var b=PopIn.BlogToolServices.service;var d;for(var a=0;a<b.length;a++){if(b[a].serviceId==c){d=b[a];break}}return d};PopIn.Keyword.prototype._makeBold=function(a,b,c){PopIn.$(a).css("font-weight","bold")};PopIn.Keyword.prototype._addIcon=function(a,b,d){var c=document.createElement("span");a.appendChild(c);PopIn.$(c).css({border:"none","background-image":'url("http://popin.cc/favicon.ico")',"background-repeat":"no-repeat",width:"16px",height:"16px",display:"inline-block"})};PopIn.Keyword.prototype._addMouseOver=function(a,b,e){var c=document.createElement("div");var d=c.appendChild(document.createElement("div"));d.innerHTML=PopIn.RainbowResource.getMessage("numberOfSearches")+(this._keywordsTimes[b+e.serviceId]||0);PopIn.$(c).css({"background-color":"white",border:"solid 1px #666666",padding:"3px",position:"absolute"});PopIn.$(d).css({background:"url(http://static.popin.cc/tooltip_popin.png) no-repeat right","padding-right":"20px","font-size":"8pt",color:"#666666"});PopIn.$(a).bind("mouseenter",function(g){var f=PopIn.$(a).position();document.body.appendChild(c);c.style.top=f.top+a.offsetHeight+"px";c.style.left=f.left+"px"});PopIn.$(a).bind("click",function(){try{document.body.removeChild(c)}catch(f){}});PopIn.$(a).bind("mouseleave",function(){try{document.body.removeChild(c)}catch(f){}})};PopIn.Keyword.prototype._addClickHandler=function(c,b,d){var a=this;PopIn.$(c).bind("click",function(){if(c.nextSibling.id!=undefined&&c.nextSibling.id.indexOf("popIn")>-1){PopIn.$(c.nextSibling.firstChild).slideUp("medium",function(){PopIn.$(c.nextSibling).remove()});return false}var e=document.createElement("div");e.id="popIn"+Math.random();c.parentNode.insertBefore(e,c.nextSibling);PopInApi.execute("launch-service",{word:b,serviceId:a.blogServiceId,parentId:e.id});return false})};PopIn.Keyword.prototype._addHandler=function(d,b,f){var a=this;var e=null;var c=600;PopIn.$(d).bind("mouseleave",function(){if(e){clearTimeout(e)}e=null});PopIn.$(d).bind("mouseenter",function(){if(e&&d.nextSibling.id!=undefined&&d.nextSibling.id.indexOf("popIn")>-1){PopIn.$(d.nextSibling.firstChild).slideUp("medium",function(){PopIn.$(d.nextSibling).remove()});return false}e=setTimeout(function(){if(!e){return}var g=document.createElement("div");g.id="popIn"+Math.random();d.parentNode.insertBefore(g,d.nextSibling);PopInApi.execute("launch-service",{word:b,serviceId:a.blogServiceId,parentId:g.id})},c);return false})};PopIn.LogReferrer=function(){var a=PopIn.LogReferrer.getReferrerKeyword();if(!a){return}document.body.appendChild(PopIn.Log.requestToImage({serviceid:20010,input:a,url:document.location,title:document.title}))};PopIn.LogReferrer.getReferrerKeyword=function(){var d=PopIn.referrer_keys;for(var b=0;b<d.length;b++){var c=d[b];if(!location.host.indexOf(c.host)>=0&&document.referrer.indexOf(c.host)>=0){var e=new RegExp("(?:^\\?|&)"+c.query+"=([^&]*)");var a=new PopIn.Utils.URI(document.referrer).search.match(e);if(!a||!a[1]){continue}return decodeURIComponent(a[1].replace(/\+/g,"%20"))}}return""};PopIn.Loader=function(){this._lf=[]};PopIn.Loader.prototype.addModule=function(a){this._lf.push(a)};PopIn.Loader.prototype.start=function(){var a=this;var c="readyState" in document?document.readyState:null;if(c){if(c=="complete"||c=="loaded"){this._start()}else{if(document.addEventListener){PopIn.$(document).bind("DOMContentLoaded",function(){a._start()})}else{PopIn.$(document).bind("readystatechange",function(){if(document.readyState=="complete"){a.start()}})}}}else{var b=document.createElement("script");b.src="data:text/javascript,void 0";b.charset="UTF-8";b.onload=function(){setTimeout(function(){a._start()},1000);b.parentNode.removeChild(b)};document.documentElement.appendChild(b)}};PopIn.Loader.prototype._start=function(){for(var a=0;a<this._lf.length;a++){this._lf[a].apply(this)}};PopIn.ExternalLink=function(){this.initialize.apply(this,arguments);this.pressFlag=false};PopIn.ExternalLink.prototype.initialize=function(){var a=this;PopIn.$(document.documentElement).bind("mouseover",function(b){a.mouseOver(b)});PopIn.$(document.documentElement).bind("keypress",function(b){a.keyPress(b)})};PopIn.ExternalLink.prototype.isPreviewEnable=function(){if(String(popInConfigData.popInConfig.isPreviewEnable)=="true"||String(popInConfigData.popInConfig.isPreviewEnable)=="undefined"){return true}else{return false}};PopIn.ExternalLink.prototype.mouseOver=function(b){b=b||window.event;var c=b.target||b.srcElement;for(var a=c;a!=null;a=a.parentNode){if((a.tagName=="a"||a.tagName=="A"&&this.isExternalLink(a))&&this.isPreviewEnable()){this.linkFound(b,a);this.pressFlag=true}}};PopIn.ExternalLink.prototype.keyPress=function(a){if(this.activeLink!=""&&(a.charCode==97||a.keyCode==97)&&this.pressFlag){PopInApi.execute("display-object",{type:"iframe",src:this.activeLink});this.isPreviewEnable()}};PopIn.ExternalLink.prototype.linkFound=function(c,b){var d=this.createTooltip(b);this.activeLink=b;var a=this;PopIn.$(b).bind("mouseleave",function(){try{PopIn.$(d).remove();a.activeLink="",a.pressFlag=false}catch(f){}});return};PopIn.ExternalLink.prototype.isExternalLink=function(a){return a.href.indexOf("http://")==0&&String(a.hostname).indexOf(String(location.hostname))<0&&String(a.hostname).indexOf("popin.cc")<0&&String(a.hostname).indexOf("amazon.co")<0&&String(a.hostname).indexOf("rakuten.co")<0};PopIn.ExternalLink.prototype.createTooltip=function(a){var c=document.body.appendChild(document.createElement("div"));var d=c.appendChild(document.createElement("div"));var b=d.appendChild(document.createTextNode(PopIn.RainbowResource.getMessage("previewShortcut")));var e=PopIn.$F.position(a);PopIn.$(c).css({"background-color":"white",border:"solid 1px #666666",padding:"3px",position:"absolute",top:e.top+a.offsetHeight+"px",left:e.left+"px","z-index":200});PopIn.$(d).css({background:"url(http://static.popin.cc/tooltip_popup.png) no-repeat right","padding-right":"20px","font-size":"8pt",color:"#666666"});return c};PopIn.SideMenu=function(){};PopIn.SideMenu.prototype.show=function(b,a){var c=this.create(b,a);PopIn.Utils.getDocument().body.appendChild(c)};PopIn.SideMenu.services=[{serviceName:"Hello World",serviceIcon:"http://wikipedia.org/favicon.ico",serviceUrl:"http://popin.cc/ja/services/popin_here/index.html?q="}];PopIn.SideMenu.prototype.create=function(h,j){if(h.indexOf(" ")>=0){referArray=h.split(" ");h=referArray[0]}if(h.indexOf("　")>=0){referArray=h.split("　");h=referArray[0]}var e,f;var a=h;var b;var c=PopIn.Utils.createElement("div");c.id="popIn_sidemenu";var d;function k(l,i,n){var m=PopIn.Utils.createElement("iframe");m.id="popIn"+Math.random();m.src=i;m.frameBorder=0;m.allowTransparency="true";m.scrolling="no";PopIn.$(m).attr({width:"205",height:PopIn.Utils.getWindowHeight()-50}).css({});return m}PopIn.Utils.getPopIn().text=a;var g=PopIn.Utils.createElement("div");PopIn.$(g).bind("click",function(i){c.parentNode.removeChild(c)});this.setCloseStyle(g);c.appendChild(g);for(e=0;e<j.length;e++){f=j[e];b=PopIn.Utils.diyURL(j[e].serviceUrl);d=k(f.serviceName,b,f.serviceIcon);c.appendChild(d)}this.setMenuStyle(c);return c};PopIn.SideMenu.prototype.setCloseStyle=function(a){PopIn.$(a).css({background:"transparent url(http://static.popin.cc/images/here/images.png) no-repeat scroll 0 0px",left:"13px",top:"10px",width:"24px",height:"26px",cursor:"pointer",position:"absolute","z-index":100})};PopIn.SideMenu.prototype.setMenuStyle=function(a){PopIn.$(a).css({position:"fixed",top:"50px",right:"0px",width:"205px","z-index":99})};PopIn.Mark=function(){};PopIn.Mark.prototype=new PopIn.SideMenu();PopIn.Mark.services=[{serviceName:"Google World",serviceIcon:"http://www.google.co.jp/favicon.ico",serviceUrl:"http://www.google.co.jp/search?q="}];PopIn.Mark.prototype.create=function(b,a){var c=PopIn.SideMenu.prototype.create.call(this,b,a);c.id="popIn_mark";return c};PopIn.Mark.prototype.setCloseStyle=function(a){PopIn.$(a).css({background:"transparent url(http://static.popin.cc/common_images/popin_here_images.png) no-repeat scroll 0 0px",left:"35px",top:"25px",width:"25px",height:"24px",cursor:"pointer",position:"absolute","z-index":100})};PopIn.Mark.prototype.setMenuStyle=function(a){PopIn.$(a).css({position:"fixed",top:"50px",right:"0px",width:"220px"})};PopIn.Mark.prototype.show=function(){var b=document.createElement("div");var a=this;PopIn.$(b).text("PopIn!");PopIn.$(b).css({position:"fixed",top:Math.floor((PopIn.Utils.getWindowHeight()-100)/2)+"px",right:"0px",color:"white",background:"gray",width:"50px",height:"100px"}).bind("click",function(){PopIn.SideMenu.prototype.show.call(a,"",PopIn.Mark.services)});document.body.appendChild(b)};if(typeof popIn=="undefined"&&typeof document.documentElement.style.maxHeight!="undefined"){PopIn.Log.logImage="http://www.popin.cc/log/enablerblank.gif?";PopIn.keywords_ajax="http://c.popin.cc/jsonpurlword.cgi?url="+encodeURI(window.location);PopIn.keywords={};PopIn.keywordsTimes={};PopIn.referrer_keys=[{host:"google.co",query:"q"},{host:"search.yahoo.co",query:"p"},{host:"www.bing.com",query:"q"},{host:"static.popin.cc",query:"q"}];var loader=new PopIn.Loader();loader.addModule(function(){window.popIn=new PopIn.Core()});loader.addModule(function(){PopIn.Config.load()});loader.addModule(function(){popInConfigData.popInConfig.service.push({enabled:true,serviceId:21,serviceVer:1,isDIY:false,hasPara:true,serviceName:PopIn.RainbowResource.getMessage("siteSearch"),serviceIcon:"http://popin.cc/favicon.ico",serviceUrl:"http://popin.cc/ja/services/site_search/index.html?q=",serviceOriUrl:"http://popin.cc/ja/services/site_search/index.html?q=",displayOrder:21,isSearch:true,optionName:"",optionData:"",addedDay:"",inputModes:{selectMode:{type:"popInWin",width:450,height:350,isDraggable:false,isResizable:"true",isPopin:true},shortcutMode:{screenx:10,screeny:10,width:450,height:350}}})});loader.addModule(function(){new PopIn.LogReferrer()});loader.addModule(function(){new PopIn.ExternalLink()});loader.addModule(function(){new PopIn.BlogTools().run()});loader.addModule(function(){new PopIn.Keyword(String(popInConfigData.popInConfig.isHotwordEnable)!="false")});loader.addModule(function(){PopIn.$("popInSWF").html('<object width="0" height="0"><param value="http://static.popin.cc/receiver.swf?connectionID='+PopIn.Utils.getPopIn().connectionID+'" param name="allowScriptAccess" value="always"></param><embed src="http://static.popin.cc/receiver.swf?connectionID='+PopIn.Utils.getPopIn().connectionID+'" type="application/x-shockwave-flash" width="0" height="0" allowScriptAccess="always"/></object>')});loader.start();function enablerDisplayObj(msg){eval("var data = "+msg);PopInApi._execute_enabler("display-object",data)}function setExcludeList(b){var d=b.split(",");var c=new Array();for(var a=0;a<d.length;a++){c.push(decodeURIComponent(d[a]))}PopIn.Utils.checkExcludeList(c)}function flashFunc(b){var a={word:b[0],serviceId:b[1]};setTimeout(function(){PopInApi.execute("launch-service",a)},100);return false}};